import { GithubReporter } from 'vitest-github-action';
import { defineConfig } from 'vitest/config';

export default defineConfig({
	test: {
		reporters: process.env.GITHUB_ACTIONS
			? ['default', new GithubReporter()]
			: 'default',
		coverage: {
			include: ['src/**/*.ts'],
			exclude: ['src/**/__mocks__/*', 'src/utils/DyteEvents.ts'],

			// NOTE(roerohan): Uncomment the following to
			// add coverage for files that don't have tests
			all: true,

			// @ts-expect-error provider custom is not a valid type
			provider: 'custom',

			customProviderModule: 'vitest-github-coverage-provider',
			// @ts-expect-error github-summary
			reporter: ['text', 'json', 'html', 'json-summary', 'github-summary'],

			// NOTE(roerohan): Uncomment the following to enable strict percentage checking
			// lines: 80,
			// branches: 80,
			// functions: 80,
			// statements: 80,
		},
		clearMocks: true,
		deps: {
			inline: ['@dyte-in/dyte-callstats-toolkit', '@dyteinternals/utils'],
		},
	},
});
