"use strict";var em=Object.defineProperty;var tm=(t,e,r)=>e in t?em(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var g=(t,e,r)=>(tm(t,typeof e!="symbol"?e+"":e,r),r),Na=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var d=(t,e,r)=>(Na(t,e,"read from private field"),r?r.call(t):e.get(t)),S=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},w=(t,e,r,n)=>(Na(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r);var W=(t,e,r)=>(Na(t,e,"access private method"),r);const qe=require("uuid"),Qs=require("events"),rm=require("bowser"),fi=require("@faker-js/faker"),nm=require("worker-timers");function im(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const _s=im(nm);function sm(t){const{length:e}=this,r=t>=0?t:e+t;return r<0||r>=e?void 0:this[r]}Array.prototype.at||Object.assign(Array.prototype,{at:sm});function am(t){const{length:e}=this,r=t>=0?t:e+t;return r<0||r>=e?void 0:this[r]}String.prototype.at||Object.assign(String.prototype,{at:am});var st;(function(t){t.GroupCall="GROUP_CALL",t.Webinar="WEBINAR",t.AudioRoom="AUDIO_ROOM",t.Livestream="LIVESTREAM",t.Chat="CHAT"})(st||(st={}));var vs;(function(t){t.Skip="SKIP",t.OnPrivilegedUserEntry="ON_PRIVILEGED_USER_ENTRY",t.SkipOnAccept="SKIP_ON_ACCEPT"})(vs||(vs={}));var x;(function(t){t.Allowed="ALLOWED",t.NotAllowed="NOT_ALLOWED",t.CanRequest="CAN_REQUEST"})(x||(x={}));var Ts;(function(t){t.Allowed="ALLOWED",t.NotAllowed="NOT_ALLOWED"})(Ts||(Ts={}));var md;(function(t){t.FULL_ACCESS="FULL_ACCESS",t.VIEW_ONLY="VIEW_ONLY"})(md||(md={}));var Es;(function(t){t.skip="SKIP",t.onAccept="ON_ACCEPT",t.skipOnPrivilegedUserEntry="SKIP_ON_PRIVILEGED_USER_ENTRY",t.skipOnAccept="SKIP_ON_ACCEPT"})(Es||(Es={}));var Jn;(function(t){t.none="NONE",t.recorder="RECORDER",t.livestreamer="LIVESTREAMER"})(Jn||(Jn={}));var go;(function(t){t.groupCall="GROUP_CALL",t.webinar="WEBINAR",t.audioRoom="AUDIO_ROOM",t.livestream="LIVESTREAM",t.chat="CHAT"})(go||(go={}));var gd;(function(t){t.SKIP="skip",t.SKIP_ON_PRIVILEGED_USER_ENTRY="skipOnPrivilegedUserEntry",t.ON_ACCEPT="skipOnAccept",t.SKIP_ON_ACCEPT="skipOnAccept"})(gd||(gd={}));go.groupCall,Es.skipOnAccept,Jn.none;function om(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _o={},cm={get exports(){return _o},set exports(t){_o=t}},ws={},dm={get exports(){return ws},set exports(t){ws=t}},Al=function(e,r){return function(){for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];return e.apply(r,i)}},um=Al,Fr=Object.prototype.toString;function ec(t){return Array.isArray(t)}function vo(t){return typeof t=="undefined"}function lm(t){return t!==null&&!vo(t)&&t.constructor!==null&&!vo(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function Rl(t){return Fr.call(t)==="[object ArrayBuffer]"}function hm(t){return Fr.call(t)==="[object FormData]"}function fm(t){var e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Rl(t.buffer),e}function pm(t){return typeof t=="string"}function mm(t){return typeof t=="number"}function Sl(t){return t!==null&&typeof t=="object"}function os(t){if(Fr.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function gm(t){return Fr.call(t)==="[object Date]"}function _m(t){return Fr.call(t)==="[object File]"}function vm(t){return Fr.call(t)==="[object Blob]"}function bl(t){return Fr.call(t)==="[object Function]"}function Tm(t){return Sl(t)&&bl(t.pipe)}function Em(t){return Fr.call(t)==="[object URLSearchParams]"}function wm(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function ym(){return typeof navigator!="undefined"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window!="undefined"&&typeof document!="undefined"}function tc(t,e){if(!(t===null||typeof t=="undefined"))if(typeof t!="object"&&(t=[t]),ec(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}function To(){var t={};function e(i,s){os(t[s])&&os(i)?t[s]=To(t[s],i):os(i)?t[s]=To({},i):ec(i)?t[s]=i.slice():t[s]=i}for(var r=0,n=arguments.length;r<n;r++)tc(arguments[r],e);return t}function Am(t,e,r){return tc(e,function(i,s){r&&typeof i=="function"?t[s]=um(i,r):t[s]=i}),t}function Rm(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}var Qe={isArray:ec,isArrayBuffer:Rl,isBuffer:lm,isFormData:hm,isArrayBufferView:fm,isString:pm,isNumber:mm,isObject:Sl,isPlainObject:os,isUndefined:vo,isDate:gm,isFile:_m,isBlob:vm,isFunction:bl,isStream:Tm,isURLSearchParams:Em,isStandardBrowserEnv:ym,forEach:tc,merge:To,extend:Am,trim:wm,stripBOM:Rm},bn=Qe;function _d(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var kl=function(e,r,n){if(!r)return e;var i;if(n)i=n(r);else if(bn.isURLSearchParams(r))i=r.toString();else{var s=[];bn.forEach(r,function(c,u){c===null||typeof c=="undefined"||(bn.isArray(c)?u=u+"[]":c=[c],bn.forEach(c,function(f){bn.isDate(f)?f=f.toISOString():bn.isObject(f)&&(f=JSON.stringify(f)),s.push(_d(u)+"="+_d(f))}))}),i=s.join("&")}if(i){var a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e},Sm=Qe;function Zs(){this.handlers=[]}Zs.prototype.use=function(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1};Zs.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};Zs.prototype.forEach=function(e){Sm.forEach(this.handlers,function(n){n!==null&&e(n)})};var bm=Zs,km=Qe,Cm=function(e,r){km.forEach(e,function(i,s){s!==r&&s.toUpperCase()===r.toUpperCase()&&(e[r]=i,delete e[s])})},Cl=function(e,r,n,i,s){return e.config=r,n&&(e.code=n),e.request=i,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},xa,vd;function Il(){if(vd)return xa;vd=1;var t=Cl;return xa=function(r,n,i,s,a){var o=new Error(r);return t(o,n,i,s,a)},xa}var La,Td;function Im(){if(Td)return La;Td=1;var t=Il();return La=function(r,n,i){var s=i.config.validateStatus;!i.status||!s||s(i.status)?r(i):n(t("Request failed with status code "+i.status,i.config,null,i.request,i))},La}var $a,Ed;function Pm(){if(Ed)return $a;Ed=1;var t=Qe;return $a=t.isStandardBrowserEnv()?function(){return{write:function(n,i,s,a,o,c){var u=[];u.push(n+"="+encodeURIComponent(i)),t.isNumber(s)&&u.push("expires="+new Date(s).toGMTString()),t.isString(a)&&u.push("path="+a),t.isString(o)&&u.push("domain="+o),c===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(n){var i=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return i?decodeURIComponent(i[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),$a}var Ua,wd;function Dm(){return wd||(wd=1,Ua=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}),Ua}var Fa,yd;function Om(){return yd||(yd=1,Fa=function(e,r){return r?e.replace(/\/+$/,"")+"/"+r.replace(/^\/+/,""):e}),Fa}var Va,Ad;function Mm(){if(Ad)return Va;Ad=1;var t=Dm(),e=Om();return Va=function(n,i){return n&&!t(i)?e(n,i):i},Va}var Ba,Rd;function Nm(){if(Rd)return Ba;Rd=1;var t=Qe,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Ba=function(n){var i={},s,a,o;return n&&t.forEach(n.split(`
`),function(u){if(o=u.indexOf(":"),s=t.trim(u.substr(0,o)).toLowerCase(),a=t.trim(u.substr(o+1)),s){if(i[s]&&e.indexOf(s)>=0)return;s==="set-cookie"?i[s]=(i[s]?i[s]:[]).concat([a]):i[s]=i[s]?i[s]+", "+a:a}}),i},Ba}var Ga,Sd;function xm(){if(Sd)return Ga;Sd=1;var t=Qe;return Ga=t.isStandardBrowserEnv()?function(){var r=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),i;function s(a){var o=a;return r&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return i=s(window.location.href),function(o){var c=t.isString(o)?s(o):o;return c.protocol===i.protocol&&c.host===i.host}}():function(){return function(){return!0}}(),Ga}var qa,bd;function ea(){if(bd)return qa;bd=1;function t(e){this.message=e}return t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,qa=t,qa}var Ha,kd;function Cd(){if(kd)return Ha;kd=1;var t=Qe,e=Im(),r=Pm(),n=kl,i=Mm(),s=Nm(),a=xm(),o=Il(),c=ta(),u=ea();return Ha=function(f){return new Promise(function(T,A){var C=f.data,R=f.headers,b=f.responseType,D;function H(){f.cancelToken&&f.cancelToken.unsubscribe(D),f.signal&&f.signal.removeEventListener("abort",D)}t.isFormData(C)&&delete R["Content-Type"];var k=new XMLHttpRequest;if(f.auth){var Z=f.auth.username||"",K=f.auth.password?unescape(encodeURIComponent(f.auth.password)):"";R.Authorization="Basic "+btoa(Z+":"+K)}var ve=i(f.baseURL,f.url);k.open(f.method.toUpperCase(),n(ve,f.params,f.paramsSerializer),!0),k.timeout=f.timeout;function Ge(){if(k){var Rt="getAllResponseHeaders"in k?s(k.getAllResponseHeaders()):null,Sn=!b||b==="text"||b==="json"?k.responseText:k.response,jr={data:Sn,status:k.status,statusText:k.statusText,headers:Rt,config:f,request:k};e(function(Ma){T(Ma),H()},function(Ma){A(Ma),H()},jr),k=null}}if("onloadend"in k?k.onloadend=Ge:k.onreadystatechange=function(){!k||k.readyState!==4||k.status===0&&!(k.responseURL&&k.responseURL.indexOf("file:")===0)||setTimeout(Ge)},k.onabort=function(){k&&(A(o("Request aborted",f,"ECONNABORTED",k)),k=null)},k.onerror=function(){A(o("Network Error",f,null,k)),k=null},k.ontimeout=function(){var Sn=f.timeout?"timeout of "+f.timeout+"ms exceeded":"timeout exceeded",jr=f.transitional||c.transitional;f.timeoutErrorMessage&&(Sn=f.timeoutErrorMessage),A(o(Sn,f,jr.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",k)),k=null},t.isStandardBrowserEnv()){var ci=(f.withCredentials||a(ve))&&f.xsrfCookieName?r.read(f.xsrfCookieName):void 0;ci&&(R[f.xsrfHeaderName]=ci)}"setRequestHeader"in k&&t.forEach(R,function(Sn,jr){typeof C=="undefined"&&jr.toLowerCase()==="content-type"?delete R[jr]:k.setRequestHeader(jr,Sn)}),t.isUndefined(f.withCredentials)||(k.withCredentials=!!f.withCredentials),b&&b!=="json"&&(k.responseType=f.responseType),typeof f.onDownloadProgress=="function"&&k.addEventListener("progress",f.onDownloadProgress),typeof f.onUploadProgress=="function"&&k.upload&&k.upload.addEventListener("progress",f.onUploadProgress),(f.cancelToken||f.signal)&&(D=function(Rt){k&&(A(!Rt||Rt&&Rt.type?new u("canceled"):Rt),k.abort(),k=null)},f.cancelToken&&f.cancelToken.subscribe(D),f.signal&&(f.signal.aborted?D():f.signal.addEventListener("abort",D))),C||(C=null),k.send(C)})},Ha}var Wa,Id;function ta(){if(Id)return Wa;Id=1;var t=Qe,e=Cm,r=Cl,n={"Content-Type":"application/x-www-form-urlencoded"};function i(c,u){!t.isUndefined(c)&&t.isUndefined(c["Content-Type"])&&(c["Content-Type"]=u)}function s(){var c;return(typeof XMLHttpRequest!="undefined"||typeof process!="undefined"&&Object.prototype.toString.call(process)==="[object process]")&&(c=Cd()),c}function a(c,u,h){if(t.isString(c))try{return(u||JSON.parse)(c),t.trim(c)}catch(f){if(f.name!=="SyntaxError")throw f}return(h||JSON.stringify)(c)}var o={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:s(),transformRequest:[function(u,h){return e(h,"Accept"),e(h,"Content-Type"),t.isFormData(u)||t.isArrayBuffer(u)||t.isBuffer(u)||t.isStream(u)||t.isFile(u)||t.isBlob(u)?u:t.isArrayBufferView(u)?u.buffer:t.isURLSearchParams(u)?(i(h,"application/x-www-form-urlencoded;charset=utf-8"),u.toString()):t.isObject(u)||h&&h["Content-Type"]==="application/json"?(i(h,"application/json"),a(u)):u}],transformResponse:[function(u){var h=this.transitional||o.transitional,f=h&&h.silentJSONParsing,m=h&&h.forcedJSONParsing,T=!f&&this.responseType==="json";if(T||m&&t.isString(u)&&u.length)try{return JSON.parse(u)}catch(A){if(T)throw A.name==="SyntaxError"?r(A,this,"E_JSON_PARSE"):A}return u}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(u){return u>=200&&u<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};return t.forEach(["delete","get","head"],function(u){o.headers[u]={}}),t.forEach(["post","put","patch"],function(u){o.headers[u]=t.merge(n)}),Wa=o,Wa}var Lm=Qe,$m=ta(),Um=function(e,r,n){var i=this||$m;return Lm.forEach(n,function(a){e=a.call(i,e,r)}),e},ja,Pd;function Pl(){return Pd||(Pd=1,ja=function(e){return!!(e&&e.__CANCEL__)}),ja}var Dd=Qe,Ka=Um,Fm=Pl(),Vm=ta(),Bm=ea();function Ja(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Bm("canceled")}var Gm=function(e){Ja(e),e.headers=e.headers||{},e.data=Ka.call(e,e.data,e.headers,e.transformRequest),e.headers=Dd.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Dd.forEach(["delete","get","head","post","put","patch","common"],function(i){delete e.headers[i]});var r=e.adapter||Vm.adapter;return r(e).then(function(i){return Ja(e),i.data=Ka.call(e,i.data,i.headers,e.transformResponse),i},function(i){return Fm(i)||(Ja(e),i&&i.response&&(i.response.data=Ka.call(e,i.response.data,i.response.headers,e.transformResponse))),Promise.reject(i)})},nt=Qe,Dl=function(e,r){r=r||{};var n={};function i(h,f){return nt.isPlainObject(h)&&nt.isPlainObject(f)?nt.merge(h,f):nt.isPlainObject(f)?nt.merge({},f):nt.isArray(f)?f.slice():f}function s(h){if(nt.isUndefined(r[h])){if(!nt.isUndefined(e[h]))return i(void 0,e[h])}else return i(e[h],r[h])}function a(h){if(!nt.isUndefined(r[h]))return i(void 0,r[h])}function o(h){if(nt.isUndefined(r[h])){if(!nt.isUndefined(e[h]))return i(void 0,e[h])}else return i(void 0,r[h])}function c(h){if(h in r)return i(e[h],r[h]);if(h in e)return i(void 0,e[h])}var u={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c};return nt.forEach(Object.keys(e).concat(Object.keys(r)),function(f){var m=u[f]||s,T=m(f);nt.isUndefined(T)&&m!==c||(n[f]=T)}),n},Ya,Od;function Ol(){return Od||(Od=1,Ya={version:"0.25.0"}),Ya}var qm=Ol().version,rc={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){rc[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});var Md={};rc.transitional=function(e,r,n){function i(s,a){return"[Axios v"+qm+"] Transitional option '"+s+"'"+a+(n?". "+n:"")}return function(s,a,o){if(e===!1)throw new Error(i(a," has been removed"+(r?" in "+r:"")));return r&&!Md[a]&&(Md[a]=!0,console.warn(i(a," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(s,a,o):!0}};function Hm(t,e,r){if(typeof t!="object")throw new TypeError("options must be an object");for(var n=Object.keys(t),i=n.length;i-- >0;){var s=n[i],a=e[s];if(a){var o=t[s],c=o===void 0||a(o,s,t);if(c!==!0)throw new TypeError("option "+s+" must be "+c);continue}if(r!==!0)throw Error("Unknown option "+s)}}var Wm={assertOptions:Hm,validators:rc},Ml=Qe,jm=kl,Nd=bm,xd=Gm,ra=Dl,Nl=Wm,kn=Nl.validators;function Bi(t){this.defaults=t,this.interceptors={request:new Nd,response:new Nd}}Bi.prototype.request=function(e,r){if(typeof e=="string"?(r=r||{},r.url=e):r=e||{},!r.url)throw new Error("Provided config url is not valid");r=ra(this.defaults,r),r.method?r.method=r.method.toLowerCase():this.defaults.method?r.method=this.defaults.method.toLowerCase():r.method="get";var n=r.transitional;n!==void 0&&Nl.assertOptions(n,{silentJSONParsing:kn.transitional(kn.boolean),forcedJSONParsing:kn.transitional(kn.boolean),clarifyTimeoutError:kn.transitional(kn.boolean)},!1);var i=[],s=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(r)===!1||(s=s&&T.synchronous,i.unshift(T.fulfilled,T.rejected))});var a=[];this.interceptors.response.forEach(function(T){a.push(T.fulfilled,T.rejected)});var o;if(!s){var c=[xd,void 0];for(Array.prototype.unshift.apply(c,i),c=c.concat(a),o=Promise.resolve(r);c.length;)o=o.then(c.shift(),c.shift());return o}for(var u=r;i.length;){var h=i.shift(),f=i.shift();try{u=h(u)}catch(m){f(m);break}}try{o=xd(u)}catch(m){return Promise.reject(m)}for(;a.length;)o=o.then(a.shift(),a.shift());return o};Bi.prototype.getUri=function(e){if(!e.url)throw new Error("Provided config url is not valid");return e=ra(this.defaults,e),jm(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};Ml.forEach(["delete","get","head","options"],function(e){Bi.prototype[e]=function(r,n){return this.request(ra(n||{},{method:e,url:r,data:(n||{}).data}))}});Ml.forEach(["post","put","patch"],function(e){Bi.prototype[e]=function(r,n,i){return this.request(ra(i||{},{method:e,url:r,data:n}))}});var Km=Bi,za,Ld;function Jm(){if(Ld)return za;Ld=1;var t=ea();function e(r){if(typeof r!="function")throw new TypeError("executor must be a function.");var n;this.promise=new Promise(function(a){n=a});var i=this;this.promise.then(function(s){if(i._listeners){var a,o=i._listeners.length;for(a=0;a<o;a++)i._listeners[a](s);i._listeners=null}}),this.promise.then=function(s){var a,o=new Promise(function(c){i.subscribe(c),a=c}).then(s);return o.cancel=function(){i.unsubscribe(a)},o},r(function(a){i.reason||(i.reason=new t(a),n(i.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]},e.prototype.unsubscribe=function(n){if(this._listeners){var i=this._listeners.indexOf(n);i!==-1&&this._listeners.splice(i,1)}},e.source=function(){var n,i=new e(function(a){n=a});return{token:i,cancel:n}},za=e,za}var Xa,$d;function Ym(){return $d||($d=1,Xa=function(e){return function(n){return e.apply(null,n)}}),Xa}var Qa,Ud;function zm(){if(Ud)return Qa;Ud=1;var t=Qe;return Qa=function(r){return t.isObject(r)&&r.isAxiosError===!0},Qa}var Fd=Qe,Xm=Al,cs=Km,Qm=Dl,Zm=ta();function xl(t){var e=new cs(t),r=Xm(cs.prototype.request,e);return Fd.extend(r,cs.prototype,e),Fd.extend(r,e),r.create=function(i){return xl(Qm(t,i))},r}var Ht=xl(Zm);Ht.Axios=cs;Ht.Cancel=ea();Ht.CancelToken=Jm();Ht.isCancel=Pl();Ht.VERSION=Ol().version;Ht.all=function(e){return Promise.all(e)};Ht.spread=Ym();Ht.isAxiosError=zm();dm.exports=Ht;ws.default=Ht;(function(t){t.exports=ws})(cm);const Eo=om(_o);let Ll="hXgU8Wc8pwuGNq9ms5q9Hh";var hl;typeof process!="undefined"&&(hl=process==null?void 0:process.env)!=null&&hl.FLAGSMITH_ENVIRONMENT_KEY&&(Ll=process.env.FLAGSMITH_ENVIRONMENT_KEY);function eg(t=[]){const e={};return t.forEach(r=>{e[r.feature.name]={enabled:r.enabled,value:r.feature_state_value}}),e}class tg{constructor(e=Ll){g(this,"flags",{});g(this,"environmentKey",null);this.environmentKey=e,this.identify=this.identify.bind(this),this.getValue=this.getValue.bind(this),this.hasFeature=this.hasFeature.bind(this),this.getAllFlags=this.getAllFlags.bind(this)}async identify(e,r={},n=!1,i=5e3,s="edge.api.flagsmith.com"){const a=JSON.parse(JSON.stringify(r)),o=Object.entries(a).map(c=>({trait_key:c[0],trait_value:c[1]}));try{const c="_"+(Math.random()+1).toString(36).substring(2),u=await Eo.post(`https://${s}/api/v1/identities/`,{identifier:e+(n?c:""),traits:o},{headers:{"Content-Type":"application/json","X-Environment-Key":this.environmentKey},timeout:i});this.flags=eg(u.data.flags||[])}catch(c){}return this.flags}getValue(e){return this.flags&&this.flags[e]&&this.flags[e].value}hasFeature(e){return this.flags&&this.flags[e]&&this.flags[e].enabled}getAllFlags(){return this.flags}}const ie=new tg,$l=[-2,-1,0,1,2],rg=[0,1,2,3,4];function ng(t){t=t.trim();let e="0",r="0",n="0";return t.length==4?(e="0x"+t[1]+t[1],r="0x"+t[2]+t[2],n="0x"+t[3]+t[3]):t.length>6&&(e="0x"+t[1]+t[2],r="0x"+t[3]+t[4],n="0x"+t[5]+t[6]),[+e,+r,+n]}const ig=(t,e,r)=>{let n,i,s;if(e==0)n=i=s=r;else{const a=(u,h,f)=>(f<0&&(f+=1),f>1&&(f-=1),f<.16666666666666666?u+(h-u)*6*f:f<.5?h:f<.6666666666666666?u+(h-u)*(.6666666666666666-f)*6:u),o=r<.5?r*(1+e):r+e-r*e,c=2*r-o;n=a(c,o,t+1/3),i=a(c,o,t),s=a(c,o,t-1/3)}return[Math.round(n*255),Math.round(i*255),Math.round(s*255)]},sg=(t,e,r)=>{t/=255,e/=255,r/=255;const n=Math.max(t,e,r),i=Math.min(t,e,r);let s,a;const o=(n+i)/2;if(n==i)s=a=0;else{const c=n-i;switch(a=o>.5?c/(2-n-i):c/(n+i),n){case t:s=(e-r)/c+(e<r?6:0);break;case e:s=(r-t)/c+2;break;case r:s=(t-e)/c+4;break}s/=6}return[s,a,o]},ag=(t,e,r)=>{const n=i=>i.toString(16).padStart(2,"0");return`#${n(t)}${n(e)}${n(r)}`},Ul=(t,e=$l,r=.4)=>{const n=[],[i,s,a]=ng(t),[o,c,u]=sg(i,s,a),h=Math.round(u*100);h>70?r=.8:h>60?r=.9:h<10?r=.075:h<42&&(r=.3);const f=e.findIndex(R=>R===0);if(f===-1)throw new Error("Invalid reducer provided, it must contain atleast one zero");const m=5-f,T=f+1,A=(100-h)/m,C=h/T;for(const R of e){let b;R<0?b=h+R*C*r:R>0?b=h+R*A*r:b=h;const[D,H,k]=ig(o,c,b/100);n.push(ag(D,H,k))}return n},Vd={dark:{background:{1e3:"#252525",900:"#2F2F2F",800:"#323232",700:"#3E3E3E",600:"#4A4A4A"},text:"#F5F5F5","video-bg":"#1C1C1C"},light:{background:{1e3:"#FFFFFF",900:"#F5F5F5",800:"#EBEBEB",700:"#E0E0E0",600:"#D6D6D6"},text:"#111111","text-on-brand":"#ffffff","video-bg":"#DADADA"}},og=t=>{const[e,r,n,i,s]=Ul(t,$l);return{300:e,400:r,500:n,600:i,700:s}},cg=t=>{if(t==="#FFFFFF")return Vd.light.background;if(t==="#000000")return Vd.dark.background;const[e,r,n,i,s]=Ul(t,rg);return{1e3:e,900:r,800:n,700:i,600:s}};function dg(){this.__data__=[],this.size=0}function Dt(t,e){return t===e||t!==t&&e!==e}function na(t,e){for(var r=t.length;r--;)if(Dt(t[r][0],e))return r;return-1}var ug=Array.prototype,lg=ug.splice;function hg(t){var e=this.__data__,r=na(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():lg.call(e,r,1),--this.size,!0}function fg(t){var e=this.__data__,r=na(e,t);return r<0?void 0:e[r][1]}function pg(t){return na(this.__data__,t)>-1}function mg(t,e){var r=this.__data__,n=na(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function pr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}pr.prototype.clear=dg;pr.prototype.delete=hg;pr.prototype.get=fg;pr.prototype.has=pg;pr.prototype.set=mg;function gg(){this.__data__=new pr,this.size=0}function _g(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function vg(t){return this.__data__.get(t)}function Tg(t){return this.__data__.has(t)}var Eg=typeof global=="object"&&global&&global.Object===Object&&global;const Fl=Eg;var wg=typeof self=="object"&&self&&self.Object===Object&&self,yg=Fl||wg||Function("return this")();const De=yg;var Ag=De.Symbol;const Fe=Ag;var Vl=Object.prototype,Rg=Vl.hasOwnProperty,Sg=Vl.toString,di=Fe?Fe.toStringTag:void 0;function bg(t){var e=Rg.call(t,di),r=t[di];try{t[di]=void 0;var n=!0}catch(s){}var i=Sg.call(t);return n&&(e?t[di]=r:delete t[di]),i}var kg=Object.prototype,Cg=kg.toString;function Ig(t){return Cg.call(t)}var Pg="[object Null]",Dg="[object Undefined]",Bd=Fe?Fe.toStringTag:void 0;function We(t){return t==null?t===void 0?Dg:Pg:Bd&&Bd in Object(t)?bg(t):Ig(t)}function me(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Og="[object AsyncFunction]",Mg="[object Function]",Ng="[object GeneratorFunction]",xg="[object Proxy]";function mr(t){if(!me(t))return!1;var e=We(t);return e==Mg||e==Ng||e==Og||e==xg}var Lg=De["__core-js_shared__"];const ds=Lg;var Gd=function(){var t=/[^.]+$/.exec(ds&&ds.keys&&ds.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function $g(t){return!!Gd&&Gd in t}var Ug=Function.prototype,Fg=Ug.toString;function gn(t){if(t!=null){try{return Fg.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var Vg=/[\\^$.*+?()[\]{}|]/g,Bg=/^\[object .+?Constructor\]$/,Gg=Function.prototype,qg=Object.prototype,Hg=Gg.toString,Wg=qg.hasOwnProperty,jg=RegExp("^"+Hg.call(Wg).replace(Vg,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Bl(t){if(!me(t)||$g(t))return!1;var e=mr(t)?jg:Bg;return e.test(gn(t))}function Kg(t,e){return t==null?void 0:t[e]}function _n(t,e){var r=Kg(t,e);return Bl(r)?r:void 0}var Jg=_n(De,"Map");const vi=Jg;var Yg=_n(Object,"create");const Ti=Yg;function zg(){this.__data__=Ti?Ti(null):{},this.size=0}function Xg(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Qg="__lodash_hash_undefined__",Zg=Object.prototype,e_=Zg.hasOwnProperty;function t_(t){var e=this.__data__;if(Ti){var r=e[t];return r===Qg?void 0:r}return e_.call(e,t)?e[t]:void 0}var r_=Object.prototype,n_=r_.hasOwnProperty;function i_(t){var e=this.__data__;return Ti?e[t]!==void 0:n_.call(e,t)}var s_="__lodash_hash_undefined__";function a_(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Ti&&e===void 0?s_:e,this}function hn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}hn.prototype.clear=zg;hn.prototype.delete=Xg;hn.prototype.get=t_;hn.prototype.has=i_;hn.prototype.set=a_;function o_(){this.size=0,this.__data__={hash:new hn,map:new(vi||pr),string:new hn}}function c_(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function ia(t,e){var r=t.__data__;return c_(e)?r[typeof e=="string"?"string":"hash"]:r.map}function d_(t){var e=ia(this,t).delete(t);return this.size-=e?1:0,e}function u_(t){return ia(this,t).get(t)}function l_(t){return ia(this,t).has(t)}function h_(t,e){var r=ia(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function gr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}gr.prototype.clear=o_;gr.prototype.delete=d_;gr.prototype.get=u_;gr.prototype.has=l_;gr.prototype.set=h_;var f_=200;function p_(t,e){var r=this.__data__;if(r instanceof pr){var n=r.__data__;if(!vi||n.length<f_-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new gr(n)}return r.set(t,e),this.size=r.size,this}function Ct(t){var e=this.__data__=new pr(t);this.size=e.size}Ct.prototype.clear=gg;Ct.prototype.delete=_g;Ct.prototype.get=vg;Ct.prototype.has=Tg;Ct.prototype.set=p_;function At(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var m_=function(){try{var t=_n(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();const ys=m_;function _r(t,e,r){e=="__proto__"&&ys?ys(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var g_=Object.prototype,__=g_.hasOwnProperty;function Gi(t,e,r){var n=t[e];(!(__.call(t,e)&&Dt(n,r))||r===void 0&&!(e in t))&&_r(t,e,r)}function Wt(t,e,r,n){var i=!r;r||(r={});for(var s=-1,a=e.length;++s<a;){var o=e[s],c=n?n(r[o],t[o],o,r,t):void 0;c===void 0&&(c=t[o]),i?_r(r,o,c):Gi(r,o,c)}return r}function nc(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function Te(t){return t!=null&&typeof t=="object"}var v_="[object Arguments]";function qd(t){return Te(t)&&We(t)==v_}var Gl=Object.prototype,T_=Gl.hasOwnProperty,E_=Gl.propertyIsEnumerable,w_=qd(function(){return arguments}())?qd:function(t){return Te(t)&&T_.call(t,"callee")&&!E_.call(t,"callee")};const fn=w_;var y_=Array.isArray;const F=y_;function ic(){return!1}var ql=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Hd=ql&&typeof module=="object"&&module&&!module.nodeType&&module,A_=Hd&&Hd.exports===ql,Wd=A_?De.Buffer:void 0,R_=Wd?Wd.isBuffer:void 0,S_=R_||ic;const Lr=S_;var b_=9007199254740991,k_=/^(?:0|[1-9]\d*)$/;function vr(t,e){var r=typeof t;return e=e==null?b_:e,!!e&&(r=="number"||r!="symbol"&&k_.test(t))&&t>-1&&t%1==0&&t<e}var C_=9007199254740991;function sa(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=C_}var I_="[object Arguments]",P_="[object Array]",D_="[object Boolean]",O_="[object Date]",M_="[object Error]",N_="[object Function]",x_="[object Map]",L_="[object Number]",$_="[object Object]",U_="[object RegExp]",F_="[object Set]",V_="[object String]",B_="[object WeakMap]",G_="[object ArrayBuffer]",q_="[object DataView]",H_="[object Float32Array]",W_="[object Float64Array]",j_="[object Int8Array]",K_="[object Int16Array]",J_="[object Int32Array]",Y_="[object Uint8Array]",z_="[object Uint8ClampedArray]",X_="[object Uint16Array]",Q_="[object Uint32Array]",ue={};ue[H_]=ue[W_]=ue[j_]=ue[K_]=ue[J_]=ue[Y_]=ue[z_]=ue[X_]=ue[Q_]=!0;ue[I_]=ue[P_]=ue[G_]=ue[D_]=ue[q_]=ue[O_]=ue[M_]=ue[N_]=ue[x_]=ue[L_]=ue[$_]=ue[U_]=ue[F_]=ue[V_]=ue[B_]=!1;function Z_(t){return Te(t)&&sa(t.length)&&!!ue[We(t)]}function at(t){return function(e){return t(e)}}var Hl=typeof exports=="object"&&exports&&!exports.nodeType&&exports,pi=Hl&&typeof module=="object"&&module&&!module.nodeType&&module,ev=pi&&pi.exports===Hl,Za=ev&&Fl.process,tv=function(){try{var t=pi&&pi.require&&pi.require("util").types;return t||Za&&Za.binding&&Za.binding("util")}catch(e){}}();const Et=tv;var jd=Et&&Et.isTypedArray,rv=jd?at(jd):Z_;const zn=rv;var nv=Object.prototype,iv=nv.hasOwnProperty;function Wl(t,e){var r=F(t),n=!r&&fn(t),i=!r&&!n&&Lr(t),s=!r&&!n&&!i&&zn(t),a=r||n||i||s,o=a?nc(t.length,String):[],c=o.length;for(var u in t)(e||iv.call(t,u))&&!(a&&(u=="length"||i&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||vr(u,c)))&&o.push(u);return o}var sv=Object.prototype;function qi(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||sv;return t===r}function jl(t,e){return function(r){return t(e(r))}}var av=jl(Object.keys,Object);const ov=av;var cv=Object.prototype,dv=cv.hasOwnProperty;function sc(t){if(!qi(t))return ov(t);var e=[];for(var r in Object(t))dv.call(t,r)&&r!="constructor"&&e.push(r);return e}function Ze(t){return t!=null&&sa(t.length)&&!mr(t)}function Ie(t){return Ze(t)?Wl(t):sc(t)}function Kl(t,e){return t&&Wt(e,Ie(e),t)}function uv(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var lv=Object.prototype,hv=lv.hasOwnProperty;function fv(t){if(!me(t))return uv(t);var e=qi(t),r=[];for(var n in t)n=="constructor"&&(e||!hv.call(t,n))||r.push(n);return r}function et(t){return Ze(t)?Wl(t,!0):fv(t)}function pv(t,e){return t&&Wt(e,et(e),t)}var Jl=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Kd=Jl&&typeof module=="object"&&module&&!module.nodeType&&module,mv=Kd&&Kd.exports===Jl,Jd=mv?De.Buffer:void 0,Yd=Jd?Jd.allocUnsafe:void 0;function Yl(t,e){if(e)return t.slice();var r=t.length,n=Yd?Yd(r):new t.constructor(r);return t.copy(n),n}function Xe(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function Vr(t,e){for(var r=-1,n=t==null?0:t.length,i=0,s=[];++r<n;){var a=t[r];e(a,r,t)&&(s[i++]=a)}return s}function ac(){return[]}var gv=Object.prototype,_v=gv.propertyIsEnumerable,zd=Object.getOwnPropertySymbols,vv=zd?function(t){return t==null?[]:(t=Object(t),Vr(zd(t),function(e){return _v.call(t,e)}))}:ac;const oc=vv;function Tv(t,e){return Wt(t,oc(t),e)}function Br(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var Ev=jl(Object.getPrototypeOf,Object);const aa=Ev;var wv=Object.getOwnPropertySymbols,yv=wv?function(t){for(var e=[];t;)Br(e,oc(t)),t=aa(t);return e}:ac;const zl=yv;function Av(t,e){return Wt(t,zl(t),e)}function Xl(t,e,r){var n=e(t);return F(t)?n:Br(n,r(t))}function wo(t){return Xl(t,Ie,oc)}function cc(t){return Xl(t,et,zl)}var Rv=_n(De,"DataView");const yo=Rv;var Sv=_n(De,"Promise");const Ao=Sv;var bv=_n(De,"Set");const On=bv;var kv=_n(De,"WeakMap");const Ei=kv;var Xd="[object Map]",Cv="[object Object]",Qd="[object Promise]",Zd="[object Set]",eu="[object WeakMap]",tu="[object DataView]",Iv=gn(yo),Pv=gn(vi),Dv=gn(Ao),Ov=gn(On),Mv=gn(Ei),Kr=We;(yo&&Kr(new yo(new ArrayBuffer(1)))!=tu||vi&&Kr(new vi)!=Xd||Ao&&Kr(Ao.resolve())!=Qd||On&&Kr(new On)!=Zd||Ei&&Kr(new Ei)!=eu)&&(Kr=function(t){var e=We(t),r=e==Cv?t.constructor:void 0,n=r?gn(r):"";if(n)switch(n){case Iv:return tu;case Pv:return Xd;case Dv:return Qd;case Ov:return Zd;case Mv:return eu}return e});const qt=Kr;var Nv=Object.prototype,xv=Nv.hasOwnProperty;function Lv(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&xv.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var $v=De.Uint8Array;const As=$v;function dc(t){var e=new t.constructor(t.byteLength);return new As(e).set(new As(t)),e}function Uv(t,e){var r=e?dc(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}var Fv=/\w*$/;function Vv(t){var e=new t.constructor(t.source,Fv.exec(t));return e.lastIndex=t.lastIndex,e}var ru=Fe?Fe.prototype:void 0,nu=ru?ru.valueOf:void 0;function Bv(t){return nu?Object(nu.call(t)):{}}function Ql(t,e){var r=e?dc(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var Gv="[object Boolean]",qv="[object Date]",Hv="[object Map]",Wv="[object Number]",jv="[object RegExp]",Kv="[object Set]",Jv="[object String]",Yv="[object Symbol]",zv="[object ArrayBuffer]",Xv="[object DataView]",Qv="[object Float32Array]",Zv="[object Float64Array]",eT="[object Int8Array]",tT="[object Int16Array]",rT="[object Int32Array]",nT="[object Uint8Array]",iT="[object Uint8ClampedArray]",sT="[object Uint16Array]",aT="[object Uint32Array]";function oT(t,e,r){var n=t.constructor;switch(e){case zv:return dc(t);case Gv:case qv:return new n(+t);case Xv:return Uv(t,r);case Qv:case Zv:case eT:case tT:case rT:case nT:case iT:case sT:case aT:return Ql(t,r);case Hv:return new n;case Wv:case Jv:return new n(t);case jv:return Vv(t);case Kv:return new n;case Yv:return Bv(t)}}var iu=Object.create,cT=function(){function t(){}return function(e){if(!me(e))return{};if(iu)return iu(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();const Xn=cT;function Zl(t){return typeof t.constructor=="function"&&!qi(t)?Xn(aa(t)):{}}var dT="[object Map]";function uT(t){return Te(t)&&qt(t)==dT}var su=Et&&Et.isMap,lT=su?at(su):uT;const eh=lT;var hT="[object Set]";function fT(t){return Te(t)&&qt(t)==hT}var au=Et&&Et.isSet,pT=au?at(au):fT;const th=pT;var mT=1,gT=2,_T=4,rh="[object Arguments]",vT="[object Array]",TT="[object Boolean]",ET="[object Date]",wT="[object Error]",nh="[object Function]",yT="[object GeneratorFunction]",AT="[object Map]",RT="[object Number]",ih="[object Object]",ST="[object RegExp]",bT="[object Set]",kT="[object String]",CT="[object Symbol]",IT="[object WeakMap]",PT="[object ArrayBuffer]",DT="[object DataView]",OT="[object Float32Array]",MT="[object Float64Array]",NT="[object Int8Array]",xT="[object Int16Array]",LT="[object Int32Array]",$T="[object Uint8Array]",UT="[object Uint8ClampedArray]",FT="[object Uint16Array]",VT="[object Uint32Array]",oe={};oe[rh]=oe[vT]=oe[PT]=oe[DT]=oe[TT]=oe[ET]=oe[OT]=oe[MT]=oe[NT]=oe[xT]=oe[LT]=oe[AT]=oe[RT]=oe[ih]=oe[ST]=oe[bT]=oe[kT]=oe[CT]=oe[$T]=oe[UT]=oe[FT]=oe[VT]=!0;oe[wT]=oe[nh]=oe[IT]=!1;function _t(t,e,r,n,i,s){var a,o=e&mT,c=e&gT,u=e&_T;if(r&&(a=i?r(t,n,i,s):r(t)),a!==void 0)return a;if(!me(t))return t;var h=F(t);if(h){if(a=Lv(t),!o)return Xe(t,a)}else{var f=qt(t),m=f==nh||f==yT;if(Lr(t))return Yl(t,o);if(f==ih||f==rh||m&&!i){if(a=c||m?{}:Zl(t),!o)return c?Av(t,pv(a,t)):Tv(t,Kl(a,t))}else{if(!oe[f])return i?t:{};a=oT(t,f,o)}}s||(s=new Ct);var T=s.get(t);if(T)return T;s.set(t,a),th(t)?t.forEach(function(R){a.add(_t(R,e,r,R,t,s))}):eh(t)&&t.forEach(function(R,b){a.set(b,_t(R,e,r,b,t,s))});var A=u?c?cc:wo:c?et:Ie,C=h?void 0:A(t);return At(C||t,function(R,b){C&&(b=R,R=t[b]),Gi(a,b,_t(R,e,r,b,t,s))}),a}var BT=1,GT=4;function oa(t){return _t(t,BT|GT)}var qT="[object Symbol]";function ot(t){return typeof t=="symbol"||Te(t)&&We(t)==qT}var HT=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,WT=/^\w*$/;function uc(t,e){if(F(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||ot(t)?!0:WT.test(t)||!HT.test(t)||e!=null&&t in Object(e)}var jT="Expected a function";function ca(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(jT);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=t.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(ca.Cache||gr),r}ca.Cache=gr;var KT=500;function JT(t){var e=ca(t,function(n){return r.size===KT&&r.clear(),n}),r=e.cache;return e}var YT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zT=/\\(\\)?/g,XT=JT(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(YT,function(r,n,i,s){e.push(i?s.replace(zT,"$1"):n||r)}),e});const sh=XT;function pe(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}var QT=1/0,ou=Fe?Fe.prototype:void 0,cu=ou?ou.toString:void 0;function ct(t){if(typeof t=="string")return t;if(F(t))return pe(t,ct)+"";if(ot(t))return cu?cu.call(t):"";var e=t+"";return e=="0"&&1/t==-QT?"-0":e}function X(t){return t==null?"":ct(t)}function Gr(t,e){return F(t)?t:uc(t,e)?[t]:sh(X(t))}var ZT=1/0;function jt(t){if(typeof t=="string"||ot(t))return t;var e=t+"";return e=="0"&&1/t==-ZT?"-0":e}function vn(t,e){e=Gr(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[jt(e[r++])];return r&&r==n?t:void 0}function lc(t,e,r){var n=t==null?void 0:vn(t,e);return n===void 0?r:n}var eE=Object.prototype,tE=eE.hasOwnProperty;function rE(t,e){return t!=null&&tE.call(t,e)}function ah(t,e,r){e=Gr(e,t);for(var n=-1,i=e.length,s=!1;++n<i;){var a=jt(e[n]);if(!(s=t!=null&&r(t,a)))break;t=t[a]}return s||++n!=i?s:(i=t==null?0:t.length,!!i&&sa(i)&&vr(a,i)&&(F(t)||fn(t)))}function nE(t,e){return t!=null&&ah(t,e,rE)}function Hi(t,e,r,n){if(!me(t))return t;e=Gr(e,t);for(var i=-1,s=e.length,a=s-1,o=t;o!=null&&++i<s;){var c=jt(e[i]),u=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(i!=a){var h=o[c];u=n?n(h,c,o):void 0,u===void 0&&(u=me(h)?h:vr(e[i+1])?[]:{})}Gi(o,c,u),o=o[c]}return t}function iE(t,e,r){return t==null?t:Hi(t,e,r)}const sE={border_radius:"rounded",border_width:"thin",spacing_base:4,theme:"dark",colors:{brand:og("#2160FD"),background:cg("#141414"),danger:"#FF2D2D",text:"#EEEEEE",text_on_brand:"#EEEEEE",success:"#62A504",video_bg:"#191919",warning:"#FFCD07"}};function oh(){return oa(sE)}const aE={permissions:{can_accept_production_requests:!1,can_edit_display_name:!0,accept_waiting_requests:!1,disable_participant_audio:!1,disable_participant_screensharing:!1,disable_participant_video:!1,can_spotlight:!1,kick_participant:!1,pin_participant:!1,can_record:!1,can_livestream:!1,waiting_room_type:vs.Skip,plugins:{can_close:!0,can_start:!0,can_edit_config:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},media:{video:{can_produce:x.Allowed,can_consume:Ts.Allowed},audio:{can_produce:x.Allowed},screenshare:{can_produce:x.Allowed,can_consume:Ts.Allowed}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1},channel:{can_create:"ALL",can_delete:"ALL",can_update:"ALL",can_read_all:!1},message:{can_delete:"ALL",can_edit:"ALL",delete_cutoff_time_seconds:0,edit_cutoff_time_seconds:0}},hidden_participant:!1,is_recorder:!1,recorder_type:Jn.none,show_participant_list:!0,transcription_enabled:!1,can_change_participant_permissions:!1,connected_meetings:{can_alter_connected_meetings:!1,can_switch_connected_meetings:!1,can_switch_to_parent_meeting:!1},stage_enabled:!1,stage_access:void 0,accept_stage_requests:!1},ui:{oldTheme:{setup_screen:{is_enabled:!1},alone_here:{is_enabled:!1},waiting_room:{is_enabled:!1,enable_preview:!0},control_bar:{is_enabled:!0,elements:{plugins:!0,screenshare:!0,invite:!1,participants:!0,chat:!0,reactions:!1,polls:!0,fullscreen:!0,layout:!0}},header:{is_enabled:!0,elements:{timer:!0,title:!0,participant_count:!0,change_layout:!0}},pip_mode:!0,auto_tune:!0,colors:{primary:"#2160FD",secondary:"#1A1A1A",text:"#EEEEEE",background:"#1A1A1A",textPrimary:"#EEEEEE",videoBackground:"#1A1A1A"},dimensions:{mode:"fillParent"},grid:{multi:{maxVideoCount:6,videoFit:"cover"},single:{maxVideoCount:6,videoFit:"cover"},defaultView:"MULTI"},controls:{pip_toggle:!1},plugins:[]},design_tokens:oh(),config_diff:{}},config:{view_type:st.GroupCall,media:{audio:{enable_stereo:!1,enable_high_bitrate:!1},video:{quality:"vga",frame_rate:24},screenshare:{quality:"hd",frame_rate:5}},max_video_streams:{mobile:6,desktop:6},max_screenshare_count:1},version:"hybrid"};function oE(){return oa(aE)}Jn.none,Es.skip;const cE={permissions:{can_accept_production_requests:!1,can_edit_display_name:!0,accept_waiting_requests:!1,disable_participant_audio:!1,disable_participant_screensharing:!1,disable_participant_video:!1,can_spotlight:!1,kick_participant:!1,pin_participant:!1,can_record:!1,can_livestream:!1,waiting_room_type:vs.Skip,plugins:{can_close:!0,can_start:!0,can_edit_config:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},media:{video:{can_produce:x.Allowed},audio:{can_produce:x.Allowed},screenshare:{can_produce:x.Allowed}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1}},hidden_participant:!1,is_recorder:!1,recorder_type:Jn.none,show_participant_list:!0,transcription_enabled:!1,can_change_participant_permissions:!1,connected_meetings:{can_alter_connected_meetings:!1,can_switch_connected_meetings:!1,can_switch_to_parent_meeting:!1},stage_enabled:!1,stage_access:void 0,accept_stage_requests:!1},ui:{design_tokens:oh(),config_diff:{}},config:{view_type:st.GroupCall,media:{audio:{enable_stereo:!1,enable_high_bitrate:!1},video:{quality:"vga",frame_rate:24},screenshare:{quality:"hd",frame_rate:5}},max_video_streams:{mobile:6,desktop:6},max_screenshare_count:1},version:"2.0.0"};function hc(){return oa(cE)}var dE=0/0;function du(t){return typeof t=="number"?t:ot(t)?dE:+t}function da(t,e){return function(r,n){var i;if(r===void 0&&n===void 0)return e;if(r!==void 0&&(i=r),n!==void 0){if(i===void 0)return n;typeof r=="string"||typeof n=="string"?(r=ct(r),n=ct(n)):(r=du(r),n=du(n)),i=t(r,n)}return i}}var uE=da(function(t,e){return t+e},0);const lE=uE;var hE=/\s/;function ch(t){for(var e=t.length;e--&&hE.test(t.charAt(e)););return e}var fE=/^\s+/;function dh(t){return t&&t.slice(0,ch(t)+1).replace(fE,"")}var uu=0/0,pE=/^[-+]0x[0-9a-f]+$/i,mE=/^0b[01]+$/i,gE=/^0o[0-7]+$/i,_E=parseInt;function vt(t){if(typeof t=="number")return t;if(ot(t))return uu;if(me(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=me(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=dh(t);var r=mE.test(t);return r||gE.test(t)?_E(t.slice(2),r?2:8):pE.test(t)?uu:+t}var lu=1/0,vE=17976931348623157e292;function hr(t){if(!t)return t===0?t:0;if(t=vt(t),t===lu||t===-lu){var e=t<0?-1:1;return e*vE}return t===t?t:0}function V(t){var e=hr(t),r=e%1;return e===e?r?e-r:e:0}var TE="Expected a function";function EE(t,e){if(typeof e!="function")throw new TypeError(TE);return t=V(t),function(){if(--t<1)return e.apply(this,arguments)}}function je(t){return t}var wE=Ei&&new Ei;const Rs=wE;var yE=Rs?function(t,e){return Rs.set(t,e),t}:je;const uh=yE;function wi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Xn(t.prototype),n=t.apply(r,e);return me(n)?n:r}}var AE=1;function RE(t,e,r){var n=e&AE,i=wi(t);function s(){var a=this&&this!==De&&this instanceof s?i:t;return a.apply(n?r:this,arguments)}return s}function dt(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var SE=Math.max;function lh(t,e,r,n){for(var i=-1,s=t.length,a=r.length,o=-1,c=e.length,u=SE(s-a,0),h=Array(c+u),f=!n;++o<c;)h[o]=e[o];for(;++i<a;)(f||i<s)&&(h[r[i]]=t[i]);for(;u--;)h[o++]=t[i++];return h}var bE=Math.max;function hh(t,e,r,n){for(var i=-1,s=t.length,a=-1,o=r.length,c=-1,u=e.length,h=bE(s-o,0),f=Array(h+u),m=!n;++i<h;)f[i]=t[i];for(var T=i;++c<u;)f[T+c]=e[c];for(;++a<o;)(m||i<s)&&(f[T+r[a]]=t[i++]);return f}function kE(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}function ua(){}var CE=4294967295;function q(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=CE,this.__views__=[]}q.prototype=Xn(ua.prototype);q.prototype.constructor=q;function fc(){}var IE=Rs?function(t){return Rs.get(t)}:fc;const pc=IE;var PE={};const Mn=PE;var DE=Object.prototype,OE=DE.hasOwnProperty;function us(t){for(var e=t.name+"",r=Mn[e],n=OE.call(Mn,e)?r.length:0;n--;){var i=r[n],s=i.func;if(s==null||s==t)return i.name}return e}function wt(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}wt.prototype=Xn(ua.prototype);wt.prototype.constructor=wt;function fh(t){if(t instanceof q)return t.clone();var e=new wt(t.__wrapped__,t.__chain__);return e.__actions__=Xe(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var ME=Object.prototype,NE=ME.hasOwnProperty;function l(t){if(Te(t)&&!F(t)&&!(t instanceof q)){if(t instanceof wt)return t;if(NE.call(t,"__wrapped__"))return fh(t)}return new wt(t)}l.prototype=ua.prototype;l.prototype.constructor=l;function Ro(t){var e=us(t),r=l[e];if(typeof r!="function"||!(e in q.prototype))return!1;if(t===r)return!0;var n=pc(r);return!!n&&t===n[0]}var xE=800,LE=16,$E=Date.now;function ph(t){var e=0,r=0;return function(){var n=$E(),i=LE-(n-r);if(r=n,i>0){if(++e>=xE)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var UE=ph(uh);const mh=UE;var FE=/\{\n\/\* \[wrapped with (.+)\] \*/,VE=/,? & /;function BE(t){var e=t.match(FE);return e?e[1].split(VE):[]}var GE=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function qE(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(GE,`{
/* [wrapped with `+e+`] */
`)}function mc(t){return function(){return t}}var HE=ys?function(t,e){return ys(t,"toString",{configurable:!0,enumerable:!1,value:mc(e),writable:!0})}:je;const WE=HE;var jE=ph(WE);const gc=jE;function la(t,e,r,n){for(var i=t.length,s=r+(n?1:-1);n?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function gh(t){return t!==t}function KE(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}function Qn(t,e,r){return e===e?KE(t,e,r):la(t,gh,r)}function ha(t,e){var r=t==null?0:t.length;return!!r&&Qn(t,e,0)>-1}var JE=1,YE=2,zE=8,XE=16,QE=32,ZE=64,ew=128,tw=256,rw=512,nw=[["ary",ew],["bind",JE],["bindKey",YE],["curry",zE],["curryRight",XE],["flip",rw],["partial",QE],["partialRight",ZE],["rearg",tw]];function iw(t,e){return At(nw,function(r){var n="_."+r[0];e&r[1]&&!ha(t,n)&&t.push(n)}),t.sort()}function _h(t,e,r){var n=e+"";return gc(t,qE(n,iw(BE(n),r)))}var sw=1,aw=2,ow=4,cw=8,hu=32,fu=64;function vh(t,e,r,n,i,s,a,o,c,u){var h=e&cw,f=h?a:void 0,m=h?void 0:a,T=h?s:void 0,A=h?void 0:s;e|=h?hu:fu,e&=~(h?fu:hu),e&ow||(e&=~(sw|aw));var C=[t,e,i,T,f,A,m,o,c,u],R=r.apply(void 0,C);return Ro(t)&&mh(R,C),R.placeholder=n,_h(R,t,e)}function Zn(t){var e=t;return e.placeholder}var dw=Math.min;function uw(t,e){for(var r=t.length,n=dw(e.length,r),i=Xe(t);n--;){var s=e[n];t[n]=vr(s,r)?i[s]:void 0}return t}var pu="__lodash_placeholder__";function $r(t,e){for(var r=-1,n=t.length,i=0,s=[];++r<n;){var a=t[r];(a===e||a===pu)&&(t[r]=pu,s[i++]=r)}return s}var lw=1,hw=2,fw=8,pw=16,mw=128,gw=512;function fa(t,e,r,n,i,s,a,o,c,u){var h=e&mw,f=e&lw,m=e&hw,T=e&(fw|pw),A=e&gw,C=m?void 0:wi(t);function R(){for(var b=arguments.length,D=Array(b),H=b;H--;)D[H]=arguments[H];if(T)var k=Zn(R),Z=kE(D,k);if(n&&(D=lh(D,n,i,T)),s&&(D=hh(D,s,a,T)),b-=Z,T&&b<u){var K=$r(D,k);return vh(t,e,fa,R.placeholder,r,D,K,o,c,u-b)}var ve=f?r:this,Ge=m?ve[t]:t;return b=D.length,o?D=uw(D,o):A&&b>1&&D.reverse(),h&&c<b&&(D.length=c),this&&this!==De&&this instanceof R&&(Ge=C||wi(Ge)),Ge.apply(ve,D)}return R}function _w(t,e,r){var n=wi(t);function i(){for(var s=arguments.length,a=Array(s),o=s,c=Zn(i);o--;)a[o]=arguments[o];var u=s<3&&a[0]!==c&&a[s-1]!==c?[]:$r(a,c);if(s-=u.length,s<r)return vh(t,e,fa,i.placeholder,void 0,a,u,void 0,void 0,r-s);var h=this&&this!==De&&this instanceof i?n:t;return dt(h,this,a)}return i}var vw=1;function Tw(t,e,r,n){var i=e&vw,s=wi(t);function a(){for(var o=-1,c=arguments.length,u=-1,h=n.length,f=Array(h+c),m=this&&this!==De&&this instanceof a?s:t;++u<h;)f[u]=n[u];for(;c--;)f[u++]=arguments[++o];return dt(m,i?r:this,f)}return a}var mu="__lodash_placeholder__",eo=1,Ew=2,ww=4,gu=8,ui=128,_u=256,yw=Math.min;function Aw(t,e){var r=t[1],n=e[1],i=r|n,s=i<(eo|Ew|ui),a=n==ui&&r==gu||n==ui&&r==_u&&t[7].length<=e[8]||n==(ui|_u)&&e[7].length<=e[8]&&r==gu;if(!(s||a))return t;n&eo&&(t[2]=e[2],i|=r&eo?0:ww);var o=e[3];if(o){var c=t[3];t[3]=c?lh(c,o,e[4]):o,t[4]=c?$r(t[3],mu):e[4]}return o=e[5],o&&(c=t[5],t[5]=c?hh(c,o,e[6]):o,t[6]=c?$r(t[5],mu):e[6]),o=e[7],o&&(t[7]=o),n&ui&&(t[8]=t[8]==null?e[8]:yw(t[8],e[8])),t[9]==null&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}var Rw="Expected a function",vu=1,Sw=2,to=8,ro=16,no=32,Tu=64,Eu=Math.max;function Tr(t,e,r,n,i,s,a,o){var c=e&Sw;if(!c&&typeof t!="function")throw new TypeError(Rw);var u=n?n.length:0;if(u||(e&=~(no|Tu),n=i=void 0),a=a===void 0?a:Eu(V(a),0),o=o===void 0?o:V(o),u-=i?i.length:0,e&Tu){var h=n,f=i;n=i=void 0}var m=c?void 0:pc(t),T=[t,e,r,n,i,h,f,s,a,o];if(m&&Aw(T,m),t=T[0],e=T[1],r=T[2],n=T[3],i=T[4],o=T[9]=T[9]===void 0?c?0:t.length:Eu(T[9]-u,0),!o&&e&(to|ro)&&(e&=~(to|ro)),!e||e==vu)var A=RE(t,e,r);else e==to||e==ro?A=_w(t,e,o):(e==no||e==(vu|no))&&!i.length?A=Tw(t,e,r,n):A=fa.apply(void 0,T);var C=m?uh:mh;return _h(C(A,T),t,e)}var bw=128;function Th(t,e,r){return e=r?void 0:e,e=t&&e==null?t.length:e,Tr(t,bw,void 0,void 0,void 0,void 0,e)}var wu=Math.max;function Eh(t,e,r){return e=wu(e===void 0?t.length-1:e,0),function(){for(var n=arguments,i=-1,s=wu(n.length-e,0),a=Array(s);++i<s;)a[i]=n[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=n[i];return o[e]=r(a),dt(t,this,o)}}function G(t,e){return gc(Eh(t,e,je),t+"")}function He(t,e,r){if(!me(r))return!1;var n=typeof e;return(n=="number"?Ze(r)&&vr(e,r.length):n=="string"&&e in r)?Dt(r[e],t):!1}function ei(t){return G(function(e,r){var n=-1,i=r.length,s=i>1?r[i-1]:void 0,a=i>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,a&&He(r[0],r[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++n<i;){var o=r[n];o&&t(e,o,n,s)}return e})}var kw=Object.prototype,Cw=kw.hasOwnProperty,Iw=ei(function(t,e){if(qi(e)||Ze(e)){Wt(e,Ie(e),t);return}for(var r in e)Cw.call(e,r)&&Gi(t,r,e[r])});const Pw=Iw;var Dw=ei(function(t,e){Wt(e,et(e),t)});const yu=Dw;var Ow=ei(function(t,e,r,n){Wt(e,et(e),t,n)});const Ss=Ow;var Mw=ei(function(t,e,r,n){Wt(e,Ie(e),t,n)});const Nw=Mw;function _c(t,e){for(var r=-1,n=e.length,i=Array(n),s=t==null;++r<n;)i[r]=s?void 0:lc(t,e[r]);return i}var Au=Fe?Fe.isConcatSpreadable:void 0;function xw(t){return F(t)||fn(t)||!!(Au&&t&&t[Au])}function Ne(t,e,r,n,i){var s=-1,a=t.length;for(r||(r=xw),i||(i=[]);++s<a;){var o=t[s];e>0&&r(o)?e>1?Ne(o,e-1,r,n,i):Br(i,o):n||(i[i.length]=o)}return i}function wh(t){var e=t==null?0:t.length;return e?Ne(t,1):[]}function Er(t){return gc(Eh(t,void 0,wh),t+"")}var Lw=Er(_c);const $w=Lw;var Uw="[object Object]",Fw=Function.prototype,Vw=Object.prototype,yh=Fw.toString,Bw=Vw.hasOwnProperty,Gw=yh.call(Object);function Wi(t){if(!Te(t)||We(t)!=Uw)return!1;var e=aa(t);if(e===null)return!0;var r=Bw.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&yh.call(r)==Gw}var qw="[object DOMException]",Hw="[object Error]";function vc(t){if(!Te(t))return!1;var e=We(t);return e==Hw||e==qw||typeof t.message=="string"&&typeof t.name=="string"&&!Wi(t)}var Ww=G(function(t,e){try{return dt(t,void 0,e)}catch(r){return vc(r)?r:new Error(r)}});const Ah=Ww;var jw="Expected a function";function Rh(t,e){var r;if(typeof e!="function")throw new TypeError(jw);return t=V(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=void 0),r}}var Kw=1,Jw=32,Tc=G(function(t,e,r){var n=Kw;if(r.length){var i=$r(r,Zn(Tc));n|=Jw}return Tr(t,n,e,r,i)});Tc.placeholder={};const Sh=Tc;var Yw=Er(function(t,e){return At(e,function(r){r=jt(r),_r(t,r,Sh(t[r],t))}),t});const zw=Yw;var Xw=1,Qw=2,Zw=32,Ec=G(function(t,e,r){var n=Xw|Qw;if(r.length){var i=$r(r,Zn(Ec));n|=Zw}return Tr(e,n,t,r,i)});Ec.placeholder={};const ey=Ec;function yt(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=Array(i);++n<i;)s[n]=t[n+e];return s}function qr(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:yt(t,e,r)}var ty="\\ud800-\\udfff",ry="\\u0300-\\u036f",ny="\\ufe20-\\ufe2f",iy="\\u20d0-\\u20ff",sy=ry+ny+iy,ay="\\ufe0e\\ufe0f",oy="\\u200d",cy=RegExp("["+oy+ty+sy+ay+"]");function ti(t){return cy.test(t)}function dy(t){return t.split("")}var bh="\\ud800-\\udfff",uy="\\u0300-\\u036f",ly="\\ufe20-\\ufe2f",hy="\\u20d0-\\u20ff",fy=uy+ly+hy,py="\\ufe0e\\ufe0f",my="["+bh+"]",So="["+fy+"]",bo="\\ud83c[\\udffb-\\udfff]",gy="(?:"+So+"|"+bo+")",kh="[^"+bh+"]",Ch="(?:\\ud83c[\\udde6-\\uddff]){2}",Ih="[\\ud800-\\udbff][\\udc00-\\udfff]",_y="\\u200d",Ph=gy+"?",Dh="["+py+"]?",vy="(?:"+_y+"(?:"+[kh,Ch,Ih].join("|")+")"+Dh+Ph+")*",Ty=Dh+Ph+vy,Ey="(?:"+[kh+So+"?",So,Ch,Ih,my].join("|")+")",wy=RegExp(bo+"(?="+bo+")|"+Ey+Ty,"g");function yy(t){return t.match(wy)||[]}function It(t){return ti(t)?yy(t):dy(t)}function Oh(t){return function(e){e=X(e);var r=ti(e)?It(e):void 0,n=r?r[0]:e.charAt(0),i=r?qr(r,1).join(""):e.slice(1);return n[t]()+i}}var Ay=Oh("toUpperCase");const wc=Ay;function Mh(t){return wc(X(t).toLowerCase())}function yc(t,e,r,n){var i=-1,s=t==null?0:t.length;for(n&&s&&(r=t[++i]);++i<s;)r=e(r,t[i],i,t);return r}function Ac(t){return function(e){return t==null?void 0:t[e]}}var Ry={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Sy=Ac(Ry);const by=Sy;var ky=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Cy="\\u0300-\\u036f",Iy="\\ufe20-\\ufe2f",Py="\\u20d0-\\u20ff",Dy=Cy+Iy+Py,Oy="["+Dy+"]",My=RegExp(Oy,"g");function Nh(t){return t=X(t),t&&t.replace(ky,by).replace(My,"")}var Ny=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function xy(t){return t.match(Ny)||[]}var Ly=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function $y(t){return Ly.test(t)}var xh="\\ud800-\\udfff",Uy="\\u0300-\\u036f",Fy="\\ufe20-\\ufe2f",Vy="\\u20d0-\\u20ff",By=Uy+Fy+Vy,Lh="\\u2700-\\u27bf",$h="a-z\\xdf-\\xf6\\xf8-\\xff",Gy="\\xac\\xb1\\xd7\\xf7",qy="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Hy="\\u2000-\\u206f",Wy=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Uh="A-Z\\xc0-\\xd6\\xd8-\\xde",jy="\\ufe0e\\ufe0f",Fh=Gy+qy+Hy+Wy,Vh="['’]",Ru="["+Fh+"]",Ky="["+By+"]",Bh="\\d+",Jy="["+Lh+"]",Gh="["+$h+"]",qh="[^"+xh+Fh+Bh+Lh+$h+Uh+"]",Yy="\\ud83c[\\udffb-\\udfff]",zy="(?:"+Ky+"|"+Yy+")",Xy="[^"+xh+"]",Hh="(?:\\ud83c[\\udde6-\\uddff]){2}",Wh="[\\ud800-\\udbff][\\udc00-\\udfff]",Cn="["+Uh+"]",Qy="\\u200d",Su="(?:"+Gh+"|"+qh+")",Zy="(?:"+Cn+"|"+qh+")",bu="(?:"+Vh+"(?:d|ll|m|re|s|t|ve))?",ku="(?:"+Vh+"(?:D|LL|M|RE|S|T|VE))?",jh=zy+"?",Kh="["+jy+"]?",eA="(?:"+Qy+"(?:"+[Xy,Hh,Wh].join("|")+")"+Kh+jh+")*",tA="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rA="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",nA=Kh+jh+eA,iA="(?:"+[Jy,Hh,Wh].join("|")+")"+nA,sA=RegExp([Cn+"?"+Gh+"+"+bu+"(?="+[Ru,Cn,"$"].join("|")+")",Zy+"+"+ku+"(?="+[Ru,Cn+Su,"$"].join("|")+")",Cn+"?"+Su+"+"+bu,Cn+"+"+ku,rA,tA,Bh,iA].join("|"),"g");function aA(t){return t.match(sA)||[]}function Jh(t,e,r){return t=X(t),e=r?void 0:e,e===void 0?$y(t)?aA(t):xy(t):t.match(e)||[]}var oA="['’]",cA=RegExp(oA,"g");function ri(t){return function(e){return yc(Jh(Nh(e).replace(cA,"")),t,"")}}var dA=ri(function(t,e,r){return e=e.toLowerCase(),t+(r?Mh(e):e)});const uA=dA;function lA(){if(!arguments.length)return[];var t=arguments[0];return F(t)?t:[t]}var hA=De.isFinite,fA=Math.min;function Rc(t){var e=Math[t];return function(r,n){if(r=vt(r),n=n==null?0:fA(V(n),292),n&&hA(r)){var i=(X(r)+"e").split("e"),s=e(i[0]+"e"+(+i[1]+n));return i=(X(s)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return e(r)}}var pA=Rc("ceil");const mA=pA;function Yh(t){var e=l(t);return e.__chain__=!0,e}var gA=Math.ceil,_A=Math.max;function vA(t,e,r){(r?He(t,e,r):e===void 0)?e=1:e=_A(V(e),0);var n=t==null?0:t.length;if(!n||e<1)return[];for(var i=0,s=0,a=Array(gA(n/e));i<n;)a[s++]=yt(t,i,i+=e);return a}function Tn(t,e,r){return t===t&&(r!==void 0&&(t=t<=r?t:r),e!==void 0&&(t=t>=e?t:e)),t}function TA(t,e,r){return r===void 0&&(r=e,e=void 0),r!==void 0&&(r=vt(r),r=r===r?r:0),e!==void 0&&(e=vt(e),e=e===e?e:0),Tn(vt(t),e,r)}var EA=4;function wA(t){return _t(t,EA)}var yA=1,AA=4;function RA(t,e){return e=typeof e=="function"?e:void 0,_t(t,yA|AA,e)}var SA=4;function bA(t,e){return e=typeof e=="function"?e:void 0,_t(t,SA,e)}function kA(){return new wt(this.value(),this.__chain__)}function CA(t){for(var e=-1,r=t==null?0:t.length,n=0,i=[];++e<r;){var s=t[e];s&&(i[n++]=s)}return i}function IA(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return Br(F(r)?Xe(r):[r],Ne(e,1))}var PA="__lodash_hash_undefined__";function DA(t){return this.__data__.set(t,PA),this}function OA(t){return this.__data__.has(t)}function pn(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new gr;++e<r;)this.add(t[e])}pn.prototype.add=pn.prototype.push=DA;pn.prototype.has=OA;function Sc(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function yi(t,e){return t.has(e)}var MA=1,NA=2;function zh(t,e,r,n,i,s){var a=r&MA,o=t.length,c=e.length;if(o!=c&&!(a&&c>o))return!1;var u=s.get(t),h=s.get(e);if(u&&h)return u==e&&h==t;var f=-1,m=!0,T=r&NA?new pn:void 0;for(s.set(t,e),s.set(e,t);++f<o;){var A=t[f],C=e[f];if(n)var R=a?n(C,A,f,e,t,s):n(A,C,f,t,e,s);if(R!==void 0){if(R)continue;m=!1;break}if(T){if(!Sc(e,function(b,D){if(!yi(T,D)&&(A===b||i(A,b,r,n,s)))return T.push(D)})){m=!1;break}}else if(!(A===C||i(A,C,r,n,s))){m=!1;break}}return s.delete(t),s.delete(e),m}function bc(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}function pa(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var xA=1,LA=2,$A="[object Boolean]",UA="[object Date]",FA="[object Error]",VA="[object Map]",BA="[object Number]",GA="[object RegExp]",qA="[object Set]",HA="[object String]",WA="[object Symbol]",jA="[object ArrayBuffer]",KA="[object DataView]",Cu=Fe?Fe.prototype:void 0,io=Cu?Cu.valueOf:void 0;function JA(t,e,r,n,i,s,a){switch(r){case KA:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case jA:return!(t.byteLength!=e.byteLength||!s(new As(t),new As(e)));case $A:case UA:case BA:return Dt(+t,+e);case FA:return t.name==e.name&&t.message==e.message;case GA:case HA:return t==e+"";case VA:var o=bc;case qA:var c=n&xA;if(o||(o=pa),t.size!=e.size&&!c)return!1;var u=a.get(t);if(u)return u==e;n|=LA,a.set(t,e);var h=zh(o(t),o(e),n,i,s,a);return a.delete(t),h;case WA:if(io)return io.call(t)==io.call(e)}return!1}var YA=1,zA=Object.prototype,XA=zA.hasOwnProperty;function QA(t,e,r,n,i,s){var a=r&YA,o=wo(t),c=o.length,u=wo(e),h=u.length;if(c!=h&&!a)return!1;for(var f=c;f--;){var m=o[f];if(!(a?m in e:XA.call(e,m)))return!1}var T=s.get(t),A=s.get(e);if(T&&A)return T==e&&A==t;var C=!0;s.set(t,e),s.set(e,t);for(var R=a;++f<c;){m=o[f];var b=t[m],D=e[m];if(n)var H=a?n(D,b,m,e,t,s):n(b,D,m,t,e,s);if(!(H===void 0?b===D||i(b,D,r,n,s):H)){C=!1;break}R||(R=m=="constructor")}if(C&&!R){var k=t.constructor,Z=e.constructor;k!=Z&&"constructor"in t&&"constructor"in e&&!(typeof k=="function"&&k instanceof k&&typeof Z=="function"&&Z instanceof Z)&&(C=!1)}return s.delete(t),s.delete(e),C}var ZA=1,Iu="[object Arguments]",Pu="[object Array]",Zi="[object Object]",eR=Object.prototype,Du=eR.hasOwnProperty;function tR(t,e,r,n,i,s){var a=F(t),o=F(e),c=a?Pu:qt(t),u=o?Pu:qt(e);c=c==Iu?Zi:c,u=u==Iu?Zi:u;var h=c==Zi,f=u==Zi,m=c==u;if(m&&Lr(t)){if(!Lr(e))return!1;a=!0,h=!1}if(m&&!h)return s||(s=new Ct),a||zn(t)?zh(t,e,r,n,i,s):JA(t,e,c,r,n,i,s);if(!(r&ZA)){var T=h&&Du.call(t,"__wrapped__"),A=f&&Du.call(e,"__wrapped__");if(T||A){var C=T?t.value():t,R=A?e.value():e;return s||(s=new Ct),i(C,R,r,n,s)}}return m?(s||(s=new Ct),QA(t,e,r,n,i,s)):!1}function ji(t,e,r,n,i){return t===e?!0:t==null||e==null||!Te(t)&&!Te(e)?t!==t&&e!==e:tR(t,e,r,n,ji,i)}var rR=1,nR=2;function kc(t,e,r,n){var i=r.length,s=i,a=!n;if(t==null)return!s;for(t=Object(t);i--;){var o=r[i];if(a&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=r[i];var c=o[0],u=t[c],h=o[1];if(a&&o[2]){if(u===void 0&&!(c in t))return!1}else{var f=new Ct;if(n)var m=n(u,h,c,t,e,f);if(!(m===void 0?ji(h,u,rR|nR,n,f):m))return!1}}return!0}function Xh(t){return t===t&&!me(t)}function Cc(t){for(var e=Ie(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,Xh(i)]}return e}function Qh(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function Zh(t){var e=Cc(t);return e.length==1&&e[0][2]?Qh(e[0][0],e[0][1]):function(r){return r===t||kc(r,t,e)}}function iR(t,e){return t!=null&&e in Object(t)}function Ic(t,e){return t!=null&&ah(t,e,iR)}var sR=1,aR=2;function ef(t,e){return uc(t)&&Xh(e)?Qh(jt(t),e):function(r){var n=lc(r,t);return n===void 0&&n===e?Ic(r,t):ji(e,n,sR|aR)}}function Pc(t){return function(e){return e==null?void 0:e[t]}}function oR(t){return function(e){return vn(e,t)}}function tf(t){return uc(t)?Pc(jt(t)):oR(t)}function U(t){return typeof t=="function"?t:t==null?je:typeof t=="object"?F(t)?ef(t[0],t[1]):Zh(t):tf(t)}var cR="Expected a function";function dR(t){var e=t==null?0:t.length,r=U;return t=e?pe(t,function(n){if(typeof n[1]!="function")throw new TypeError(cR);return[r(n[0]),n[1]]}):[],G(function(n){for(var i=-1;++i<e;){var s=t[i];if(dt(s[0],this,n))return dt(s[1],this,n)}})}function rf(t,e,r){var n=r.length;if(t==null)return!n;for(t=Object(t);n--;){var i=r[n],s=e[i],a=t[i];if(a===void 0&&!(i in t)||!s(a))return!1}return!0}function uR(t){var e=Ie(t);return function(r){return rf(r,t,e)}}var lR=1;function hR(t){return uR(_t(t,lR))}function fR(t,e){return e==null||rf(t,e,Ie(e))}function pR(t,e,r,n){for(var i=-1,s=t==null?0:t.length;++i<s;){var a=t[i];e(n,a,r(a),t)}return n}function nf(t){return function(e,r,n){for(var i=-1,s=Object(e),a=n(e),o=a.length;o--;){var c=a[t?o:++i];if(r(s[c],c,s)===!1)break}return e}}var mR=nf();const Dc=mR;function Kt(t,e){return t&&Dc(t,e,Ie)}function sf(t,e){return function(r,n){if(r==null)return r;if(!Ze(r))return t(r,n);for(var i=r.length,s=e?i:-1,a=Object(r);(e?s--:++s<i)&&n(a[s],s,a)!==!1;);return r}}var gR=sf(Kt);const Hr=gR;function _R(t,e,r,n){return Hr(t,function(i,s,a){e(n,i,r(i),a)}),n}function ma(t,e){return function(r,n){var i=F(r)?pR:_R,s=e?e():{};return i(r,t,U(n),s)}}var vR=Object.prototype,TR=vR.hasOwnProperty,ER=ma(function(t,e,r){TR.call(t,r)?++t[r]:_r(t,r,1)});const wR=ER;function yR(t,e){var r=Xn(t);return e==null?r:Kl(r,e)}var AR=8;function Oc(t,e,r){e=r?void 0:e;var n=Tr(t,AR,void 0,void 0,void 0,void 0,void 0,e);return n.placeholder=Oc.placeholder,n}Oc.placeholder={};var RR=16;function Mc(t,e,r){e=r?void 0:e;var n=Tr(t,RR,void 0,void 0,void 0,void 0,void 0,e);return n.placeholder=Mc.placeholder,n}Mc.placeholder={};var SR=function(){return De.Date.now()};const ls=SR;var bR="Expected a function",kR=Math.max,CR=Math.min;function ga(t,e,r){var n,i,s,a,o,c,u=0,h=!1,f=!1,m=!0;if(typeof t!="function")throw new TypeError(bR);e=vt(e)||0,me(r)&&(h=!!r.leading,f="maxWait"in r,s=f?kR(vt(r.maxWait)||0,e):s,m="trailing"in r?!!r.trailing:m);function T(K){var ve=n,Ge=i;return n=i=void 0,u=K,a=t.apply(Ge,ve),a}function A(K){return u=K,o=setTimeout(b,e),h?T(K):a}function C(K){var ve=K-c,Ge=K-u,ci=e-ve;return f?CR(ci,s-Ge):ci}function R(K){var ve=K-c,Ge=K-u;return c===void 0||ve>=e||ve<0||f&&Ge>=s}function b(){var K=ls();if(R(K))return D(K);o=setTimeout(b,C(K))}function D(K){return o=void 0,m&&n?T(K):(n=i=void 0,a)}function H(){o!==void 0&&clearTimeout(o),u=0,n=c=i=o=void 0}function k(){return o===void 0?a:D(ls())}function Z(){var K=ls(),ve=R(K);if(n=arguments,i=this,c=K,ve){if(o===void 0)return A(c);if(f)return clearTimeout(o),o=setTimeout(b,e),T(c)}return o===void 0&&(o=setTimeout(b,e)),a}return Z.cancel=H,Z.flush=k,Z}function IR(t,e){return t==null||t!==t?e:t}var af=Object.prototype,PR=af.hasOwnProperty,DR=G(function(t,e){t=Object(t);var r=-1,n=e.length,i=n>2?e[2]:void 0;for(i&&He(e[0],e[1],i)&&(n=1);++r<n;)for(var s=e[r],a=et(s),o=-1,c=a.length;++o<c;){var u=a[o],h=t[u];(h===void 0||Dt(h,af[u])&&!PR.call(t,u))&&(t[u]=s[u])}return t});const OR=DR;function ko(t,e,r){(r!==void 0&&!Dt(t[e],r)||r===void 0&&!(e in t))&&_r(t,e,r)}function Re(t){return Te(t)&&Ze(t)}function Co(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function of(t){return Wt(t,et(t))}function MR(t,e,r,n,i,s,a){var o=Co(t,r),c=Co(e,r),u=a.get(c);if(u){ko(t,r,u);return}var h=s?s(o,c,r+"",t,e,a):void 0,f=h===void 0;if(f){var m=F(c),T=!m&&Lr(c),A=!m&&!T&&zn(c);h=c,m||T||A?F(o)?h=o:Re(o)?h=Xe(o):T?(f=!1,h=Yl(c,!0)):A?(f=!1,h=Ql(c,!0)):h=[]:Wi(c)||fn(c)?(h=o,fn(o)?h=of(o):(!me(o)||mr(o))&&(h=Zl(c))):f=!1}f&&(a.set(c,h),i(h,c,n,s,a),a.delete(c)),ko(t,r,h)}function _a(t,e,r,n,i){t!==e&&Dc(e,function(s,a){if(i||(i=new Ct),me(s))MR(t,e,a,r,_a,n,i);else{var o=n?n(Co(t,a),s,a+"",t,e,i):void 0;o===void 0&&(o=s),ko(t,a,o)}},et)}function cf(t,e,r,n,i,s){return me(t)&&me(e)&&(s.set(e,t),_a(t,e,void 0,cf,s),s.delete(e)),t}var NR=ei(function(t,e,r,n){_a(t,e,r,n)});const df=NR;var xR=G(function(t){return t.push(void 0,cf),dt(df,void 0,t)});const LR=xR;var $R="Expected a function";function uf(t,e,r){if(typeof t!="function")throw new TypeError($R);return setTimeout(function(){t.apply(void 0,r)},e)}var UR=G(function(t,e){return uf(t,1,e)});const FR=UR;var VR=G(function(t,e,r){return uf(t,vt(e)||0,r)});const BR=VR;function Nc(t,e,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}var GR=200;function Ki(t,e,r,n){var i=-1,s=ha,a=!0,o=t.length,c=[],u=e.length;if(!o)return c;r&&(e=pe(e,at(r))),n?(s=Nc,a=!1):e.length>=GR&&(s=yi,a=!1,e=new pn(e));e:for(;++i<o;){var h=t[i],f=r==null?h:r(h);if(h=n||h!==0?h:0,a&&f===f){for(var m=u;m--;)if(e[m]===f)continue e;c.push(h)}else s(e,f,n)||c.push(h)}return c}var qR=G(function(t,e){return Re(t)?Ki(t,Ne(e,1,Re,!0)):[]});const HR=qR;function ut(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var WR=G(function(t,e){var r=ut(e);return Re(r)&&(r=void 0),Re(t)?Ki(t,Ne(e,1,Re,!0),U(r)):[]});const jR=WR;var KR=G(function(t,e){var r=ut(e);return Re(r)&&(r=void 0),Re(t)?Ki(t,Ne(e,1,Re,!0),void 0,r):[]});const JR=KR;var YR=da(function(t,e){return t/e},1);const zR=YR;function XR(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===void 0?1:V(e),yt(t,e<0?0:e,n)):[]}function QR(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===void 0?1:V(e),e=n-e,yt(t,0,e<0?0:e)):[]}function va(t,e,r,n){for(var i=t.length,s=n?i:-1;(n?s--:++s<i)&&e(t[s],s,t););return r?yt(t,n?0:s,n?s+1:i):yt(t,n?s+1:0,n?i:s)}function ZR(t,e){return t&&t.length?va(t,U(e),!0,!0):[]}function eS(t,e){return t&&t.length?va(t,U(e),!0):[]}function Jt(t){return typeof t=="function"?t:je}function Ou(t,e){var r=F(t)?At:Hr;return r(t,Jt(e))}function tS(t,e){for(var r=t==null?0:t.length;r--&&e(t[r],r,t)!==!1;);return t}var rS=nf(!0);const lf=rS;function xc(t,e){return t&&lf(t,e,Ie)}var nS=sf(xc,!0);const hf=nS;function Mu(t,e){var r=F(t)?tS:hf;return r(t,Jt(e))}function iS(t,e,r){t=X(t),e=ct(e);var n=t.length;r=r===void 0?n:Tn(V(r),0,n);var i=r;return r-=e.length,r>=0&&t.slice(r,i)==e}function sS(t,e){return pe(e,function(r){return[r,t[r]]})}function aS(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=[n,n]}),r}var oS="[object Map]",cS="[object Set]";function ff(t){return function(e){var r=qt(e);return r==oS?bc(e):r==cS?aS(e):sS(e,t(e))}}var dS=ff(Ie);const Nu=dS;var uS=ff(et);const xu=uS;var lS={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hS=Ac(lS);const fS=hS;var pf=/[&<>"']/g,pS=RegExp(pf.source);function mf(t){return t=X(t),t&&pS.test(t)?t.replace(pf,fS):t}var gf=/[\\^$.*+?()[\]{}|]/g,mS=RegExp(gf.source);function gS(t){return t=X(t),t&&mS.test(t)?t.replace(gf,"\\$&"):t}function _f(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function _S(t,e){var r=!0;return Hr(t,function(n,i,s){return r=!!e(n,i,s),r}),r}function vS(t,e,r){var n=F(t)?_f:_S;return r&&He(t,e,r)&&(e=void 0),n(t,U(e))}var TS=4294967295;function vf(t){return t?Tn(V(t),0,TS):0}function ES(t,e,r,n){var i=t.length;for(r=V(r),r<0&&(r=-r>i?0:i+r),n=n===void 0||n>i?i:V(n),n<0&&(n+=i),n=r>n?0:vf(n);r<n;)t[r++]=e;return t}function wS(t,e,r,n){var i=t==null?0:t.length;return i?(r&&typeof r!="number"&&He(t,e,r)&&(r=0,n=i),ES(t,e,r,n)):[]}function Tf(t,e){var r=[];return Hr(t,function(n,i,s){e(n,i,s)&&r.push(n)}),r}function yS(t,e){var r=F(t)?Vr:Tf;return r(t,U(e))}function Ef(t){return function(e,r,n){var i=Object(e);if(!Ze(e)){var s=U(r);e=Ie(e),r=function(o){return s(i[o],o,i)}}var a=t(e,r,n);return a>-1?i[s?e[a]:a]:void 0}}var AS=Math.max;function wf(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:V(r);return i<0&&(i=AS(n+i,0)),la(t,U(e),i)}var RS=Ef(wf);const SS=RS;function yf(t,e,r){var n;return r(t,function(i,s,a){if(e(i,s,a))return n=s,!1}),n}function bS(t,e){return yf(t,U(e),Kt)}var kS=Math.max,CS=Math.min;function Af(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=n-1;return r!==void 0&&(i=V(r),i=r<0?kS(n+i,0):CS(i,n-1)),la(t,U(e),i,!0)}var IS=Ef(Af);const PS=IS;function DS(t,e){return yf(t,U(e),xc)}function Lu(t){return t&&t.length?t[0]:void 0}function Rf(t,e){var r=-1,n=Ze(t)?Array(t.length):[];return Hr(t,function(i,s,a){n[++r]=e(i,s,a)}),n}function Ta(t,e){var r=F(t)?pe:Rf;return r(t,U(e))}function OS(t,e){return Ne(Ta(t,e),1)}var MS=1/0;function NS(t,e){return Ne(Ta(t,e),MS)}function xS(t,e,r){return r=r===void 0?1:V(r),Ne(Ta(t,e),r)}var LS=1/0;function $S(t){var e=t==null?0:t.length;return e?Ne(t,LS):[]}function US(t,e){var r=t==null?0:t.length;return r?(e=e===void 0?1:V(e),Ne(t,e)):[]}var FS=512;function VS(t){return Tr(t,FS)}var BS=Rc("floor");const GS=BS;var qS="Expected a function",HS=8,WS=32,jS=128,KS=256;function Sf(t){return Er(function(e){var r=e.length,n=r,i=wt.prototype.thru;for(t&&e.reverse();n--;){var s=e[n];if(typeof s!="function")throw new TypeError(qS);if(i&&!a&&us(s)=="wrapper")var a=new wt([],!0)}for(n=a?n:r;++n<r;){s=e[n];var o=us(s),c=o=="wrapper"?pc(s):void 0;c&&Ro(c[0])&&c[1]==(jS|HS|WS|KS)&&!c[4].length&&c[9]==1?a=a[us(c[0])].apply(a,c[3]):a=s.length==1&&Ro(s)?a[o]():a.thru(s)}return function(){var u=arguments,h=u[0];if(a&&u.length==1&&F(h))return a.plant(h).value();for(var f=0,m=r?e[f].apply(this,u):h;++f<r;)m=e[f].call(this,m);return m}})}var JS=Sf();const YS=JS;var zS=Sf(!0);const XS=zS;function QS(t,e){return t==null?t:Dc(t,Jt(e),et)}function ZS(t,e){return t==null?t:lf(t,Jt(e),et)}function eb(t,e){return t&&Kt(t,Jt(e))}function tb(t,e){return t&&xc(t,Jt(e))}function rb(t){for(var e=-1,r=t==null?0:t.length,n={};++e<r;){var i=t[e];n[i[0]]=i[1]}return n}function Ea(t,e){return Vr(e,function(r){return mr(t[r])})}function nb(t){return t==null?[]:Ea(t,Ie(t))}function ib(t){return t==null?[]:Ea(t,et(t))}var sb=Object.prototype,ab=sb.hasOwnProperty,ob=ma(function(t,e,r){ab.call(t,r)?t[r].push(e):_r(t,r,[e])});const cb=ob;function Lc(t,e){return t>e}function wa(t){return function(e,r){return typeof e=="string"&&typeof r=="string"||(e=vt(e),r=vt(r)),t(e,r)}}var db=wa(Lc);const ub=db;var lb=wa(function(t,e){return t>=e});const hb=lb;var fb=Math.max,pb=Math.min;function mb(t,e,r){return t>=pb(e,r)&&t<fb(e,r)}function gb(t,e,r){return e=hr(e),r===void 0?(r=e,e=0):r=hr(r),t=vt(t),mb(t,e,r)}var _b="[object String]";function ya(t){return typeof t=="string"||!F(t)&&Te(t)&&We(t)==_b}function $c(t,e){return pe(e,function(r){return t[r]})}function ni(t){return t==null?[]:$c(t,Ie(t))}var vb=Math.max;function Tb(t,e,r,n){t=Ze(t)?t:ni(t),r=r&&!n?V(r):0;var i=t.length;return r<0&&(r=vb(i+r,0)),ya(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&Qn(t,e,r)>-1}var Eb=Math.max;function wb(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=r==null?0:V(r);return i<0&&(i=Eb(n+i,0)),Qn(t,e,i)}function yb(t){var e=t==null?0:t.length;return e?yt(t,0,-1):[]}var Ab=Math.min;function Uc(t,e,r){for(var n=r?Nc:ha,i=t[0].length,s=t.length,a=s,o=Array(s),c=1/0,u=[];a--;){var h=t[a];a&&e&&(h=pe(h,at(e))),c=Ab(h.length,c),o[a]=!r&&(e||i>=120&&h.length>=120)?new pn(a&&h):void 0}h=t[0];var f=-1,m=o[0];e:for(;++f<i&&u.length<c;){var T=h[f],A=e?e(T):T;if(T=r||T!==0?T:0,!(m?yi(m,A):n(u,A,r))){for(a=s;--a;){var C=o[a];if(!(C?yi(C,A):n(t[a],A,r)))continue e}m&&m.push(A),u.push(T)}}return u}function Fc(t){return Re(t)?t:[]}var Rb=G(function(t){var e=pe(t,Fc);return e.length&&e[0]===t[0]?Uc(e):[]});const Sb=Rb;var bb=G(function(t){var e=ut(t),r=pe(t,Fc);return e===ut(r)?e=void 0:r.pop(),r.length&&r[0]===t[0]?Uc(r,U(e)):[]});const kb=bb;var Cb=G(function(t){var e=ut(t),r=pe(t,Fc);return e=typeof e=="function"?e:void 0,e&&r.pop(),r.length&&r[0]===t[0]?Uc(r,void 0,e):[]});const Ib=Cb;function Pb(t,e,r,n){return Kt(t,function(i,s,a){e(n,r(i),s,a)}),n}function bf(t,e){return function(r,n){return Pb(r,t,e(n),{})}}var Db=Object.prototype,Ob=Db.toString,Mb=bf(function(t,e,r){e!=null&&typeof e.toString!="function"&&(e=Ob.call(e)),t[e]=r},mc(je));const Nb=Mb;var kf=Object.prototype,xb=kf.hasOwnProperty,Lb=kf.toString,$b=bf(function(t,e,r){e!=null&&typeof e.toString!="function"&&(e=Lb.call(e)),xb.call(t,e)?t[e].push(r):t[e]=[r]},U);const Ub=$b;function Cf(t,e){return e.length<2?t:vn(t,yt(e,0,-1))}function Ji(t,e,r){e=Gr(e,t),t=Cf(t,e);var n=t==null?t:t[jt(ut(e))];return n==null?void 0:dt(n,t,r)}var Fb=G(Ji);const Vb=Fb;var Bb=G(function(t,e,r){var n=-1,i=typeof e=="function",s=Ze(t)?Array(t.length):[];return Hr(t,function(a){s[++n]=i?dt(e,a,r):Ji(a,e,r)}),s});const Gb=Bb;var qb="[object ArrayBuffer]";function Hb(t){return Te(t)&&We(t)==qb}var $u=Et&&Et.isArrayBuffer,Wb=$u?at($u):Hb;const jb=Wb;var Kb="[object Boolean]";function Jb(t){return t===!0||t===!1||Te(t)&&We(t)==Kb}var Yb="[object Date]";function zb(t){return Te(t)&&We(t)==Yb}var Uu=Et&&Et.isDate,Xb=Uu?at(Uu):zb;const Qb=Xb;function Zb(t){return Te(t)&&t.nodeType===1&&!Wi(t)}var ek="[object Map]",tk="[object Set]",rk=Object.prototype,nk=rk.hasOwnProperty;function Vc(t){if(t==null)return!0;if(Ze(t)&&(F(t)||typeof t=="string"||typeof t.splice=="function"||Lr(t)||zn(t)||fn(t)))return!t.length;var e=qt(t);if(e==ek||e==tk)return!t.size;if(qi(t))return!sc(t).length;for(var r in t)if(nk.call(t,r))return!1;return!0}function If(t,e){return ji(t,e)}function ik(t,e,r){r=typeof r=="function"?r:void 0;var n=r?r(t,e):void 0;return n===void 0?ji(t,e,void 0,r):!!n}var sk=De.isFinite;function ak(t){return typeof t=="number"&&sk(t)}function Pf(t){return typeof t=="number"&&t==V(t)}function ok(t,e){return t===e||kc(t,e,Cc(e))}function ck(t,e,r){return r=typeof r=="function"?r:void 0,kc(t,e,Cc(e),r)}var dk="[object Number]";function Df(t){return typeof t=="number"||Te(t)&&We(t)==dk}function uk(t){return Df(t)&&t!=+t}var lk=ds?mr:ic;const hk=lk;var fk="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function pk(t){if(hk(t))throw new Error(fk);return Bl(t)}function mk(t){return t==null}function gk(t){return t===null}var _k="[object RegExp]";function vk(t){return Te(t)&&We(t)==_k}var Fu=Et&&Et.isRegExp,Tk=Fu?at(Fu):vk;const Bc=Tk;var Vu=9007199254740991;function Ek(t){return Pf(t)&&t>=-Vu&&t<=Vu}function wk(t){return t===void 0}var yk="[object WeakMap]";function Ak(t){return Te(t)&&qt(t)==yk}var Rk="[object WeakSet]";function Sk(t){return Te(t)&&We(t)==Rk}var bk=1;function kk(t){return U(typeof t=="function"?t:_t(t,bk))}var Ck=Array.prototype,Ik=Ck.join;function Pk(t,e){return t==null?"":Ik.call(t,e)}var Dk=ri(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()});const Ok=Dk;var Mk=ma(function(t,e,r){_r(t,r,e)});const Nk=Mk;function xk(t,e,r){for(var n=r+1;n--;)if(t[n]===e)return n;return n}var Lk=Math.max,$k=Math.min;function Uk(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var i=n;return r!==void 0&&(i=V(r),i=i<0?Lk(n+i,0):$k(i,n-1)),e===e?xk(t,e,i):la(t,gh,i,!0)}var Fk=ri(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()});const Vk=Fk;var Bk=Oh("toLowerCase");const Gk=Bk;function Gc(t,e){return t<e}var qk=wa(Gc);const Hk=qk;var Wk=wa(function(t,e){return t<=e});const jk=Wk;function Kk(t,e){var r={};return e=U(e),Kt(t,function(n,i,s){_r(r,e(n,i,s),n)}),r}function Jk(t,e){var r={};return e=U(e),Kt(t,function(n,i,s){_r(r,i,e(n,i,s))}),r}var Yk=1;function zk(t){return Zh(_t(t,Yk))}var Xk=1;function Qk(t,e){return ef(t,_t(e,Xk))}function Aa(t,e,r){for(var n=-1,i=t.length;++n<i;){var s=t[n],a=e(s);if(a!=null&&(o===void 0?a===a&&!ot(a):r(a,o)))var o=a,c=s}return c}function Zk(t){return t&&t.length?Aa(t,je,Lc):void 0}function eC(t,e){return t&&t.length?Aa(t,U(e),Lc):void 0}function qc(t,e){for(var r,n=-1,i=t.length;++n<i;){var s=e(t[n]);s!==void 0&&(r=r===void 0?s:r+s)}return r}var tC=0/0;function Of(t,e){var r=t==null?0:t.length;return r?qc(t,e)/r:tC}function rC(t){return Of(t,je)}function nC(t,e){return Of(t,U(e))}var iC=ei(function(t,e,r){_a(t,e,r)});const Mf=iC;var sC=G(function(t,e){return function(r){return Ji(r,t,e)}});const aC=sC;var oC=G(function(t,e){return function(r){return Ji(t,r,e)}});const cC=oC;function dC(t){return t&&t.length?Aa(t,je,Gc):void 0}function uC(t,e){return t&&t.length?Aa(t,U(e),Gc):void 0}function Nf(t,e,r){var n=Ie(e),i=Ea(e,n),s=!(me(r)&&"chain"in r)||!!r.chain,a=mr(t);return At(i,function(o){var c=e[o];t[o]=c,a&&(t.prototype[o]=function(){var u=this.__chain__;if(s||u){var h=t(this.__wrapped__),f=h.__actions__=Xe(this.__actions__);return f.push({func:c,args:arguments,thisArg:t}),h.__chain__=u,h}return c.apply(t,Br([this.value()],arguments))})}),t}var lC=da(function(t,e){return t*e},1);const hC=lC;var fC="Expected a function";function Yi(t){if(typeof t!="function")throw new TypeError(fC);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function pC(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}var mC="[object Map]",gC="[object Set]",so=Fe?Fe.iterator:void 0;function xf(t){if(!t)return[];if(Ze(t))return ya(t)?It(t):Xe(t);if(so&&t[so])return pC(t[so]());var e=qt(t),r=e==mC?bc:e==gC?pa:ni;return r(t)}function _C(){this.__values__===void 0&&(this.__values__=xf(this.value()));var t=this.__index__>=this.__values__.length,e=t?void 0:this.__values__[this.__index__++];return{done:t,value:e}}function Lf(t,e){var r=t.length;if(r)return e+=e<0?r:0,vr(e,r)?t[e]:void 0}function vC(t,e){return t&&t.length?Lf(t,V(e)):void 0}function TC(t){return t=V(t),G(function(e){return Lf(e,t)})}function Hc(t,e){return e=Gr(e,t),t=Cf(t,e),t==null||delete t[jt(ut(e))]}function EC(t){return Wi(t)?void 0:t}var wC=1,yC=2,AC=4,RC=Er(function(t,e){var r={};if(t==null)return r;var n=!1;e=pe(e,function(s){return s=Gr(s,t),n||(n=s.length>1),s}),Wt(t,cc(t),r),n&&(r=_t(r,wC|yC|AC,EC));for(var i=e.length;i--;)Hc(r,e[i]);return r});const SC=RC;function $f(t,e,r){for(var n=-1,i=e.length,s={};++n<i;){var a=e[n],o=vn(t,a);r(o,a)&&Hi(s,Gr(a,t),o)}return s}function Uf(t,e){if(t==null)return{};var r=pe(cc(t),function(n){return[n]});return e=U(e),$f(t,r,function(n,i){return e(n,i[0])})}function bC(t,e){return Uf(t,Yi(U(e)))}function kC(t){return Rh(2,t)}function CC(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}function Ff(t,e){if(t!==e){var r=t!==void 0,n=t===null,i=t===t,s=ot(t),a=e!==void 0,o=e===null,c=e===e,u=ot(e);if(!o&&!u&&!s&&t>e||s&&a&&c&&!o&&!u||n&&a&&c||!r&&c||!i)return 1;if(!n&&!s&&!u&&t<e||u&&r&&i&&!n&&!s||o&&r&&i||!a&&i||!c)return-1}return 0}function IC(t,e,r){for(var n=-1,i=t.criteria,s=e.criteria,a=i.length,o=r.length;++n<a;){var c=Ff(i[n],s[n]);if(c){if(n>=o)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return t.index-e.index}function Vf(t,e,r){e.length?e=pe(e,function(s){return F(s)?function(a){return vn(a,s.length===1?s[0]:s)}:s}):e=[je];var n=-1;e=pe(e,at(U));var i=Rf(t,function(s,a,o){var c=pe(e,function(u){return u(s)});return{criteria:c,index:++n,value:s}});return CC(i,function(s,a){return IC(s,a,r)})}function PC(t,e,r,n){return t==null?[]:(F(e)||(e=e==null?[]:[e]),r=n?void 0:r,F(r)||(r=r==null?[]:[r]),Vf(t,e,r))}function Wc(t){return Er(function(e){return e=pe(e,at(U)),G(function(r){var n=this;return t(e,function(i){return dt(i,n,r)})})})}var DC=Wc(pe);const OC=DC;var MC=G;const NC=MC;var xC=Math.min,LC=NC(function(t,e){e=e.length==1&&F(e[0])?pe(e[0],at(U)):pe(Ne(e,1),at(U));var r=e.length;return G(function(n){for(var i=-1,s=xC(n.length,r);++i<s;)n[i]=e[i].call(this,n[i]);return dt(t,this,n)})});const $C=LC;var UC=Wc(_f);const FC=UC;var VC=Wc(Sc);const BC=VC;var GC=9007199254740991,qC=Math.floor;function Io(t,e){var r="";if(!t||e<1||e>GC)return r;do e%2&&(r+=t),e=qC(e/2),e&&(t+=t);while(e);return r}var HC=Pc("length");const WC=HC;var Bf="\\ud800-\\udfff",jC="\\u0300-\\u036f",KC="\\ufe20-\\ufe2f",JC="\\u20d0-\\u20ff",YC=jC+KC+JC,zC="\\ufe0e\\ufe0f",XC="["+Bf+"]",Po="["+YC+"]",Do="\\ud83c[\\udffb-\\udfff]",QC="(?:"+Po+"|"+Do+")",Gf="[^"+Bf+"]",qf="(?:\\ud83c[\\udde6-\\uddff]){2}",Hf="[\\ud800-\\udbff][\\udc00-\\udfff]",ZC="\\u200d",Wf=QC+"?",jf="["+zC+"]?",e0="(?:"+ZC+"(?:"+[Gf,qf,Hf].join("|")+")"+jf+Wf+")*",t0=jf+Wf+e0,r0="(?:"+[Gf+Po+"?",Po,qf,Hf,XC].join("|")+")",Bu=RegExp(Do+"(?="+Do+")|"+r0+t0,"g");function n0(t){for(var e=Bu.lastIndex=0;Bu.test(t);)++e;return e}function ii(t){return ti(t)?n0(t):WC(t)}var i0=Math.ceil;function bs(t,e){e=e===void 0?" ":ct(e);var r=e.length;if(r<2)return r?Io(e,t):e;var n=Io(e,i0(t/ii(e)));return ti(e)?qr(It(n),0,t).join(""):n.slice(0,t)}var s0=Math.ceil,a0=Math.floor;function o0(t,e,r){t=X(t),e=V(e);var n=e?ii(t):0;if(!e||n>=e)return t;var i=(e-n)/2;return bs(a0(i),r)+t+bs(s0(i),r)}function c0(t,e,r){t=X(t),e=V(e);var n=e?ii(t):0;return e&&n<e?t+bs(e-n,r):t}function d0(t,e,r){t=X(t),e=V(e);var n=e?ii(t):0;return e&&n<e?bs(e-n,r)+t:t}var u0=/^\s+/,l0=De.parseInt;function h0(t,e,r){return r||e==null?e=0:e&&(e=+e),l0(X(t).replace(u0,""),e||0)}var f0=32,jc=G(function(t,e){var r=$r(e,Zn(jc));return Tr(t,f0,void 0,e,r)});jc.placeholder={};const Kf=jc;var p0=64,Kc=G(function(t,e){var r=$r(e,Zn(Kc));return Tr(t,p0,void 0,e,r)});Kc.placeholder={};const m0=Kc;var g0=ma(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]});const _0=g0;function v0(t,e){return $f(t,e,function(r,n){return Ic(t,n)})}var T0=Er(function(t,e){return t==null?{}:v0(t,e)});const E0=T0;function w0(t){for(var e,r=this;r instanceof ua;){var n=fh(r);n.__index__=0,n.__values__=void 0,e?i.__wrapped__=n:e=n;var i=n;r=r.__wrapped__}return i.__wrapped__=t,e}function y0(t){return function(e){return t==null?void 0:vn(t,e)}}function A0(t,e,r,n){for(var i=r-1,s=t.length;++i<s;)if(n(t[i],e))return i;return-1}var R0=Array.prototype,Gu=R0.splice;function Jc(t,e,r,n){var i=n?A0:Qn,s=-1,a=e.length,o=t;for(t===e&&(e=Xe(e)),r&&(o=pe(t,at(r)));++s<a;)for(var c=0,u=e[s],h=r?r(u):u;(c=i(o,h,c,n))>-1;)o!==t&&Gu.call(o,c,1),Gu.call(t,c,1);return t}function Jf(t,e){return t&&t.length&&e&&e.length?Jc(t,e):t}var S0=G(Jf);const b0=S0;function k0(t,e,r){return t&&t.length&&e&&e.length?Jc(t,e,U(r)):t}function C0(t,e,r){return t&&t.length&&e&&e.length?Jc(t,e,void 0,r):t}var I0=Array.prototype,P0=I0.splice;function Yf(t,e){for(var r=t?e.length:0,n=r-1;r--;){var i=e[r];if(r==n||i!==s){var s=i;vr(i)?P0.call(t,i,1):Hc(t,i)}}return t}var D0=Er(function(t,e){var r=t==null?0:t.length,n=_c(t,e);return Yf(t,pe(e,function(i){return vr(i,r)?+i:i}).sort(Ff)),n});const O0=D0;var M0=Math.floor,N0=Math.random;function Yc(t,e){return t+M0(N0()*(e-t+1))}var x0=parseFloat,L0=Math.min,$0=Math.random;function U0(t,e,r){if(r&&typeof r!="boolean"&&He(t,e,r)&&(e=r=void 0),r===void 0&&(typeof e=="boolean"?(r=e,e=void 0):typeof t=="boolean"&&(r=t,t=void 0)),t===void 0&&e===void 0?(t=0,e=1):(t=hr(t),e===void 0?(e=t,t=0):e=hr(e)),t>e){var n=t;t=e,e=n}if(r||t%1||e%1){var i=$0();return L0(t+i*(e-t+x0("1e-"+((i+"").length-1))),e)}return Yc(t,e)}var F0=Math.ceil,V0=Math.max;function B0(t,e,r,n){for(var i=-1,s=V0(F0((e-t)/(r||1)),0),a=Array(s);s--;)a[n?s:++i]=t,t+=r;return a}function zf(t){return function(e,r,n){return n&&typeof n!="number"&&He(e,r,n)&&(r=n=void 0),e=hr(e),r===void 0?(r=e,e=0):r=hr(r),n=n===void 0?e<r?1:-1:hr(n),B0(e,r,n,t)}}var G0=zf();const q0=G0;var H0=zf(!0);const W0=H0;var j0=256,K0=Er(function(t,e){return Tr(t,j0,void 0,void 0,void 0,e)});const J0=K0;function Xf(t,e,r,n,i){return i(t,function(s,a,o){r=n?(n=!1,s):e(r,s,a,o)}),r}function Y0(t,e,r){var n=F(t)?yc:Xf,i=arguments.length<3;return n(t,U(e),r,i,Hr)}function z0(t,e,r,n){var i=t==null?0:t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function X0(t,e,r){var n=F(t)?z0:Xf,i=arguments.length<3;return n(t,U(e),r,i,hf)}function Q0(t,e){var r=F(t)?Vr:Tf;return r(t,Yi(U(e)))}function Z0(t,e){var r=[];if(!(t&&t.length))return r;var n=-1,i=[],s=t.length;for(e=U(e);++n<s;){var a=t[n];e(a,n,t)&&(r.push(a),i.push(n))}return Yf(t,i),r}function eI(t,e,r){return(r?He(t,e,r):e===void 0)?e=1:e=V(e),Io(X(t),e)}function tI(){var t=arguments,e=X(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var rI="Expected a function";function nI(t,e){if(typeof t!="function")throw new TypeError(rI);return e=e===void 0?e:V(e),G(t,e)}function iI(t,e,r){e=Gr(e,t);var n=-1,i=e.length;for(i||(i=1,t=void 0);++n<i;){var s=t==null?void 0:t[jt(e[n])];s===void 0&&(n=i,s=r),t=mr(s)?s.call(t):s}return t}var sI=Array.prototype,aI=sI.reverse;function Oo(t){return t==null?t:aI.call(t)}var oI=Rc("round");const cI=oI;function Qf(t){var e=t.length;return e?t[Yc(0,e-1)]:void 0}function dI(t){return Qf(ni(t))}function uI(t){var e=F(t)?Qf:dI;return e(t)}function Ra(t,e){var r=-1,n=t.length,i=n-1;for(e=e===void 0?n:e;++r<e;){var s=Yc(r,i),a=t[s];t[s]=t[r],t[r]=a}return t.length=e,t}function lI(t,e){return Ra(Xe(t),Tn(e,0,t.length))}function hI(t,e){var r=ni(t);return Ra(r,Tn(e,0,r.length))}function fI(t,e,r){(r?He(t,e,r):e===void 0)?e=1:e=V(e);var n=F(t)?lI:hI;return n(t,e)}function pI(t,e,r,n){return n=typeof n=="function"?n:void 0,t==null?t:Hi(t,e,r,n)}function mI(t){return Ra(Xe(t))}function gI(t){return Ra(ni(t))}function _I(t){var e=F(t)?mI:gI;return e(t)}var vI="[object Map]",TI="[object Set]";function EI(t){if(t==null)return 0;if(Ze(t))return ya(t)?ii(t):t.length;var e=qt(t);return e==vI||e==TI?t.size:sc(t).length}function wI(t,e,r){var n=t==null?0:t.length;return n?(r&&typeof r!="number"&&He(t,e,r)?(e=0,r=n):(e=e==null?0:V(e),r=r===void 0?n:V(r)),yt(t,e,r)):[]}var yI=ri(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()});const AI=yI;function RI(t,e){var r;return Hr(t,function(n,i,s){return r=e(n,i,s),!r}),!!r}function SI(t,e,r){var n=F(t)?Sc:RI;return r&&He(t,e,r)&&(e=void 0),n(t,U(e))}var bI=G(function(t,e){if(t==null)return[];var r=e.length;return r>1&&He(t,e[0],e[1])?e=[]:r>2&&He(e[0],e[1],e[2])&&(e=[e[0]]),Vf(t,Ne(e,1),[])});const kI=bI;var CI=4294967295,II=CI-1,PI=Math.floor,DI=Math.min;function zc(t,e,r,n){var i=0,s=t==null?0:t.length;if(s===0)return 0;e=r(e);for(var a=e!==e,o=e===null,c=ot(e),u=e===void 0;i<s;){var h=PI((i+s)/2),f=r(t[h]),m=f!==void 0,T=f===null,A=f===f,C=ot(f);if(a)var R=n||A;else u?R=A&&(n||m):o?R=A&&m&&(n||!T):c?R=A&&m&&!T&&(n||!C):T||C?R=!1:R=n?f<=e:f<e;R?i=h+1:s=h}return DI(s,II)}var OI=4294967295,MI=OI>>>1;function Sa(t,e,r){var n=0,i=t==null?n:t.length;if(typeof e=="number"&&e===e&&i<=MI){for(;n<i;){var s=n+i>>>1,a=t[s];a!==null&&!ot(a)&&(r?a<=e:a<e)?n=s+1:i=s}return i}return zc(t,e,je,r)}function NI(t,e){return Sa(t,e)}function xI(t,e,r){return zc(t,e,U(r))}function LI(t,e){var r=t==null?0:t.length;if(r){var n=Sa(t,e);if(n<r&&Dt(t[n],e))return n}return-1}function $I(t,e){return Sa(t,e,!0)}function UI(t,e,r){return zc(t,e,U(r),!0)}function FI(t,e){var r=t==null?0:t.length;if(r){var n=Sa(t,e,!0)-1;if(Dt(t[n],e))return n}return-1}function Zf(t,e){for(var r=-1,n=t.length,i=0,s=[];++r<n;){var a=t[r],o=e?e(a):a;if(!r||!Dt(o,c)){var c=o;s[i++]=a===0?0:a}}return s}function VI(t){return t&&t.length?Zf(t):[]}function BI(t,e){return t&&t.length?Zf(t,U(e)):[]}var GI=4294967295;function qI(t,e,r){return r&&typeof r!="number"&&He(t,e,r)&&(e=r=void 0),r=r===void 0?GI:r>>>0,r?(t=X(t),t&&(typeof e=="string"||e!=null&&!Bc(e))&&(e=ct(e),!e&&ti(t))?qr(It(t),0,r):t.split(e,r)):[]}var HI="Expected a function",WI=Math.max;function jI(t,e){if(typeof t!="function")throw new TypeError(HI);return e=e==null?0:WI(V(e),0),G(function(r){var n=r[e],i=qr(r,0,e);return n&&Br(i,n),dt(t,this,i)})}var KI=ri(function(t,e,r){return t+(r?" ":"")+wc(e)});const JI=KI;function YI(t,e,r){return t=X(t),r=r==null?0:Tn(V(r),0,t.length),e=ct(e),t.slice(r,r+e.length)==e}function zI(){return{}}function XI(){return""}function QI(){return!0}var ZI=da(function(t,e){return t-e},0);const eP=ZI;function tP(t){return t&&t.length?qc(t,je):0}function rP(t,e){return t&&t.length?qc(t,U(e)):0}function nP(t){var e=t==null?0:t.length;return e?yt(t,1,e):[]}function iP(t,e,r){return t&&t.length?(e=r||e===void 0?1:V(e),yt(t,0,e<0?0:e)):[]}function sP(t,e,r){var n=t==null?0:t.length;return n?(e=r||e===void 0?1:V(e),e=n-e,yt(t,e<0?0:e,n)):[]}function aP(t,e){return t&&t.length?va(t,U(e),!1,!0):[]}function oP(t,e){return t&&t.length?va(t,U(e)):[]}function cP(t,e){return e(t),t}var ep=Object.prototype,dP=ep.hasOwnProperty;function qu(t,e,r,n){return t===void 0||Dt(t,ep[r])&&!dP.call(n,r)?e:t}var uP={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function lP(t){return"\\"+uP[t]}var hP=/<%=([\s\S]+?)%>/g;const tp=hP;var fP=/<%-([\s\S]+?)%>/g;const pP=fP;var mP=/<%([\s\S]+?)%>/g;const gP=mP;var _P={escape:pP,evaluate:gP,interpolate:tp,variable:"",imports:{_:{escape:mf}}};const Mo=_P;var vP="Invalid `variable` option passed into `_.template`",TP=/\b__p \+= '';/g,EP=/\b(__p \+=) '' \+/g,wP=/(__e\(.*?\)|\b__t\)) \+\n'';/g,yP=/[()=,{}\[\]\/\s]/,AP=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,es=/($^)/,RP=/['\n\r\u2028\u2029\\]/g,SP=Object.prototype,Hu=SP.hasOwnProperty;function bP(t,e,r){var n=Mo.imports._.templateSettings||Mo;r&&He(t,e,r)&&(e=void 0),t=X(t),e=Ss({},e,n,qu);var i=Ss({},e.imports,n.imports,qu),s=Ie(i),a=$c(i,s),o,c,u=0,h=e.interpolate||es,f="__p += '",m=RegExp((e.escape||es).source+"|"+h.source+"|"+(h===tp?AP:es).source+"|"+(e.evaluate||es).source+"|$","g"),T=Hu.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+`
`:"";t.replace(m,function(R,b,D,H,k,Z){return D||(D=H),f+=t.slice(u,Z).replace(RP,lP),b&&(o=!0,f+=`' +
__e(`+b+`) +
'`),k&&(c=!0,f+=`';
`+k+`;
__p += '`),D&&(f+=`' +
((__t = (`+D+`)) == null ? '' : __t) +
'`),u=Z+R.length,R}),f+=`';
`;var A=Hu.call(e,"variable")&&e.variable;if(!A)f=`with (obj) {
`+f+`
}
`;else if(yP.test(A))throw new Error(vP);f=(c?f.replace(TP,""):f).replace(EP,"$1").replace(wP,"$1;"),f="function("+(A||"obj")+`) {
`+(A?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(o?", __e = _.escape":"")+(c?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+f+`return __p
}`;var C=Ah(function(){return Function(s,T+"return "+f).apply(void 0,a)});if(C.source=f,vc(C))throw C;return C}var kP="Expected a function";function CP(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(kP);return me(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),ga(t,e,{leading:n,maxWait:e,trailing:i})}function zi(t,e){return e(t)}var IP=9007199254740991,ao=4294967295,PP=Math.min;function DP(t,e){if(t=V(t),t<1||t>IP)return[];var r=ao,n=PP(t,ao);e=Jt(e),t-=ao;for(var i=nc(n,e);++r<t;)e(r);return i}function OP(){return this}function rp(t,e){var r=t;return r instanceof q&&(r=r.value()),yc(e,function(n,i){return i.func.apply(i.thisArg,Br([n],i.args))},r)}function oo(){return rp(this.__wrapped__,this.__actions__)}function MP(t){return X(t).toLowerCase()}function NP(t){return F(t)?pe(t,jt):ot(t)?[t]:Xe(sh(X(t)))}var Wu=9007199254740991;function xP(t){return t?Tn(V(t),-Wu,Wu):t===0?t:0}function LP(t){return X(t).toUpperCase()}function $P(t,e,r){var n=F(t),i=n||Lr(t)||zn(t);if(e=U(e),r==null){var s=t&&t.constructor;i?r=n?new s:[]:me(t)?r=mr(s)?Xn(aa(t)):{}:r={}}return(i?At:Kt)(t,function(a,o,c){return e(r,a,o,c)}),r}function np(t,e){for(var r=t.length;r--&&Qn(e,t[r],0)>-1;);return r}function ip(t,e){for(var r=-1,n=t.length;++r<n&&Qn(e,t[r],0)>-1;);return r}function UP(t,e,r){if(t=X(t),t&&(r||e===void 0))return dh(t);if(!t||!(e=ct(e)))return t;var n=It(t),i=It(e),s=ip(n,i),a=np(n,i)+1;return qr(n,s,a).join("")}function FP(t,e,r){if(t=X(t),t&&(r||e===void 0))return t.slice(0,ch(t)+1);if(!t||!(e=ct(e)))return t;var n=It(t),i=np(n,It(e))+1;return qr(n,0,i).join("")}var VP=/^\s+/;function BP(t,e,r){if(t=X(t),t&&(r||e===void 0))return t.replace(VP,"");if(!t||!(e=ct(e)))return t;var n=It(t),i=ip(n,It(e));return qr(n,i).join("")}var GP=30,qP="...",HP=/\w*$/;function WP(t,e){var r=GP,n=qP;if(me(e)){var i="separator"in e?e.separator:i;r="length"in e?V(e.length):r,n="omission"in e?ct(e.omission):n}t=X(t);var s=t.length;if(ti(t)){var a=It(t);s=a.length}if(r>=s)return t;var o=r-ii(n);if(o<1)return n;var c=a?qr(a,0,o).join(""):t.slice(0,o);if(i===void 0)return c+n;if(a&&(o+=c.length-o),Bc(i)){if(t.slice(o).search(i)){var u,h=c;for(i.global||(i=RegExp(i.source,X(HP.exec(i))+"g")),i.lastIndex=0;u=i.exec(h);)var f=u.index;c=c.slice(0,f===void 0?o:f)}}else if(t.indexOf(ct(i),o)!=o){var m=c.lastIndexOf(i);m>-1&&(c=c.slice(0,m))}return c+n}function jP(t){return Th(t,1)}var KP={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},JP=Ac(KP);const YP=JP;var sp=/&(?:amp|lt|gt|quot|#39);/g,zP=RegExp(sp.source);function XP(t){return t=X(t),t&&zP.test(t)?t.replace(sp,YP):t}var QP=1/0,ZP=On&&1/pa(new On([,-0]))[1]==QP?function(t){return new On(t)}:fc;const e1=ZP;var t1=200;function Ur(t,e,r){var n=-1,i=ha,s=t.length,a=!0,o=[],c=o;if(r)a=!1,i=Nc;else if(s>=t1){var u=e?null:e1(t);if(u)return pa(u);a=!1,i=yi,c=new pn}else c=e?[]:o;e:for(;++n<s;){var h=t[n],f=e?e(h):h;if(h=r||h!==0?h:0,a&&f===f){for(var m=c.length;m--;)if(c[m]===f)continue e;e&&c.push(f),o.push(h)}else i(c,f,r)||(c!==o&&c.push(f),o.push(h))}return o}var r1=G(function(t){return Ur(Ne(t,1,Re,!0))});const n1=r1;var i1=G(function(t){var e=ut(t);return Re(e)&&(e=void 0),Ur(Ne(t,1,Re,!0),U(e))});const s1=i1;var a1=G(function(t){var e=ut(t);return e=typeof e=="function"?e:void 0,Ur(Ne(t,1,Re,!0),void 0,e)});const o1=a1;function c1(t){return t&&t.length?Ur(t):[]}function d1(t,e){return t&&t.length?Ur(t,U(e)):[]}function u1(t,e){return e=typeof e=="function"?e:void 0,t&&t.length?Ur(t,void 0,e):[]}var l1=0;function h1(t){var e=++l1;return X(t)+e}function f1(t,e){return t==null?!0:Hc(t,e)}var p1=Math.max;function Xc(t){if(!(t&&t.length))return[];var e=0;return t=Vr(t,function(r){if(Re(r))return e=p1(r.length,e),!0}),nc(e,function(r){return pe(t,Pc(r))})}function ap(t,e){if(!(t&&t.length))return[];var r=Xc(t);return e==null?r:pe(r,function(n){return dt(e,void 0,n)})}function op(t,e,r,n){return Hi(t,e,r(vn(t,e)),n)}function m1(t,e,r){return t==null?t:op(t,e,Jt(r))}function g1(t,e,r,n){return n=typeof n=="function"?n:void 0,t==null?t:op(t,e,Jt(r),n)}var _1=ri(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()});const v1=_1;function T1(t){return t==null?[]:$c(t,et(t))}var E1=G(function(t,e){return Re(t)?Ki(t,e):[]});const w1=E1;function y1(t,e){return Kf(Jt(e),t)}var A1=Er(function(t){var e=t.length,r=e?t[0]:0,n=this.__wrapped__,i=function(s){return _c(s,t)};return e>1||this.__actions__.length||!(n instanceof q)||!vr(r)?this.thru(i):(n=n.slice(r,+r+(e?1:0)),n.__actions__.push({func:zi,args:[i],thisArg:void 0}),new wt(n,this.__chain__).thru(function(s){return e&&!s.length&&s.push(void 0),s}))});const R1=A1;function S1(){return Yh(this)}function b1(){var t=this.__wrapped__;if(t instanceof q){var e=t;return this.__actions__.length&&(e=new q(this)),e=e.reverse(),e.__actions__.push({func:zi,args:[Oo],thisArg:void 0}),new wt(e,this.__chain__)}return this.thru(Oo)}function Qc(t,e,r){var n=t.length;if(n<2)return n?Ur(t[0]):[];for(var i=-1,s=Array(n);++i<n;)for(var a=t[i],o=-1;++o<n;)o!=i&&(s[i]=Ki(s[i]||a,t[o],e,r));return Ur(Ne(s,1),e,r)}var k1=G(function(t){return Qc(Vr(t,Re))});const C1=k1;var I1=G(function(t){var e=ut(t);return Re(e)&&(e=void 0),Qc(Vr(t,Re),U(e))});const P1=I1;var D1=G(function(t){var e=ut(t);return e=typeof e=="function"?e:void 0,Qc(Vr(t,Re),void 0,e)});const cp=D1;var O1=G(Xc);const M1=O1;function dp(t,e,r){for(var n=-1,i=t.length,s=e.length,a={};++n<i;){var o=n<s?e[n]:void 0;r(a,t[n],o)}return a}function N1(t,e){return dp(t||[],e||[],Gi)}function x1(t,e){return dp(t||[],e||[],Hi)}var L1=G(function(t){var e=t.length,r=e>1?t[e-1]:void 0;return r=typeof r=="function"?(t.pop(),r):void 0,ap(t,r)});const $1=L1,O={chunk:vA,compact:CA,concat:IA,difference:HR,differenceBy:jR,differenceWith:JR,drop:XR,dropRight:QR,dropRightWhile:ZR,dropWhile:eS,fill:wS,findIndex:wf,findLastIndex:Af,first:Lu,flatten:wh,flattenDeep:$S,flattenDepth:US,fromPairs:rb,head:Lu,indexOf:wb,initial:yb,intersection:Sb,intersectionBy:kb,intersectionWith:Ib,join:Pk,last:ut,lastIndexOf:Uk,nth:vC,pull:b0,pullAll:Jf,pullAllBy:k0,pullAllWith:C0,pullAt:O0,remove:Z0,reverse:Oo,slice:wI,sortedIndex:NI,sortedIndexBy:xI,sortedIndexOf:LI,sortedLastIndex:$I,sortedLastIndexBy:UI,sortedLastIndexOf:FI,sortedUniq:VI,sortedUniqBy:BI,tail:nP,take:iP,takeRight:sP,takeRightWhile:aP,takeWhile:oP,union:n1,unionBy:s1,unionWith:o1,uniq:c1,uniqBy:d1,uniqWith:u1,unzip:Xc,unzipWith:ap,without:w1,xor:C1,xorBy:P1,xorWith:cp,zip:M1,zipObject:N1,zipObjectDeep:x1,zipWith:$1},te={countBy:wR,each:Ou,eachRight:Mu,every:vS,filter:yS,find:SS,findLast:PS,flatMap:OS,flatMapDeep:NS,flatMapDepth:xS,forEach:Ou,forEachRight:Mu,groupBy:cb,includes:Tb,invokeMap:Gb,keyBy:Nk,map:Ta,orderBy:PC,partition:_0,reduce:Y0,reduceRight:X0,reject:Q0,sample:uI,sampleSize:fI,shuffle:_I,size:EI,some:SI,sortBy:kI},U1={now:ls},Ee={after:EE,ary:Th,before:Rh,bind:Sh,bindKey:ey,curry:Oc,curryRight:Mc,debounce:ga,defer:FR,delay:BR,flip:VS,memoize:ca,negate:Yi,once:kC,overArgs:$C,partial:Kf,partialRight:m0,rearg:J0,rest:nI,spread:jI,throttle:CP,unary:jP,wrap:y1},N={castArray:lA,clone:wA,cloneDeep:oa,cloneDeepWith:RA,cloneWith:bA,conformsTo:fR,eq:Dt,gt:ub,gte:hb,isArguments:fn,isArray:F,isArrayBuffer:jb,isArrayLike:Ze,isArrayLikeObject:Re,isBoolean:Jb,isBuffer:Lr,isDate:Qb,isElement:Zb,isEmpty:Vc,isEqual:If,isEqualWith:ik,isError:vc,isFinite:ak,isFunction:mr,isInteger:Pf,isLength:sa,isMap:eh,isMatch:ok,isMatchWith:ck,isNaN:uk,isNative:pk,isNil:mk,isNull:gk,isNumber:Df,isObject:me,isObjectLike:Te,isPlainObject:Wi,isRegExp:Bc,isSafeInteger:Ek,isSet:th,isString:ya,isSymbol:ot,isTypedArray:zn,isUndefined:wk,isWeakMap:Ak,isWeakSet:Sk,lt:Hk,lte:jk,toArray:xf,toFinite:hr,toInteger:V,toLength:vf,toNumber:vt,toPlainObject:of,toSafeInteger:xP,toString:X},Ke={add:lE,ceil:mA,divide:zR,floor:GS,max:Zk,maxBy:eC,mean:rC,meanBy:nC,min:dC,minBy:uC,multiply:hC,round:cI,subtract:eP,sum:tP,sumBy:rP},Zc={clamp:TA,inRange:gb,random:U0},L={assign:Pw,assignIn:yu,assignInWith:Ss,assignWith:Nw,at:$w,create:yR,defaults:OR,defaultsDeep:LR,entries:Nu,entriesIn:xu,extend:yu,extendWith:Ss,findKey:bS,findLastKey:DS,forIn:QS,forInRight:ZS,forOwn:eb,forOwnRight:tb,functions:nb,functionsIn:ib,get:lc,has:nE,hasIn:Ic,invert:Nb,invertBy:Ub,invoke:Vb,keys:Ie,keysIn:et,mapKeys:Kk,mapValues:Jk,merge:Mf,mergeWith:df,omit:SC,omitBy:bC,pick:E0,pickBy:Uf,result:iI,set:iE,setWith:pI,toPairs:Nu,toPairsIn:xu,transform:$P,unset:f1,update:m1,updateWith:g1,values:ni,valuesIn:T1},Yt={at:R1,chain:Yh,commit:kA,lodash:l,next:_C,plant:w0,reverse:b1,tap:cP,thru:zi,toIterator:OP,toJSON:oo,value:oo,valueOf:oo,wrapperChain:S1},z={camelCase:uA,capitalize:Mh,deburr:Nh,endsWith:iS,escape:mf,escapeRegExp:gS,kebabCase:Ok,lowerCase:Vk,lowerFirst:Gk,pad:o0,padEnd:c0,padStart:d0,parseInt:h0,repeat:eI,replace:tI,snakeCase:AI,split:qI,startCase:JI,startsWith:YI,template:bP,templateSettings:Mo,toLower:MP,toUpper:LP,trim:UP,trimEnd:FP,trimStart:BP,truncate:WP,unescape:XP,upperCase:v1,upperFirst:wc,words:Jh},Q={attempt:Ah,bindAll:zw,cond:dR,conforms:hR,constant:mc,defaultTo:IR,flow:YS,flowRight:XS,identity:je,iteratee:kk,matches:zk,matchesProperty:Qk,method:aC,methodOf:cC,mixin:Nf,noop:fc,nthArg:TC,over:OC,overEvery:FC,overSome:BC,property:tf,propertyOf:y0,range:q0,rangeRight:W0,stubArray:ac,stubFalse:ic,stubObject:zI,stubString:XI,stubTrue:QI,times:DP,toPath:NP,uniqueId:h1};function F1(){var t=new q(this.__wrapped__);return t.__actions__=Xe(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Xe(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Xe(this.__views__),t}function V1(){if(this.__filtered__){var t=new q(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}var B1=Math.max,G1=Math.min;function q1(t,e,r){for(var n=-1,i=r.length;++n<i;){var s=r[n],a=s.size;switch(s.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=G1(e,t+a);break;case"takeRight":t=B1(t,e-a);break}}return{start:t,end:e}}var H1=1,W1=2,j1=Math.min;function K1(){var t=this.__wrapped__.value(),e=this.__dir__,r=F(t),n=e<0,i=r?t.length:0,s=q1(0,i,this.__views__),a=s.start,o=s.end,c=o-a,u=n?o:a-1,h=this.__iteratees__,f=h.length,m=0,T=j1(c,this.__takeCount__);if(!r||!n&&i==c&&T==c)return rp(t,this.__actions__);var A=[];e:for(;c--&&m<T;){u+=e;for(var C=-1,R=t[u];++C<f;){var b=h[C],D=b.iteratee,H=b.type,k=D(R);if(H==W1)R=k;else if(!k){if(H==H1)continue e;break e}}A[m++]=R}return A}/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var J1="4.17.21",Y1=2,z1=1,X1=3,up=4294967295,Q1=Array.prototype,Z1=Object.prototype,lp=Z1.hasOwnProperty,ju=Fe?Fe.iterator:void 0,eD=Math.max,Ku=Math.min,ed=function(t){return function(e,r,n){if(n==null){var i=me(r),s=i&&Ie(r),a=s&&s.length&&Ea(r,s);(a?a.length:i)||(n=r,r=e,e=this)}return t(e,r,n)}}(Nf);l.after=Ee.after;l.ary=Ee.ary;l.assign=L.assign;l.assignIn=L.assignIn;l.assignInWith=L.assignInWith;l.assignWith=L.assignWith;l.at=L.at;l.before=Ee.before;l.bind=Ee.bind;l.bindAll=Q.bindAll;l.bindKey=Ee.bindKey;l.castArray=N.castArray;l.chain=Yt.chain;l.chunk=O.chunk;l.compact=O.compact;l.concat=O.concat;l.cond=Q.cond;l.conforms=Q.conforms;l.constant=Q.constant;l.countBy=te.countBy;l.create=L.create;l.curry=Ee.curry;l.curryRight=Ee.curryRight;l.debounce=Ee.debounce;l.defaults=L.defaults;l.defaultsDeep=L.defaultsDeep;l.defer=Ee.defer;l.delay=Ee.delay;l.difference=O.difference;l.differenceBy=O.differenceBy;l.differenceWith=O.differenceWith;l.drop=O.drop;l.dropRight=O.dropRight;l.dropRightWhile=O.dropRightWhile;l.dropWhile=O.dropWhile;l.fill=O.fill;l.filter=te.filter;l.flatMap=te.flatMap;l.flatMapDeep=te.flatMapDeep;l.flatMapDepth=te.flatMapDepth;l.flatten=O.flatten;l.flattenDeep=O.flattenDeep;l.flattenDepth=O.flattenDepth;l.flip=Ee.flip;l.flow=Q.flow;l.flowRight=Q.flowRight;l.fromPairs=O.fromPairs;l.functions=L.functions;l.functionsIn=L.functionsIn;l.groupBy=te.groupBy;l.initial=O.initial;l.intersection=O.intersection;l.intersectionBy=O.intersectionBy;l.intersectionWith=O.intersectionWith;l.invert=L.invert;l.invertBy=L.invertBy;l.invokeMap=te.invokeMap;l.iteratee=Q.iteratee;l.keyBy=te.keyBy;l.keys=Ie;l.keysIn=L.keysIn;l.map=te.map;l.mapKeys=L.mapKeys;l.mapValues=L.mapValues;l.matches=Q.matches;l.matchesProperty=Q.matchesProperty;l.memoize=Ee.memoize;l.merge=L.merge;l.mergeWith=L.mergeWith;l.method=Q.method;l.methodOf=Q.methodOf;l.mixin=ed;l.negate=Yi;l.nthArg=Q.nthArg;l.omit=L.omit;l.omitBy=L.omitBy;l.once=Ee.once;l.orderBy=te.orderBy;l.over=Q.over;l.overArgs=Ee.overArgs;l.overEvery=Q.overEvery;l.overSome=Q.overSome;l.partial=Ee.partial;l.partialRight=Ee.partialRight;l.partition=te.partition;l.pick=L.pick;l.pickBy=L.pickBy;l.property=Q.property;l.propertyOf=Q.propertyOf;l.pull=O.pull;l.pullAll=O.pullAll;l.pullAllBy=O.pullAllBy;l.pullAllWith=O.pullAllWith;l.pullAt=O.pullAt;l.range=Q.range;l.rangeRight=Q.rangeRight;l.rearg=Ee.rearg;l.reject=te.reject;l.remove=O.remove;l.rest=Ee.rest;l.reverse=O.reverse;l.sampleSize=te.sampleSize;l.set=L.set;l.setWith=L.setWith;l.shuffle=te.shuffle;l.slice=O.slice;l.sortBy=te.sortBy;l.sortedUniq=O.sortedUniq;l.sortedUniqBy=O.sortedUniqBy;l.split=z.split;l.spread=Ee.spread;l.tail=O.tail;l.take=O.take;l.takeRight=O.takeRight;l.takeRightWhile=O.takeRightWhile;l.takeWhile=O.takeWhile;l.tap=Yt.tap;l.throttle=Ee.throttle;l.thru=zi;l.toArray=N.toArray;l.toPairs=L.toPairs;l.toPairsIn=L.toPairsIn;l.toPath=Q.toPath;l.toPlainObject=N.toPlainObject;l.transform=L.transform;l.unary=Ee.unary;l.union=O.union;l.unionBy=O.unionBy;l.unionWith=O.unionWith;l.uniq=O.uniq;l.uniqBy=O.uniqBy;l.uniqWith=O.uniqWith;l.unset=L.unset;l.unzip=O.unzip;l.unzipWith=O.unzipWith;l.update=L.update;l.updateWith=L.updateWith;l.values=L.values;l.valuesIn=L.valuesIn;l.without=O.without;l.words=z.words;l.wrap=Ee.wrap;l.xor=O.xor;l.xorBy=O.xorBy;l.xorWith=O.xorWith;l.zip=O.zip;l.zipObject=O.zipObject;l.zipObjectDeep=O.zipObjectDeep;l.zipWith=O.zipWith;l.entries=L.toPairs;l.entriesIn=L.toPairsIn;l.extend=L.assignIn;l.extendWith=L.assignInWith;ed(l,l);l.add=Ke.add;l.attempt=Q.attempt;l.camelCase=z.camelCase;l.capitalize=z.capitalize;l.ceil=Ke.ceil;l.clamp=Zc.clamp;l.clone=N.clone;l.cloneDeep=N.cloneDeep;l.cloneDeepWith=N.cloneDeepWith;l.cloneWith=N.cloneWith;l.conformsTo=N.conformsTo;l.deburr=z.deburr;l.defaultTo=Q.defaultTo;l.divide=Ke.divide;l.endsWith=z.endsWith;l.eq=N.eq;l.escape=z.escape;l.escapeRegExp=z.escapeRegExp;l.every=te.every;l.find=te.find;l.findIndex=O.findIndex;l.findKey=L.findKey;l.findLast=te.findLast;l.findLastIndex=O.findLastIndex;l.findLastKey=L.findLastKey;l.floor=Ke.floor;l.forEach=te.forEach;l.forEachRight=te.forEachRight;l.forIn=L.forIn;l.forInRight=L.forInRight;l.forOwn=L.forOwn;l.forOwnRight=L.forOwnRight;l.get=L.get;l.gt=N.gt;l.gte=N.gte;l.has=L.has;l.hasIn=L.hasIn;l.head=O.head;l.identity=je;l.includes=te.includes;l.indexOf=O.indexOf;l.inRange=Zc.inRange;l.invoke=L.invoke;l.isArguments=N.isArguments;l.isArray=F;l.isArrayBuffer=N.isArrayBuffer;l.isArrayLike=N.isArrayLike;l.isArrayLikeObject=N.isArrayLikeObject;l.isBoolean=N.isBoolean;l.isBuffer=N.isBuffer;l.isDate=N.isDate;l.isElement=N.isElement;l.isEmpty=N.isEmpty;l.isEqual=N.isEqual;l.isEqualWith=N.isEqualWith;l.isError=N.isError;l.isFinite=N.isFinite;l.isFunction=N.isFunction;l.isInteger=N.isInteger;l.isLength=N.isLength;l.isMap=N.isMap;l.isMatch=N.isMatch;l.isMatchWith=N.isMatchWith;l.isNaN=N.isNaN;l.isNative=N.isNative;l.isNil=N.isNil;l.isNull=N.isNull;l.isNumber=N.isNumber;l.isObject=me;l.isObjectLike=N.isObjectLike;l.isPlainObject=N.isPlainObject;l.isRegExp=N.isRegExp;l.isSafeInteger=N.isSafeInteger;l.isSet=N.isSet;l.isString=N.isString;l.isSymbol=N.isSymbol;l.isTypedArray=N.isTypedArray;l.isUndefined=N.isUndefined;l.isWeakMap=N.isWeakMap;l.isWeakSet=N.isWeakSet;l.join=O.join;l.kebabCase=z.kebabCase;l.last=ut;l.lastIndexOf=O.lastIndexOf;l.lowerCase=z.lowerCase;l.lowerFirst=z.lowerFirst;l.lt=N.lt;l.lte=N.lte;l.max=Ke.max;l.maxBy=Ke.maxBy;l.mean=Ke.mean;l.meanBy=Ke.meanBy;l.min=Ke.min;l.minBy=Ke.minBy;l.stubArray=Q.stubArray;l.stubFalse=Q.stubFalse;l.stubObject=Q.stubObject;l.stubString=Q.stubString;l.stubTrue=Q.stubTrue;l.multiply=Ke.multiply;l.nth=O.nth;l.noop=Q.noop;l.now=U1.now;l.pad=z.pad;l.padEnd=z.padEnd;l.padStart=z.padStart;l.parseInt=z.parseInt;l.random=Zc.random;l.reduce=te.reduce;l.reduceRight=te.reduceRight;l.repeat=z.repeat;l.replace=z.replace;l.result=L.result;l.round=Ke.round;l.sample=te.sample;l.size=te.size;l.snakeCase=z.snakeCase;l.some=te.some;l.sortedIndex=O.sortedIndex;l.sortedIndexBy=O.sortedIndexBy;l.sortedIndexOf=O.sortedIndexOf;l.sortedLastIndex=O.sortedLastIndex;l.sortedLastIndexBy=O.sortedLastIndexBy;l.sortedLastIndexOf=O.sortedLastIndexOf;l.startCase=z.startCase;l.startsWith=z.startsWith;l.subtract=Ke.subtract;l.sum=Ke.sum;l.sumBy=Ke.sumBy;l.template=z.template;l.times=Q.times;l.toFinite=N.toFinite;l.toInteger=V;l.toLength=N.toLength;l.toLower=z.toLower;l.toNumber=N.toNumber;l.toSafeInteger=N.toSafeInteger;l.toString=N.toString;l.toUpper=z.toUpper;l.trim=z.trim;l.trimEnd=z.trimEnd;l.trimStart=z.trimStart;l.truncate=z.truncate;l.unescape=z.unescape;l.uniqueId=Q.uniqueId;l.upperCase=z.upperCase;l.upperFirst=z.upperFirst;l.each=te.forEach;l.eachRight=te.forEachRight;l.first=O.head;ed(l,function(){var t={};return Kt(l,function(e,r){lp.call(l.prototype,r)||(t[r]=e)}),t}(),{chain:!1});l.VERSION=J1;(l.templateSettings=z.templateSettings).imports._=l;At(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){l[t].placeholder=l});At(["drop","take"],function(t,e){q.prototype[t]=function(r){r=r===void 0?1:eD(V(r),0);var n=this.__filtered__&&!e?new q(this):this.clone();return n.__filtered__?n.__takeCount__=Ku(r,n.__takeCount__):n.__views__.push({size:Ku(r,up),type:t+(n.__dir__<0?"Right":"")}),n},q.prototype[t+"Right"]=function(r){return this.reverse()[t](r).reverse()}});At(["filter","map","takeWhile"],function(t,e){var r=e+1,n=r==z1||r==X1;q.prototype[t]=function(i){var s=this.clone();return s.__iteratees__.push({iteratee:U(i),type:r}),s.__filtered__=s.__filtered__||n,s}});At(["head","last"],function(t,e){var r="take"+(e?"Right":"");q.prototype[t]=function(){return this[r](1).value()[0]}});At(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");q.prototype[t]=function(){return this.__filtered__?new q(this):this[r](1)}});q.prototype.compact=function(){return this.filter(je)};q.prototype.find=function(t){return this.filter(t).head()};q.prototype.findLast=function(t){return this.reverse().find(t)};q.prototype.invokeMap=G(function(t,e){return typeof t=="function"?new q(this):this.map(function(r){return Ji(r,t,e)})});q.prototype.reject=function(t){return this.filter(Yi(U(t)))};q.prototype.slice=function(t,e){t=V(t);var r=this;return r.__filtered__&&(t>0||e<0)?new q(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==void 0&&(e=V(e),r=e<0?r.dropRight(-e):r.take(e-t)),r)};q.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()};q.prototype.toArray=function(){return this.take(up)};Kt(q.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),i=l[n?"take"+(e=="last"?"Right":""):e],s=n||/^find/.test(e);i&&(l.prototype[e]=function(){var a=this.__wrapped__,o=n?[1]:arguments,c=a instanceof q,u=o[0],h=c||F(a),f=function(b){var D=i.apply(l,Br([b],o));return n&&m?D[0]:D};h&&r&&typeof u=="function"&&u.length!=1&&(c=h=!1);var m=this.__chain__,T=!!this.__actions__.length,A=s&&!m,C=c&&!T;if(!s&&h){a=C?a:new q(this);var R=t.apply(a,o);return R.__actions__.push({func:zi,args:[f],thisArg:void 0}),new wt(R,m)}return A&&C?t.apply(this,o):(R=this.thru(f),A?n?R.value()[0]:R.value():R)})});At(["pop","push","shift","sort","splice","unshift"],function(t){var e=Q1[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);l.prototype[t]=function(){var i=arguments;if(n&&!this.__chain__){var s=this.value();return e.apply(F(s)?s:[],i)}return this[r](function(a){return e.apply(F(a)?a:[],i)})}});Kt(q.prototype,function(t,e){var r=l[e];if(r){var n=r.name+"";lp.call(Mn,n)||(Mn[n]=[]),Mn[n].push({name:e,func:r})}});Mn[fa(void 0,Y1).name]=[{name:"wrapper",func:void 0}];q.prototype.clone=F1;q.prototype.reverse=V1;q.prototype.value=K1;l.prototype.at=Yt.at;l.prototype.chain=Yt.wrapperChain;l.prototype.commit=Yt.commit;l.prototype.next=Yt.next;l.prototype.plant=Yt.plant;l.prototype.reverse=Yt.reverse;l.prototype.toJSON=l.prototype.valueOf=l.prototype.value=Yt.value;l.prototype.first=l.prototype.head;ju&&(l.prototype[ju]=Yt.toIterator);const B={roomName:void 0,authToken:void 0,peerId:void 0,apiBase:void 0,baseURI:void 0,defaults:{audio:!0,video:!0},modules:void 0,organizationId:void 0,overrides:{},viewType:void 0,env:void 0,cachedUserDetails:void 0};function tD(t){var e,r,n,i,s,a,o,c;(e=B.roomName)!=null||(B.roomName=t==null?void 0:t.roomName),(r=B.authToken)!=null||(B.authToken=t==null?void 0:t.authToken),(n=B.peerId)!=null||(B.peerId=t==null?void 0:t.peerId),(i=B.apiBase)!=null||(B.apiBase=t==null?void 0:t.apiBase),(s=B.baseURI)!=null||(B.baseURI=t==null?void 0:t.baseURI),(a=B.modules)!=null||(B.modules=t==null?void 0:t.modules),(o=B.organizationId)!=null||(B.organizationId=t==null?void 0:t.organizationId),B.defaults={...B.defaults,...(c=t==null?void 0:t.defaults)!=null?c:{}}}const hp="VERSION_PLACEHOLDER";function rD({servicePrefix:t,apiBase:e,baseURI:r}){return r?`${t}.${r}`:e!=null&&e.includes("api.preprod.dyte")?`${t}.preprod.dyte.io`:e!=null&&e.includes("api.devel.dyte")?`${t}.devel.dyte.io`:`${t}.dyte.io`}const se={INTERNAL_CALL_STATS:"internal_call_stats",SIMULCAST:"simulcast",CHAT_SOCKET_SERVER:"chat_socket_server",POLL_SOCKET_SERVER:"poll_socket_server",PLUGIN_SOCKET_SERVER:"plugin_socket_server",NR_OTEL_WEB:"nr_otel_web",CONNECTED_MEETINGS:"connected_meetings",ICE_RESTART_ON_FAILED_STATE:"ice_restart_on_failed_state",ICE_RESTART_ON_DISCONNECTED_STATE:"ice_restart_on_disconnected_state",ENABLE_ICE_STATE_LOGGING:"enable_ice_state_logging",REMOVE_OPERATIONAL_MIC:"web_core_remove_operational_mic",SUPPRESS_PEER_MUTE_UNMUTE_EMITS:"web_core_suppress_peer_mute_unmute_emits",SKIP_OTEL_TRACES:"skip_otel_traces",NEW_LOCAL_MEDIA_HANDLER:"new_local_media_handler",CALLSTATS_INGESTION_LAYER:"callstats_ingestion_layer",USE_USERIDS_IN_CHAT:"use_userids_in_chat",CUSTOM_PING_PONG:"custom_ping_pong",ENABLE_HIVE_SIMULCAST:"enable_hive_simulcast",ENABLE_HIVE_TRANSPORT_RECONNECTION_ON_ICE_FAILED:"enable_hive_transport_reconnection_on_ice_failed",ENABLE_HIVE_EXPERIMENTAL_FAIL_RECOVERY:"enable_hive_fail_recovery",ENABLE_HIVE_INFINITE_RETRIES:"enable_hive_infinite_retries",BYPASS_LOG_EXCLUSION_LIST:"bypass_log_exclusion_list",LOG_LEVEL:"log_level",V1_PLUGINS:"v1_plugins",SCREENSHARE_DTX:"screenshare_dtx",SCREENSHARE_PRIORITY:"screenshare_priority",SCREENSHARE_MIN_BITRATE:"screenshare_minbitrate",SCREENSHARE_MAX_DIMENSIONS:"screenshare_maxdimensions",SCREENSHARE_SIMULCAST:"screenshare_simulcast",DISABLE_WEBCAM_LAYERS_ON_SCREENSHARE:"disable_webcam_layers_on_screenshare",SCREENSHARE_FORCE_GOOG_CONFERENCE:"screenshare_force_goog_conference",LIVESTREAM:"feat_livestream",FETCH_RETRY:"fetch_retry",DEVICE_REMOVE_EXP:"device_remove_exp",DISABLE_WEBCAM_SIMULCAST:"webcore_disable_webcam_simulcast",OVERRIDE_WEBCAM_SIMULCAST:"override_webcam_simulcast",SOCKET_POLLING:"socket_polling",NS_NETWORK_SCORE:"ns_network_score",FEAT_PAGINATED_CHAT:"feat_paginated_chat",VAL_MIN_FRAMERATE:"val_min_framerate",EXTENSION_HACK:"extension_hack",VAL_MAX_FRAMERATE_EXT:"val_max_framerate_ext",VAL_MIN_FRAMERATE_EXT:"val_min_framerate_ext",SCREEENSHARE_ERR_HACK:"screenshare_err_hack",TROUBLESHOOTING:"feat_troubleshooting",VIDEO_CONSTRAINTS:"video_constraints",SCREENSHARE_CONSTRAINTS:"screenshare_constraints",FEAT_CHAT_SDK:"feat_chat_sdk",FEAT_CHAT_SDK_SEARCH:"chat_search",OBS_QUALITY:"obs_quality",ALLOW_SAFARI_MEDIA_MIDDLEWARES:"allow_safari_media_middlewares",DYNAMIC_VIDEO_QUALITY:"dynamic_video_quality",EXP_RESHARE:"exp_reshare",LEAVE_STAGE_ON_END:"leave_stage_on_end",SKIP_SETTING_IN_USE_DEVICE:"skip_setting_in_use_device",PRECALL_BANDWIDTH_TEST:"precall_bandwidth_test"};function No(t){const e={};return typeof(t==null?void 0:t.code)=="number"&&(e.code=t.code),typeof(t==null?void 0:t.code)=="string"&&(e.code=t.code.substring(0,100)),typeof(t==null?void 0:t.name)=="string"&&(e.name=t.name.substring(0,500)),typeof(t==null?void 0:t.message)=="string"&&(e.message=t.message.substring(0,500)),typeof(t==null?void 0:t.reason)=="string"&&(e.reason=t.reason.substring(0,500)),typeof(t==null?void 0:t.stack)=="string"&&(e.stack=t.stack.substring(0,500)),e}function fp(){var r,n,i,s;const t=typeof navigator!="undefined"&&!navigator.isReactNative&&((r=window.location.host)==null?void 0:r.includes("devel"))&&((n=window.location.host)==null?void 0:n.includes("dyte.io")),e=!!((s=(i=B.modules)==null?void 0:i.devTools)!=null&&s.logs);return t||e}function nD(t){if(ie.hasFeature(se.LOG_LEVEL)){let e=ie.getValue(se.LOG_LEVEL)||"all";if(e=e.toLowerCase().trim(),e==="off")return!1;if(e!=="all"){const r=["debug","log","info","warn","error"],n=r.indexOf(t),i=r.indexOf(e);if(n<i)return!1}}return!0}function pp(t,e,r={}){return Object.getOwnPropertyNames(t).forEach(n=>{var s;if([null,void 0,NaN].includes(t[n])||e&&(((s=e.match(/\./g))==null?void 0:s.length)||0)>=10)return;const i=e?`${e}.${n}`:n;typeof t[n]=="object"?pp(t[n],i,r):["number","string","boolean"].includes(typeof t[n])&&(r[i]=t[n])}),r}function iD(t,e={},r=""){const n={};try{const i=JSON.stringify(e),s=JSON.parse(i),a=pp(s,r),o=JSON.stringify(a);if(o.length>5e3){const c=`Log named: "${t}" is trying to log an flattened object of size ${o.length} chars that is beyond permitted limit of 5000 chars. Please optimize.`;throw fp()&&console.error(c,{log:e,flattened:o}),new Error(c)}return JSON.parse(o)}catch(i){const s=No(i);n[`${r}.error.message`]=s.message||"",n[`${r}.error.stack`]=s.stack||"",n[`${r}.error.reason`]=s.reason||"",n[`${r}.error.source`]="safelyFlattenObjForOpenTelemetry"}return n}const Ai="chrome",mp="opera",gp="firefox",_p="iexplorer",vp="safari",Tp="nwjs",Ep="electron",wp="react-native",td="unknown",ks={Chrome:Ai,Chromium:Ai,Opera:mp,Firefox:gp,"Internet Explorer":_p,Safari:vp};function sD(){const{userAgent:t}=navigator,e={name:td,version:void 0};if(t.match(/Chrome/)&&!t.match(/Edge/))if(t.match(/Edg(A?)/)){const r=t.match(/Chrome\/([\d.]+)/)[1];Number.parseInt(r,10)>72&&(e.name=Ai,e.version=r)}else e.name=Ai,e.version=t.match(/Chrome\/([\d.]+)/)[1];return e}function aD(){const{userAgent:t}=navigator;if(t.match(/Electron/)){const e=t.match(/Electron\/([\d.]+)/)[1];return{name:Ep,version:e}}return null}function oD(){const{userAgent:t}=navigator;if(t.match(/JitsiMeetNW/)){const e=t.match(/JitsiMeetNW\/([\d.]+)/)[1];return{name:Tp,version:e}}}function cD(){const t=navigator.userAgent.match(/\b(react[ \t_-]*native)(?:\/(\S+))?/i);let e;if(t||navigator.product==="ReactNative")return t&&t.length>2&&(t[1],e=t[2]),e||(e="unknown"),{name:wp,version:e}}function dD(t){let e;const r=[cD,aD,oD];for(let i=0;i<r.length;i+=1)if(e=r[i](),e)return e;const n=t.getBrowserName();return n in ks?{name:ks[n],version:t.getBrowserVersion()}:(e=sD(),e||{name:td,version:void 0})}class uD{constructor(){g(this,"_bowser");g(this,"_name");g(this,"_version");g(this,"getDeviceInfo",()=>({isMobile:this.isMobile(),browserName:this._bowser.getBrowserName(),osName:this._bowser.getOSName(),browserVersion:this._bowser.getBrowserVersion(),osVersionName:this._bowser.getOSVersion(),engineName:this._bowser.getEngineName()}))}init(e){let r,n;if(this._bowser=rm.getParser(navigator.userAgent),typeof e=="undefined"){const i=dD(this._bowser);r=i.name,n=i.version}else e.name in ks?(r=ks[e.name],n=e.version):(r=td,n=void 0);this._name=r,this._version=n}getName(){return this._name}isChrome(){return this._name===Ai}isOpera(){return this._name===mp}isFirefox(){return this._name===gp}isIExplorer(){return this._name===_p}isSafari(){return this._name===vp}isNWJS(){return this._name===Tp}isElectron(){return this._name===Ep}isReactNative(){return this._name===wp||navigator.isReactNative===!0}getVersion(){return this._version}isMobile(){return this._bowser.getPlatformType()==="mobile"}_checkCondition(e){if(this._version)return this._bowser.satisfies(e)}isVersionGreaterThan(e){return this._checkCondition({[this._name]:`>${e}`})}isVersionLessThan(e){return this._checkCondition({[this._name]:`<${e}`})}isVersionEqualTo(e){return this._checkCondition({[this._name]:`~${e}`})}}const lD=72;class hD extends uD{doesVideoMuteByStreamRemove(){return this.isChromiumBased()||this.isWebKitBased()}supportsP2P(){return!this.usesUnifiedPlan()}isChromiumBased(){return this.isChrome()||this.isElectron()||this.isNWJS()||this.isOpera()}isWebKitBased(){return this._bowser.isEngine("webkit")&&typeof navigator.mediaDevices!="undefined"&&typeof navigator.mediaDevices.getUserMedia!="undefined"&&typeof window.RTCRtpTransceiver!="undefined"&&Object.keys(RTCRtpTransceiver.prototype).indexOf("currentDirection")>-1}isSupported(){return this.isChromiumBased()&&this._getChromiumBasedVersion()>=lD||this.isFirefox()||this.isReactNative()||this.isWebKitBased()}isUserInteractionRequiredForUnmute(){return this.isFirefox()&&this.isVersionLessThan("68")}supportsVideoMuteOnConnInterrupted(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}supportsBandwidthStatistics(){return!this.isFirefox()&&!this.isWebKitBased()}supportsCodecPreferences(){return this.usesUnifiedPlan()&&typeof window.RTCRtpTransceiver!="undefined"&&Object.keys(window.RTCRtpTransceiver.prototype).indexOf("setCodecPreferences")>-1&&Object.keys(RTCRtpSender.prototype).indexOf("getCapabilities")>-1&&!this.isWebKitBased()}supportsDeviceChangeEvent(){return navigator.mediaDevices&&typeof navigator.mediaDevices.ondevicechange!="undefined"&&typeof navigator.mediaDevices.addEventListener!="undefined"}supportsLocalCandidateRttStatistics(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}supportsPerformanceObserver(){return typeof window.PerformanceObserver!="undefined"&&PerformanceObserver.supportedEntryTypes.indexOf("longtask")>-1}supportsReceiverStats(){return typeof window.RTCRtpReceiver!="undefined"&&Object.keys(RTCRtpReceiver.prototype).indexOf("getSynchronizationSources")>-1}supportsRTTStatistics(){return!this.isFirefox()}usesPlanB(){return!this.usesUnifiedPlan()}usesSdpMungingForSimulcast(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}usesUnifiedPlan(){return!!(this.isFirefox()||this.isWebKitBased())}usesNewGumFlow(){return!!(this.isChromiumBased()||this.isFirefox()||this.isWebKitBased())}usesAdapter(){return this.usesNewGumFlow()}usesRidsForSimulcast(){return!1}supportsGetDisplayMedia(){return typeof navigator.getDisplayMedia!="undefined"||typeof navigator.mediaDevices!="undefined"&&typeof navigator.mediaDevices.getDisplayMedia!="undefined"}supportsInsertableStreams(){if(!(typeof window.RTCRtpSender!="undefined"&&(window.RTCRtpSender.prototype.createEncodedStreams||window.RTCRtpSender.prototype.createEncodedVideoStreams)))return!1;const e=new ReadableStream;try{return window.postMessage(e,"*",[e]),!0}catch(r){return!1}}supportsAudioRed(){return Boolean(window.RTCRtpSender&&window.RTCRtpSender.getCapabilities&&window.RTCRtpSender.getCapabilities("audio").codecs.some(e=>e.mimeType==="audio/red")&&window.RTCRtpReceiver&&window.RTCRtpReceiver.getCapabilities&&window.RTCRtpReceiver.getCapabilities("audio").codecs.some(e=>e.mimeType==="audio/red"))}supportsSdpSemantics(){return this.isChromiumBased()}_getChromiumBasedVersion(){if(this.isChromiumBased()){if(this.isNWJS())return Number.parseInt(process.versions.chromium,10);const e=navigator.userAgent;if(e.match(/Chrome/))return Number.parseInt(e.match(/Chrome\/([\d.]+)/)[1],10)}return-1}isIOSMobile(){return this.isMobile&&this._bowser.getOSName()==="iOS"}}const le=new hD,de=class{static get logsEndpoint(){return`https://${rD({servicePrefix:"api-silos",apiBase:B.apiBase,baseURI:B.baseURI})}/otel/logs`}static init(e,r){navigator.isReactNative||(de.tracingEnabled=r,de.meetingMetadata.peerId=e,de.meetingMetadata.sdkVersion=hp,de.meetingMetadata.deviceInfo=le.getDeviceInfo(),de.meetingMetadata.visitedUrl=!navigator.isReactNative&&typeof window!="undefined"&&window.location.href,document.addEventListener("visibilitychange",de.processCachedLogs),de.logsProcessorTimer=setInterval(de.processCachedLogs,de.logsProcessingInterval),r&&(de.initialized=!0))}static trace(e){return(r,n,i)=>{const s=i.value;return i.value=function(...o){if(!de.initialized||navigator.isReactNative||!de.tracingEnabled||ie.hasFeature(se.SKIP_OTEL_TRACES))return s.apply(this,o);de.addLogInCurrentSpan("info",e);const c=performance.now(),u=s.apply(this,o);return Promise.resolve(u).then(()=>{const h=performance.now();de.addLogInCurrentSpan("info",`${e}_timing`,{execTime:h-c})}).catch(()=>{const h=performance.now();de.addLogInCurrentSpan("info",`${e}_timing`,{execTime:h-c})}),u},i}}static injectContext(e){var i;const r=qe.v4().replace(/-/g,"").substring(0,16),n=(i=de.meetingMetadata.peerId)==null?void 0:i.replace(/-/g,"");e.TRACEPARENT=`00-${n}-${r}-01`}static addLogInCurrentSpan(e,r,n={},i=!1){if(n!=null&&n.error&&Object.assign(n,{error:No(n.error)}),fp()&&(Vc(n)?console[e]("DyteInternalLogs:: ",e,r):console[e]("DyteInternalLogs:: ",e,r,n)),!!nD(e))try{const a=iD(r,n,"metadata"),o=new Date,c={message:r,level:e,...a,loggedAt:o.toISOString(),loggedAtTzOffset:o.getTimezoneOffset()};i?de.sendOtelLogsToNewRelic([c]):de.logsCache.push(c)}catch(a){de.addLogInCurrentSpan("error","opentelemetry::addLogInCurrentSpan_failed",{error:No(a)})}}static sendOtelLogsToNewRelic(e){}static processCachedLogs(){const e=de.logsCache.splice(0,25);e!=null&&e.length}static destruct(){clearInterval(de.logsProcessorTimer),de.processCachedLogs(),!navigator.isReactNative&&document.removeEventListener("visibilitychange",de.processCachedLogs)}};let v=de;g(v,"logsCache",[]),g(v,"logsProcessorTimer"),g(v,"tracingEnabled",!0),g(v,"initialized",!1),g(v,"logsProcessingInterval",7e3),g(v,"logExclusionList",["message","websocket/message","roomMessage","websocket/room-message","websocket/room-legacy-mode","chatMessage","websocket/new-chat-message","websocket/no-active-speaker","websocket/selected-peers","websocket/active-speaker","ping","websocket/new-consumer","websocket/producer-score","websocket/consumer-score","websocket/plugin-event","websocket/plugin-data","websocket/plugin-internal-data"]),g(v,"meetingMetadata",{});class p{static info(e,r,n){v.addLogInCurrentSpan("info",e,r,n)}static error(e,r,n){v.addLogInCurrentSpan("error",e,r,n)}static debug(e,r,n){v.addLogInCurrentSpan("debug",e,r,n)}static log(e,r,n){v.addLogInCurrentSpan("log",e,r,n)}static warn(e,r,n){v.addLogInCurrentSpan("warn",e,r,n)}}class wr extends Qs.EventEmitter{constructor(){super(),super.setMaxListeners(25)}emit(e,...r){return super.emit("*",e,...r),super.emit(e,...r)}on(e,r){try{const n=this.listenerCount(e);n>25&&n%25===0&&p.warn("DyteEventEmitter::maxListenersExceeded",{eventListener:{eventName:e.toString(),listenerCount:this.listenerCount(e)}})}catch(n){}return super.on(e,r)}addListener(e,r){try{const n=this.listenerCount(e);n>25&&n%25===0&&p.warn("DyteEventEmitter::maxListenersExceeded",{eventListener:{eventName:e.toString(),listenerCount:this.listenerCount(e)}})}catch(n){}return super.addListener(e,r)}off(e,r){return super.off(e,r)}once(e,r){return super.once(e,r)}prependListener(e,r){return super.prependListener(e,r)}prependOnceListener(e,r){return super.prependOnceListener(e,r)}removeListener(e,r){return super.removeListener(e,r)}removeAllListeners(e){return super.removeAllListeners(e)}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}}class ht extends Qs.EventEmitter{constructor(){super(),super.setMaxListeners(25)}emit(e,...r){return super.emit("*",e,...r),super.emit(e,...r)}on(e,r){try{const n=this.listenerCount(e);n>25&&n%25===0&&p.warn("DyteEventEmitter::maxListenersExceeded",{eventListener:{eventName:e.toString(),listenerCount:this.listenerCount(e)}})}catch(n){}return super.on(e,r)}addListener(e,r){try{const n=this.listenerCount(e);n>25&&n%25===0&&p.warn("DyteEventEmitter::maxListenersExceeded",{eventListener:{eventName:e.toString(),listenerCount:this.listenerCount(e)}})}catch(n){}return super.addListener(e,r)}off(e,r){return super.off(e,r)}once(e,r){return super.once(e,r)}prependListener(e,r){return super.prependListener(e,r)}prependOnceListener(e,r){return super.prependOnceListener(e,r)}removeListener(e,r){return super.removeListener(e,r)}removeAllListeners(e){return super.removeAllListeners(e)}listeners(e){return super.listeners(e)}listenerCount(e){return super.listenerCount(e)}}const fD={"00":"DyteClient","01":"Controller","02":"RoomNodeClient","03":"HiveNodeClient","04":"SocketService","05":"Chat","06":"Plugin","07":"Polls","08":"Meta","09":"Preset",10:"Recording",11:"Self",12:"Participant",13:"Spotlight",14:"Remote Request",15:"Webinar",16:"LocalMediaHandler"},hs={"0000":"Internal exception.","0001":"Failed to initialize.","0002":"Failed to join room.","0003":"Failed to leave room.","0100":"Internal exception","0200":"Internal exception.","0300":"Internal exception","0400":"Internal exception","0500":"Internal exception","0501":"Permission denied.","0502":"Invalid message body.","0510":"Invalid channel name.","0600":"Internal exception","0700":"Internal exception","0800":"Internal exception","0900":"Internal exception",1e3:"Internal exception",1100:"Internal exception",1200:"Internal exception",1300:"Internal exception",1400:"Internal exception",1500:"Internal exception",1600:"Internal exception",1601:"Failed to get audio track",1602:"Failed to get video track",1603:"Incorrect device",1604:"Failed to change device",1700:"Internal exception"};Object.keys(hs).forEach(t=>{hs[t]=`{${fD[t.slice(0,2)]}} ${hs[t]}`});class E extends Error{constructor(r,n,i=!1){super(r);g(this,"code");this.code=n,this.name="DyteError",this.message=`[ERR${this.code}]: ${hs[this.code]}
${this.message}`;try{let s=i;n&&n.endsWith("00")&&(s=!0),s&&p.error("DyteError",{error:{message:this.message,name:this.name,code:n}})}catch(s){}}}function ts(t,e,r,n){if(typeof r=="function"&&n instanceof e)r.call(null,n,t);else throw n}function Ju(t,e,r){if(!t.value){const i=t.get,s=t.set;return i&&(t.get=function(){try{return i.apply(this)}catch(a){ts(this,e,r,a)}}),s&&(t.set=function(a){try{return s.apply(this,[a])}catch(o){ts(this,e,r,o)}}),t}const n=t.value;return t.value=function(...i){try{const s=n.apply(this,i);return s&&s instanceof Promise?s.catch(a=>{ts(this,e,r,a)}):s}catch(s){ts(this,e,r,s)}},t}function pD(t,e){return(r,n,i)=>{if(i)return Ju(i,t,e);for(const s of Reflect.ownKeys(r.prototype).filter(a=>a!=="constructor")){const a=Object.getOwnPropertyDescriptor(r.prototype,s);(a.value instanceof Function||a.get instanceof Function||a.set instanceof Function)&&Object.defineProperty(r.prototype,s,Ju(a,t,e))}}}const xe=t=>pD(Error,t);var mD=Object.defineProperty,gD=Object.getOwnPropertyDescriptor,_D=(t,e,r,n)=>{for(var i=n>1?void 0:n?gD(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&mD(e,r,i),i},Ir,fl;let xo=(fl=class extends ht{constructor(e,r,n){super();g(this,"selfActiveTab");g(this,"broadcastTabChanges");S(this,Ir,void 0);g(this,"viewType");g(this,"meetingStartedTimestamp");g(this,"meetingTitle");g(this,"sessionId");w(this,Ir,e),this.viewType=r,this.meetingTitle=n,this.broadcastTabChanges=e.permissions.canSpotlight}get joined(){return d(this,Ir).roomJoined}get roomName(){return this.meetingId}get meetingId(){return qe.v4()}get mediaConnected(){return d(this,Ir).roomJoined}get socketConnected(){return d(this,Ir).roomJoined}setBroadcastTabChanges(e){if(!d(this,Ir).permissions.canSpotlight)throw p.error("DyteSpotlight::setSpotlighted::permission_denied"),new E("User does not have permission to toggle spotlight");this.broadcastTabChanges=e,this.emit("broadcastTabChangesUpdate",this.broadcastTabChanges)}setSelfActiveTab(e,r){p.info("DyteSpotlight::setActiveTab",{spotlight:{currentTab:{id:e.id,type:e.type}}}),this.selfActiveTab=e,r===0&&this.emit("selfTabUpdate",e)}},Ir=new WeakMap,fl);xo=_D([xe(t=>{throw new E(t.message,"0800")})],xo);const Lo={gross:{width:{ideal:192},height:{ideal:144}},qvga:{width:{ideal:384},height:{ideal:288}},pvga:{width:{ideal:480},height:{ideal:360}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}},hd_cropped:{width:{ideal:900},height:{ideal:720}},fhd:{width:{ideal:1920},height:{ideal:1080}}};function vD(t){return t.replace(/([-_]\w)/g,e=>e[1].toUpperCase())}function Tt(t){if(!t||typeof t!="object")return t;if(Array.isArray(t))return t.map(r=>Tt(r));const e={};return Object.keys(t).forEach(r=>{const n=qe.validate(r)?r:vD(r);e[n]=Tt(t[r])}),e}function TD(t){return t.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`)}function yp(t){if(!t||typeof t!="object")return t;if(Array.isArray(t))return t.map(r=>yp(r));const e={};return Object.keys(t).forEach(r=>{const n=qe.validate(r)?r:TD(r);e[n]=t[r]}),e}const ED=oE(),Ye=Tt(ED.config.media);function wD(t){var r,n;const e={};return t.audio&&(e.audio={enableStereo:(r=t.audio.enableStereo)!=null?r:!1,enableHighBitrate:(n=t.audio.enableHighBitrate)!=null?n:!1}),e.video=t.video.quality,e}var Qr;class Ap{constructor(e){S(this,Qr,void 0);g(this,"getScreenShareConstraints",()=>{var c,u,h,f,m,T,A,C,R,b;const{displaySurface:e}=(c=B.defaults.screenShare)!=null?c:{},r=(u=d(this,Qr))==null?void 0:u.screenshare,n=(f=(h=r==null?void 0:r.width)==null?void 0:h.max)!=null?f:1920,i=(T=(m=r==null?void 0:r.height)==null?void 0:m.max)!=null?T:1080,s=(C=(A=r==null?void 0:r.frameRate)==null?void 0:A.max)!=null?C:5;let a=(b=(R=r==null?void 0:r.frameRate)==null?void 0:R.ideal)!=null?b:5;ie.getValue(se.VAL_MIN_FRAMERATE)&&(a=parseInt(ie.getValue(se.VAL_MIN_FRAMERATE),10));let o={width:{max:n},height:{max:i},frameRate:{ideal:a,max:s}};if(ie.hasFeature(se.SCREENSHARE_CONSTRAINTS)){const D=ie.getValue(se.SCREENSHARE_CONSTRAINTS);o=JSON.parse(D)}return e!==void 0&&["monitor","browser","window"].includes(e)&&(o={...o,displaySurface:e}),{audio:!0,video:o}});g(this,"getAudioConstraints",e=>{var s,a,o,c,u,h,f,m;const r={},n=(s=d(this,Qr))==null?void 0:s.audio,i=n!=null&&n.enableStereo?2:1;return le.isFirefox()||le.isWebKitBased()?(r.audio={deviceId:e,autoGainControl:(a=n==null?void 0:n.autoGainControl)!=null?a:!0,echoCancellation:(o=n==null?void 0:n.echoCancellation)!=null?o:!0,noiseSuppression:(c=n==null?void 0:n.noiseSupression)!=null?c:!0,channelCount:i},r):(r.audio={},r.audio.optional=[e?{sourceId:e}:{sourceId:"default"},{channelCount:i},{echoCancellation:(u=n==null?void 0:n.echoCancellation)!=null?u:!0},{googEchoCancellation:(h=n==null?void 0:n.echoCancellation)!=null?h:!0},{googAutoGainControl:(f=n==null?void 0:n.autoGainControl)!=null?f:!0},{googNoiseSuppression:(m=n==null?void 0:n.noiseSupression)!=null?m:!0},{googHighpassFilter:!0}],r)});g(this,"getVideoConstraints",e=>{var s,a,o;const r={},n=(s=d(this,Qr))==null?void 0:s.video;let i=Lo.vga;if(typeof n=="string"?i=Lo[n]:n!==void 0&&(i.height.ideal=n.height.ideal,i.width.ideal=n.width.ideal),i.frameRate={ideal:(o=(a=i.frameRate)==null?void 0:a.ideal)!=null?o:24},le.isChromiumBased()&&(i.frameRate.max=30),ie.hasFeature(se.VIDEO_CONSTRAINTS)){const c=ie.getValue(se.VIDEO_CONSTRAINTS);i=JSON.parse(c)}return r.video=i,e?r.video.deviceId={exact:e}:r.video.facingMode="user",r});w(this,Qr,e)}getUpdatedVideoConstraints(e){return e}}Qr=new WeakMap;var I=(t=>(t.NEW_PRODUCER="NEW_PRODUCER",t.PRODUCER_TRACK_ENDED="PRODUCER_TRACK_ENDED",t.ROOM_NODE_CONNECTED="ROOM_NODE_CONNECTED",t.ROOM_NODE_DISCONNECTED="ROOM_NODE_DISCONNECTED",t.ROOM_NODE_CONNECTION_ERROR="ROOM_NODE_CONNECTION_ERROR",t.SOCKET_SERVICE_CONNECTED="SOCKET_SERVICE_CONNECTED",t.SOCKET_SERVICE_DISCONNECTED="SOCKET_SERVICE_DISCONNECTED",t.SOCKET_SERVICE_RECONNECTING="SOCKET_SERVICE_RECONNECTING",t.SOCKET_SERVICE_RECONNECTION_ATTEMPT="SOCKET_SERVICE_RECONNECTION_ATTEMPT",t.SOCKET_SERVICE_RECONNECT_FAILURE="SOCKET_SERVICE_RECONNECT_FAILURE",t.SOCKET_SERVICE_RECONNECTED="SOCKET_SERVICE_RECONNECTED",t.SOCKET_SERVICE_FAILED="SOCKET_SERVICE_FAILED",t.ROOM_JOINED="ROOM_JOINED",t.SOCKET_SERVICE_ROOM_JOINED="SOCKET_SERVICE_ROOM_JOINED",t.SELF_ROOM_JOINED="SELF_ROOM_JOINED",t.PRODUCER_SCORE_UPDATE="PRODUCER_SCORE_UPDATE",t.CONSUMER_SCORE_UPDATE="CONSUMER_SCORE_UPDATE",t.PRODUCER_STATUS_UPDATE="PRODUCER_STATUS_UPDATE",t.CONSUMER_STATUS_UPDATE="CONSUMER_STATUS_UPDATE",t.LOW_PRODUCER_SCORE="LOW_PRODUCER_SCORE",t.LOW_CONSUMER_SCORE="LOW_CONSUMER_SCORE",t.MEDIA_PERMISSION_ERROR="MEDIA_PERMISSION_ERROR",t.MEDIA_PERMISSION_UPDATE="MEDIA_PERMISSION_UPDATE",t.WAITLISTED="WAIT_LISTED",t.WAITLIST_ACCEPTED="websocket/waitlist-accepted",t.WAITLIST_REJECTED="websocket/waitlist-rejected",t.WAITLIST_PEER_ADDED="websocket/waitlist-peer-added",t.WAITLIST_PEER_REMOVED="websocket/waitlist-peer-closed",t.MESSAGE="websocket/message",t.ROOM_MESSAGE="websocket/room-message",t.DISABLE_AUDIO="websocket/disable-audio",t.DISABLE_VIDEO="websocket/disable-video",t.PEER_JOINED="websocket/peer-joined",t.PEER_CLOSED="websocket/peer-closed",t.PEER_MUTED="websocket/peer-muted",t.PEER_UNMUTED="websocket/peer-unmuted",t.PEER_PINNED="websocket/pin-peer",t.PEER_UNPINNED="websocker/unpin-peer",t.MUTE_ALL="websocket/mute-all",t.MUTE_ALL_VIDEO="websocket/mute-all-video",t.CONSUMER_CLOSED="websocket/consumer-closed",t.CONSUMER_PAUSED="websocket/consumer-paused",t.CONSUMER_RESUMED="websocket/consumer-resumed",t.PRODUCER_CLOSED="websocket/producer-closed",t.NEW_CONSUMER="websocket/new-consumer",t.CONNECTED_MEETING_STATE="websocket/connectedMeetingState",t.MOVE_TO_CONNECTED_MEETING="websocket/transferMeeting",t.GET_CHAT_MESSAGES="websocket/get-chat-messages",t.NEW_CHAT_MESSAGE="websocket/new-chat-message",t.PIN_CHAT_MESSAGE="websocket/pin-chat-message",t.UNPIN_CHAT_MESSAGE="websocket/unpin-chat-message",t.GET_POLLS="websocket/get-polls",t.UPDATE_POLL="websocket/update-poll",t.SELECTED_PEERS="websocket/selected-peers",t.GET_PAGE="websocket/get-page",t.ACTIVE_SPEAKER="websocket/active-speaker",t.NO_ACTIVE_SPEAKER="websocket/no-active-speaker",t.PRODUCER_SCORE="websocket/producer-score",t.CONSUMER_SCORE="websocket/consumer-score",t.ENABLE_PLUGIN="websocket/enable-plugin",t.DISABLE_PLUGIN="websocket/disable-plugin",t.PLUGIN_EVENT="websocket/plugin-event",t.PLUGIN_DATA="websocket/plugin-data",t.PLUGIN_INTERNAL_DATA="websocket/plugin-internal-data",t.KICKED="websocket/kicked",t.ICE_CONNECTED="ICE_CONNECTED",t.ICE_DISCONNECTED="ICE_DISCONNECTED",t.ICE_FAILED="ICE_FAILED",t.ICE_RECONNECTING="ICE_RECONNECTING",t.AUDIO_TRACK_ANALYSIS="AUDIO_TRACK_ANALYSIS",t.AUDIO_TRACK_CLOSED="AUDIO_TRACK_CLOSED",t.AUDIO_TRACK_CHANGED="AUDIO_TRACK_CHANGED",t.AUDIO_TRACK_CREATED="AUDIO_TRACK_CREATED",t.VIDEO_TRACK_ANALYSIS="VIDEO_TRACK_ANALYSIS",t.VIDEO_TRACK_ANALYSIS_ERROR="VIDEO_TRACK_ANALYSIS_ERROR",t.VIDEO_TRACK_CLOSED="VIDEO_TRACK_CLOSED",t.VIDEO_TRACK_CHANGED="VIDEO_TRACK_CHANGED",t.VIDEO_TRACK_CREATED="VIDEO_TRACK_CREATED",t.SCREENSHARE_AUDIO_TRACK_ANALYSIS="SCREENSHARE_AUDIO_TRACK_ANALYSIS",t.SCREENSHARE_AUDIO_TRACK_CLOSED="SCREENSHARE_AUDIO_TRACK_CLOSED",t.SCREENSHARE_AUDIO_TRACK_CREATED="SCREENSHARE_AUDIO_TRACK_CREATED",t.SCREENSHARE_VIDEO_TRACK_ANALYSIS="SCREENSHARE_VIDEO_TRACK_ANALYSIS",t.SCREENSHARE_VIDEO_TRACK_ANALYSIS_ERROR="SCREENSHARE_VIDEO_TRACK_ANALYSIS_ERROR",t.SCREENSHARE_VIDEO_TRACK_CLOSED="SCREENSHARE_VIDEO_TRACK_CLOSED",t.SCREENSHARE_VIDEO_TRACK_CREATED="SCREENSHARE_VIDEO_TRACK_CREATED",t.SCREENSHARE_TRACK_CHANGED="SCREENSHARE_TRACK_CHANGED",t.CANDIDATE_PEER_UPDATE="CANDIDATE_PEER_UPDATE",t.INBOUND_RTP_UPDATE="INBOUND_RTP_UPDATE",t.OUTBOUND_RTP_UPDATE="OUTBOUND_RTP_UPDATE",t.SEND_TRANSPORT_CLOSED="SEND_TRANSPORT_CLOSED",t.RECV_TRANSPORT_CLOSED="RECV_TRANSPORT_CLOSED",t.SEND_TRANSPORT_CREATED="SEND_TRANSPORT_CREATED",t.RECV_TRANSPORT_CREATED="RECV_TRANSPORT_CREATED",t.PRODUCER_TOGGLE="hive/producer-toggle",t.CONSUMER_TOGGLE="hive/consumer-toggle",t.SELECTED_PEERS_DIFF="hive/selected-peers-diff",t.REFRESH_GRID="hive/refresh-grid",t.RESET_PRODUCER_STATE="hive/reset-producer-state",t.HIVE_TRANSPORT_STATE_CHANGED="hive/transport-state-changed",t.HIVE_ROOM_REJOINING="hive/room-rejoining",t.HIVE_ROOM_REJOIN_FAILED="hive/room-rejoining-failed",t.HIVE_ROOM_REJOINED="hive/room-rejoined",t.HIVE_TRANPSORT_RECONNECTING="hive/transport-reconnecting",t.ROOM_STATE="sockethub/room-state",t.PEER_DISPLAY_NAME_CHANGED="hive/display-name-changed",t.ASSERT_SPOTLIGHTER="websocket/assert-spotlighter",t.GET_STAGE_REQUESTS="GET_STAGE_REQUESTS",t.UPDATE_STAGE_REQUESTS="UPDATE_STAGE_REQUESTS",t.PEER_REQUESTED_TO_JOIN_STAGE="websocket/request-to-join-stage-peer-added",t.PEER_WITHDRAWN_REQUEST_TO_JOIN_STAGE="websocket/request-to-join-stage-peer-withdrawn",t.PEER_REJECTED_TO_JOIN_STAGE="websocket/peer-rejected-to-join-stage",t.PEER_ADDED_TO_STAGE="websocket/peer-added-to-stage",t.PEER_REMOVED_FROM_STAGE="websocket/peer-removed-from-stage",t.PEER_STARTED_PRESENTING="websocket/peer-started-presenting",t.PEER_STOPPED_PRESENTING="websocket/peer-stopped-presenting",t.STAGE_REQUESTS_UPDATED="STAGE_REQUESTS_UPDATED",t.KICK_PEER="KICK_PEER",t.REQUEST_TO_JOIN_STAGE_ACCEPTED="websocket/request-to-join-stage-accepted",t.REQUEST_TO_JOIN_STAGE_REJECTED="websocket/request-to-join-stage-rejected",t.STARTED_PRESENTING="websocket/started-presenting",t.STOPPED_PRESENTING="websocket/stopped-presenting",t.REMOVED_FROM_STAGE="websocket/removed-from-stage",t.JOIN_MEDIA_ROOM="JOIN_MEDIA_ROOM",t.LEAVE_MEDIA_ROOM="LEAVE_MEDIA_ROOM",t.UPDATE_PEER_STAGE_STATUS="UPDATE_PEER_STAGE_STATUS",t.GET_WEBINAR_STAGE_STATUS="GET_WEBINAR_STAGE_STATUS",t.REQUEST_TO_JOIN_STAGE="REQUEST_TO_JOIN_STAGE",t.WITHDRAW_REQUEST_TO_JOIN_STAGE="WITHDRAW_REQUEST_TO_JOIN_STAGE",t.LEAVE_STAGE="LEAVE_STAGE",t.JOIN_STAGE="JOIN_STAGE",t.SET_WEBINAR_STAGE_STATUS="SET_WEBINAR_STAGE_STATUS",t.SET_STAGE_STATUS="SET_STAGE_STATUS",t.NEW_STAGE_REQUEST="NEW_STAGE_REQUEST",t.ACCEPT_JOIN_STAGE_REQUEST="ACCEPT_JOIN_STAGE_REQUEST",t.REMOVE_FROM_STAGE="REMOVE_FROM_STAGE",t.REJECT_REQUEST_TO_JOIN_STAGE="REJECT_REQUEST_TO_JOIN_STAGE",t.ACCEPT_ALL_REQUESTS_TO_JOIN_STAGE="ACCEPT_ALL_REQUESTS_TO_JOIN_STAGE",t.PIP_HANGUP="PIP_HANGUP",t.SOCKET_PEERS="SOCKET_PEERS",t.UPDATE_PERMISSIONS="UPDATE_PERMISSIONS",t))(I||{}),tr,rr;class yD extends Qs.EventEmitter{constructor(){super();S(this,tr,void 0);S(this,rr,void 0);g(this,"asyncPromiseTimeout");w(this,tr,new Map),w(this,rr,new Map),this.asyncPromiseTimeout=8e3}async emitAsync(r,...n){d(this,tr).set(r,[]);const i=d(this,rr).get(r).map(()=>new Promise(s=>{d(this,tr).get(r).push(s)}));super.emit(r,...n),await Promise.race([Promise.all(i),new Promise((s,a)=>setTimeout(()=>a(new Error(`emitAsync failed to resolve for event ${r}.`)),this.asyncPromiseTimeout))]),d(this,tr).delete(r)}onAsync(r,n){const i=d(this,tr),s=async(...a)=>{var c;try{await n(...a)}catch(u){p.error("[onAsync]",{error:u})}const o=(c=i.get(r))==null?void 0:c.shift();o==null||o()};return d(this,rr).get(r)||d(this,rr).set(r,[]),d(this,rr).get(r).push(s),super.on(r,s)}reset(){w(this,tr,new Map),w(this,rr,new Map),super.removeAllListeners()}}tr=new WeakMap,rr=new WeakMap;const P=new yD;var Jr=(t=>(t.allowed="ALLOWED",t.notAllowed="NOT_ALLOWED",t.canRequest="CAN_REQUEST",t))(Jr||{});const AD={view_type:st.GroupCall,accept_waiting_requests:!1,request_produce:!1,can_allow_participant_audio:!0,can_allow_participant_screensharing:!1,can_allow_participant_video:!0,request_kick_participant:!1,kick_participant:!0,pin_participant:!0,can_record:!1,waiting_room_type:"SKIP",plugins:{can_close:!0,can_start:!0,can_edit_acl:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},produce:{video:{allow:!0,quality:Ye.video.quality,frame_rate:Ye.video.frameRate},audio:!0,screenshare:{allow:!0,quality:Ye.screenshare.quality,frame_rate:Ye.screenshare.frameRate}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1}},reactions:!1,hidden_participant:!1,show_participant_list:!0,can_change_participant_role:!0,can_change_theme:!1,can_present:!1,accept_present_requests:!1,can_edit_display_name:!1,max_screenshare_count:1,is_recorder:!1,can_spotlight:!1};Tt(AD);const ae=Tt(hc().permissions);var M,Nn,Ri,Le,Ls;const $s=class extends ht{constructor(r,n,i,s=!1){super();S(this,M,void 0);S(this,Nn,void 0);S(this,Ri,void 0);S(this,Le,void 0);S(this,Ls,r=>{r.chat&&(r.chat.private&&l.merge(d(this,M).chat.private,r.chat.private),r.chat.public&&l.merge(d(this,M).chat.public,r.chat.public),this.emit("chatUpdate")),r.polls&&(l.merge(d(this,M).polls,r.polls),this.emit("pollsUpdate")),r.plugins&&(l.merge(d(this,M).plugins,r.plugins),this.emit("pluginsUpdate"))});if(!r)throw p.error("DytePermissionsPreset::load_preset_permissions_failed"),new E("Could not load preset permissions.");w(this,Ri,i),w(this,Nn,n),w(this,M,r),s&&this.setupEvents()}setupEvents(){async function r(n){w(this,Le,n),this.stageStatus=n}P.onAsync(I.SET_STAGE_STATUS,r.bind(this)),P.on(I.UPDATE_PERMISSIONS,d(this,Ls))}static fromResponse(r,n,i){return new $s(r,n,i,!0)}static default(r,n){return new $s(ae,r,n)}get mediaRoomType(){return d(this,Ri)?"HIVE":"ROOM_NODE"}get stageEnabled(){var r;return((r=d(this,M))==null?void 0:r.stageEnabled)||d(this,Nn)===st.Webinar||d(this,Nn)===st.Livestream}get acceptStageRequests(){var r,n;return this.stageEnabled?((r=d(this,M))==null?void 0:r.acceptStageRequests)||((n=d(this,M))==null?void 0:n.canAcceptProductionRequests):!1}get stageAccess(){var r,n,i;return((r=d(this,M))==null?void 0:r.stageAccess)===x.NotAllowed?x.NotAllowed:((n=d(this,M))==null?void 0:n.stageAccess)===x.CanRequest?x.CanRequest:((i=d(this,M))==null?void 0:i.stageAccess)===x.Allowed||d(this,M).media.audio.canProduce===x.Allowed||d(this,M).media.video.canProduce===x.Allowed||d(this,M).media.screenshare.canProduce===x.Allowed?x.Allowed:d(this,M).media.audio.canProduce===x.CanRequest||d(this,M).media.video.canProduce===x.CanRequest||d(this,M).media.screenshare.canProduce===x.CanRequest?x.CanRequest:x.NotAllowed}get acceptWaitingRequests(){var r,n;return(n=(r=d(this,M))==null?void 0:r.acceptWaitingRequests)!=null?n:ae.acceptWaitingRequests}get requestProduceVideo(){var r,n,i;return((i=(n=(r=d(this,M))==null?void 0:r.media)==null?void 0:n.video)==null?void 0:i.canProduce)===x.CanRequest}get requestProduceAudio(){var r,n,i;return((i=(n=(r=d(this,M))==null?void 0:r.media)==null?void 0:n.audio)==null?void 0:i.canProduce)===x.CanRequest}get requestProduceScreenshare(){var r,n,i;return((i=(n=(r=d(this,M))==null?void 0:r.media)==null?void 0:n.screenshare)==null?void 0:i.canProduce)===x.CanRequest}get canAllowParticipantAudio(){var r,n;return(n=(r=d(this,M))==null?void 0:r.disableParticipantAudio)!=null?n:ae.disableParticipantAudio}get canAllowParticipantScreensharing(){var r,n;return(n=(r=d(this,M))==null?void 0:r.canAcceptProductionRequests)!=null?n:ae.canAcceptProductionRequests}get canAllowParticipantVideo(){var r,n;return(n=(r=d(this,M))==null?void 0:r.disableParticipantVideo)!=null?n:ae.disableParticipantVideo}get canDisableParticipantAudio(){return this.canAllowParticipantAudio}get canDisableParticipantVideo(){return this.canAllowParticipantVideo}get kickParticipant(){var r,n;return(n=(r=d(this,M))==null?void 0:r.kickParticipant)!=null?n:ae.kickParticipant}get pinParticipant(){var r,n;return(n=(r=d(this,M))==null?void 0:r.pinParticipant)!=null?n:ae.pinParticipant}get canRecord(){var r,n;return(n=(r=d(this,M))==null?void 0:r.canRecord)!=null?n:ae.canRecord}get waitingRoomType(){var r,n;return(n=(r=d(this,M))==null?void 0:r.waitingRoomType)!=null?n:ae.waitingRoomType}get waitingRoomBehaviour(){var r,n;return(n=(r=d(this,M))==null?void 0:r.waitingRoomType)!=null?n:ae.waitingRoomType}get plugins(){var r,n;return(n=(r=d(this,M))==null?void 0:r.plugins)!=null?n:ae.plugins}get polls(){var r,n;return(n=(r=d(this,M))==null?void 0:r.polls)!=null?n:ae.polls}get produceVideo(){return this.canProduceVideo}get requestProduce(){return d(this,M).media.audio.canProduce===x.CanRequest||d(this,M).media.video.canProduce===x.CanRequest||d(this,M).media.screenshare.canProduce===x.CanRequest}get canProduceVideo(){var n;const r=(n=d(this,M).media.video.canProduce)!=null?n:ae.media.video.canProduce;return this.stageEnabled&&(d(this,Le)==="ACCEPTED_TO_JOIN_STAGE"||d(this,Le)==="ON_STAGE")&&r===x.CanRequest?x.Allowed:this.stageEnabled&&(d(this,Le)==="OFF_STAGE"||d(this,Le)==="REQUESTED_TO_JOIN_STAGE")&&r===x.Allowed?x.NotAllowed:r}get produceScreenshare(){return this.canProduceScreenshare}get canProduceScreenshare(){var n;const r=(n=d(this,M).media.screenshare.canProduce)!=null?n:ae.media.screenshare.canProduce;return this.stageEnabled&&(d(this,Le)==="ACCEPTED_TO_JOIN_STAGE"||d(this,Le)==="ON_STAGE")&&r===x.CanRequest?x.Allowed:this.stageEnabled&&(d(this,Le)==="OFF_STAGE"||d(this,Le)==="REQUESTED_TO_JOIN_STAGE")&&r===x.Allowed?x.NotAllowed:r}get produceAudio(){return this.canProduceAudio}get canProduceAudio(){var n;const r=(n=d(this,M).media.audio.canProduce)!=null?n:ae.media.audio.canProduce;return this.stageEnabled&&(d(this,Le)==="ACCEPTED_TO_JOIN_STAGE"||d(this,Le)==="ON_STAGE")&&r===x.CanRequest?x.Allowed:this.stageEnabled&&(d(this,Le)==="OFF_STAGE"||d(this,Le)==="REQUESTED_TO_JOIN_STAGE")&&r===x.Allowed?x.NotAllowed:r}get chatPublic(){var r,n,i;return(i=(n=(r=d(this,M))==null?void 0:r.chat)==null?void 0:n.public)!=null?i:ae.chat.public}get chatPrivate(){var r,n,i;return(i=(n=(r=d(this,M))==null?void 0:r.chat)==null?void 0:n.private)!=null?i:ae.chat.private}get chatChannel(){var r,n,i;return(i=(n=(r=d(this,M))==null?void 0:r.chat)==null?void 0:n.channel)!=null?i:ae.chat.channel}get chatMessage(){var r,n,i;return(i=(n=(r=d(this,M))==null?void 0:r.chat)==null?void 0:n.message)!=null?i:ae.chat.message}get connectedMeetings(){var r,n;return(n=(r=d(this,M))==null?void 0:r.connectedMeetings)!=null?n:ae==null?void 0:ae.connectedMeetings}get hiddenParticipant(){var r,n;return(n=(r=d(this,M))==null?void 0:r.hiddenParticipant)!=null?n:ae.hiddenParticipant}get showParticipantList(){var r;return(r=d(this,M).showParticipantList)!=null?r:ae.showParticipantList}get canChangeParticipantRole(){var r,n;return(n=(r=d(this,M))==null?void 0:r.canChangeParticipantPermissions)!=null?n:ae.canChangeParticipantPermissions}get canChangeParticipantPermissions(){var r,n;return(n=(r=d(this,M))==null?void 0:r.canChangeParticipantPermissions)!=null?n:ae.canChangeParticipantPermissions}get canChangeTheme(){return!1}get canPresent(){return d(this,M).media.audio.canProduce===x.Allowed||d(this,M).media.video.canProduce===x.Allowed||d(this,M).media.screenshare.canProduce===x.Allowed}get acceptPresentRequests(){return this.acceptStageRequests}get canEditDisplayName(){var r;return(r=d(this,M).canEditDisplayName)!=null?r:!1}get maxScreenShareCount(){return 1}get isRecorder(){return d(this,M).isRecorder}get canSpotlight(){return d(this,M).canSpotlight}get canLivestream(){return d(this,M).canLivestream}get transcriptionEnabled(){return d(this,M).transcriptionEnabled}get isV2(){return!0}};let $o=$s;M=new WeakMap,Nn=new WeakMap,Ri=new WeakMap,Le=new WeakMap,Ls=new WeakMap;const RD=Tt(hc());var it,Zr,xn;const Us=class{constructor(e){S(this,it,void 0);S(this,Zr,void 0);S(this,xn,void 0);if(!e)throw new E("Could not load preset.");w(this,it,e.config),w(this,Zr,e.ui||Tt(hc().ui)),w(this,xn,e.permissions.plugins.config)}static fromResponse(e){return new Us(e)}static default(){return new Us(RD)}get setupScreen(){return{isEnabled:!0}}get waitingRoom(){return{isEnabled:!0}}get controlBar(){return{isEnabled:!0,elements:{chat:!0,fullscreen:!0,invite:!1,layout:!1,participants:!0,plugins:!0,polls:!0,reactions:!1,screenshare:!0}}}get header(){return{isEnabled:!0,elements:{logo:d(this,Zr).designTokens.logo,timer:!0,title:!0,participantCount:!0,changeLayout:!1}}}get pipMode(){return!0}get viewType(){return d(this,it).viewType}get maxVideoStreams(){return d(this,it).maxVideoStreams}get maxScreenShareCount(){return d(this,it).maxScreenshareCount}get plugins(){return[]}get disabledPlugins(){return Object.keys(d(this,xn)).filter(e=>d(this,xn)[e].disabled)}get designTokens(){return d(this,Zr).designTokens}get configDiff(){return d(this,Zr).configDiff}get mediaConstraints(){var e,r,n,i,s,a,o,c,u,h,f,m,T,A,C,R,b,D,H,k,Z,K,ve,Ge;return{audio:{enableStereo:(i=(n=(r=(e=d(this,it))==null?void 0:e.media)==null?void 0:r.audio)==null?void 0:n.enableStereo)!=null?i:Ye.audio.enableStereo,enableHighBitrate:(c=(o=(a=(s=d(this,it))==null?void 0:s.media)==null?void 0:a.audio)==null?void 0:o.enableHighBitrate)!=null?c:Ye.audio.enableHighBitrate},video:{quality:(m=(f=(h=(u=d(this,it))==null?void 0:u.media)==null?void 0:h.video)==null?void 0:f.quality)!=null?m:Ye.video.quality,frameRate:(R=(C=(A=(T=d(this,it))==null?void 0:T.media)==null?void 0:A.video)==null?void 0:C.frameRate)!=null?R:Ye.video.frameRate},screenshare:{quality:(k=(H=(D=(b=d(this,it))==null?void 0:b.media)==null?void 0:D.screenshare)==null?void 0:H.quality)!=null?k:Ye.screenshare.quality,frameRate:(Ge=(ve=(K=(Z=d(this,it))==null?void 0:Z.media)==null?void 0:K.screenshare)==null?void 0:ve.frameRate)!=null?Ge:Ye.screenshare.frameRate}}}get isV2(){return!0}};let Uo=Us;it=new WeakMap,Zr=new WeakMap,xn=new WeakMap;function zr(t){var e,r,n,i,s,a,o,c,u,h,f,m,T;return t?{media:{audio:{enabled:t.audioEnabled,trackId:(e=t.audioTrack)==null?void 0:e.id,permission:"mediaPermissions"in t?(r=t.mediaPermissions)==null?void 0:r.audio:null},video:{enabled:t.videoEnabled,trackId:(n=t.videoTrack)==null?void 0:n.id,permission:"mediaPermissions"in t?(i=t.mediaPermissions)==null?void 0:i.video:null},screenshare:{enabled:t.screenShareEnabled,permission:"mediaPermissions"in t?(s=t.mediaPermissions)==null?void 0:s.screenshare:null,audio:{enabled:(o=(a=t.screenShareTracks)==null?void 0:a.audio)==null?void 0:o.enabled,trackId:(u=(c=t.screenShareTracks)==null?void 0:c.audio)==null?void 0:u.id},video:{enabled:(f=(h=t.screenShareTracks)==null?void 0:h.video)==null?void 0:f.enabled,trackId:(T=(m=t.screenShareTracks)==null?void 0:m.video)==null?void 0:T.id}}}}:{}}const SD=["virtual","emulator","krisp","solstice conference","teams","manycam","blackHole"];function Yu(t){const e=t.label.toLowerCase();return le._bowser.getOSName()==="macOS"&&e.includes("iphone")?(p.log("isVirtualDevice::ignore_macos_continuity"),!0):SD.some(r=>e.includes(r))}const er={setItem:(t,e)=>{try{localStorage.setItem(t,e)}catch(r){p.error("LocalStorage::setItem::crashed",{error:r,localStorage:{key:t,value:e}})}},getItem:t=>{try{return localStorage.getItem(t)}catch(e){p.error("LocalStorage::getItem::crashed",{error:e,localStorage:{key:t}})}return null}},bD=(t=0)=>new Promise(e=>setTimeout(e,t)),kD=(t,e,r)=>{const n=typeof r=="number"?r:250,i=t.createMediaStreamSource(e),s=t.createAnalyser();s.fftSize=2048,i.connect(s);const a=new Uint8Array(s.fftSize);let o=!1;setTimeout(()=>{o=!0},n);function c(){return o?Promise.resolve(!0):(s.getByteTimeDomainData(a),a.some(u=>u!==128&&u!==0)?Promise.resolve(!1):bD().then(c))}return c().then(u=>(i.disconnect(),u),u=>{throw i.disconnect(),u})},CD=typeof AudioContext!="undefined"?AudioContext:null;class rd{constructor(e){g(this,"_AudioContext");g(this,"audioContext");g(this,"_audioContextRefContainers");const r={AudioContext:CD,...e};Object.defineProperties(this,{_AudioContext:{value:r.AudioContext},audioContext:{value:null,writable:!0},_audioContextRefContainers:{value:new Set},AudioContextProvider:{enumerable:!0,value:rd}})}getOrCreate(e){if(!this._audioContextRefContainers.has(e)&&(this._audioContextRefContainers.add(e),this._AudioContext&&!this.audioContext))try{this.audioContext=new this._AudioContext}catch(r){}return this.audioContext}release(e){this._audioContextRefContainers.has(e)&&(this._audioContextRefContainers.delete(e),!this._audioContextRefContainers.size&&this.audioContext&&(this.audioContext.close(),this.audioContext=null))}}const zu=new rd,ID=3,PD=250;function DD(t){const e={},r=zu.getOrCreate(e);let n=ID;function i(){return n-=1,kD(r,t.srcObject,PD).then(s=>s?n>0?i():!0:!1).catch(()=>!0)}return i().finally(()=>{zu.release(e)})}async function Cs(t){const e=new Audio,r=new MediaStream;r.addTrack(t),e.srcObject=r;let n=!1;try{const i=e.play();i&&await i,n=await DD(e),n&&p.info("checkIfAudioTrackIsSilent::silence_detected")}catch(i){p.error("checkIfAudioTrackIsSilent::failed_to_detect_silence",{error:i})}finally{e.pause(),e.remove()}return n}async function OD(t,e){if(!(t!=null&&t.length))return e;const r=new AudioContext,n=await Promise.all(t==null?void 0:t.map(a=>a(r))),i=r.createMediaStreamSource(new MediaStream([e])),s=r.createMediaStreamDestination();try{let a=i;for(let o=0;o<n.length;o+=1)a.connect(n[o]),a=n[o];a.connect(s)}catch(a){return p.error("getTransformedAudioTrack::middleware_execution_failed",{error:a}),e}return s.stream.getAudioTracks()[0]}var MD=Object.defineProperty,ND=Object.getOwnPropertyDescriptor,xD=(t,e,r,n)=>{for(var i=n>1?void 0:n?ND(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&MD(e,r,i),i};let Fo=class extends wr{constructor(e,r,n){super();g(this,"constructorName",this.constructor.name);g(this,"userSelectedDevice");g(this,"mediaInterface");g(this,"isNonPreferredDevice");g(this,"_mediaTrack");g(this,"transformedMediaTrack");g(this,"middlewares",[]);g(this,"currentDevice");this.mediaInterface=e,r&&this.setMediaTrack(r),this.userSelectedDevice=void 0,this.isNonPreferredDevice=n,this.onTrackEnded=this.onTrackEnded.bind(this),this.onTrackMuted=this.onTrackMuted.bind(this)}disableTrack(){var e,r;this.removeMediaTrackListeners(),(e=this._mediaTrack)==null||e.stop(),this._mediaTrack=void 0,(r=this.transformedMediaTrack)==null||r.stop(),this.transformedMediaTrack=void 0}get mediaTrack(){return this._mediaTrack}async setMediaTrack(e){const r=n=>{p.error(`${this.constructorName}.setMediaTrack.error`,{error:n})};try{this.disableTrack()}catch(n){r(n)}this._mediaTrack=await this.conditionallyChangeTrack(e),await this.setTransformedTrack();try{this.addMediaTrackListeners(),await this.setCurrentDevice()}catch(n){r(n)}}get trackEnabled(){return!!this.mediaTrack&&this.mediaTrack.readyState==="live"&&this.mediaTrack.enabled}muteTrack(){if(!this.mediaTrack){p.warn("BaseMediaHandler.muteTrack Tried muting with no track present");return}this.transformedMediaTrack&&(this.transformedMediaTrack.enabled=!1),this.mediaTrack.enabled=!1}async unmuteTrack(){try{this.mediaTrack?this.mediaTrack.enabled=!0:await this.enableTrack(!1)}catch(e){throw p.error(`${this.constructorName}.unmuteTrack.error`,{error:e}),this.disableTrack(),new E("Failed to unmute track")}}async setCurrentDevice(){var e;if(!this.mediaTrack){this.currentDevice=void 0;return}((e=this.currentDevice)==null?void 0:e.deviceId)!==this.mediaTrack.getSettings().deviceId&&(this.currentDevice=await this.mediaInterface.getDevice(this.mediaTrack.getSettings().deviceId))}async addMiddleware(e){if(le.isWebKitBased()&&!ie.hasFeature(se.ALLOW_SAFARI_MEDIA_MIDDLEWARES))return{success:!1,message:"Middlewares are not supported in this WebKit engine based browser."};if(this.middlewares.includes(e))return{success:!1,message:"This middleware has been applied, already. Skipping."};try{return this.middlewares.push(e),this.trackEnabled&&await this.setTransformedTrack(),{success:!0,message:"Successfully added the middleware."}}catch(r){return p.error("While adding middleware",{error:r}),this.removeMiddleware(e),{success:!1,message:r==null?void 0:r.message}}}async removeMiddleware(e){const r=this.middlewares.indexOf(e,0);if(r>-1)try{return this.middlewares.splice(r,1),await this.setTransformedTrack(!0),{success:!0,message:"Successfully removed the middleware."}}catch(n){return p.error("While removing middleware",{error:n}),{success:!1,message:n==null?void 0:n.message}}return{success:!1,message:"No such middleware was found. Skipping."}}addMediaTrackListeners(){var e,r,n;this.mediaTrack&&(p.info(`${this.constructorName}.addMediaTrackListeners for deviceId ${(r=(e=this.mediaTrack)==null?void 0:e.getSettings())==null?void 0:r.deviceId} of type ${(n=this.mediaTrack)==null?void 0:n.kind}`),this.mediaTrack.addEventListener("ended",this.onTrackEnded),this.mediaTrack.addEventListener("mute",this.onTrackMuted))}removeMediaTrackListeners(){var e,r,n;this.mediaTrack&&(p.info(`${this.constructorName}.removeMediaTrackListeners for deviceId ${(r=(e=this.mediaTrack)==null?void 0:e.getSettings())==null?void 0:r.deviceId} of type ${(n=this.mediaTrack)==null?void 0:n.kind}`),p.info(`${this.constructorName}.removeMediaTrackListeners`),this.mediaTrack.removeEventListener("ended",this.onTrackEnded),this.mediaTrack.removeEventListener("mute",this.onTrackMuted))}};Fo=xD([xe(t=>{throw new E(t.message,"1600")})],Fo);const Rp=Fo;var LD=Object.defineProperty,$D=Object.getOwnPropertyDescriptor,nd=(t,e,r,n)=>{for(var i=n>1?void 0:n?$D(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&LD(e,r,i),i};const co="[Dyte]nonSilentDeviceLabels";class ba extends Rp{async setDevice(e){if(!e)throw p.warn("AudioMediaHandler.setDevice No device received"),new E("No device received!","1603");if(e.kind!=="audioinput")throw p.warn("AudioMediaHandler.setDevice Received non audio device"),new E("Non audio device received while setting device!","1603");try{const r=this.trackEnabled;this.userSelectedDevice=e.deviceId,await this.setMediaTrack(await this.mediaInterface.getAudioTrack(!r,e.deviceId))}catch(r){throw p.error("AudioMediaHandler.setDevice.error",{error:r}),this.disableTrack(),new E(r.message,"1604")}}async enableTrack(e){if(this.trackEnabled){p.warn("AudioMediaHandler.enableTrack Track already enabled!");return}const r=await this.mediaInterface.getAudioTrack(e,this.userSelectedDevice);await this.setMediaTrack(r)}async setTransformedTrack(e){var r;if(!e&&!((r=this.middlewares)!=null&&r.length)){this.transformedMediaTrack=this.mediaTrack;return}try{this.transformedMediaTrack=await OD(this.middlewares,this.mediaTrack),this.emit("trackChanged")}catch(n){p.error("AudioMediaHandler.setTransformedTrack",{error:n}),this.transformedMediaTrack=this.mediaTrack}}async onTrackEnded(){p.info("AudioMediaHandler.TrackEnded"),this.emit("trackEnded");const e=this.mediaTrack.enabled;this.disableTrack(),await this.enableTrack(!e),await this.setTransformedTrack(),this.emit("trackChanged")}onTrackMuted(){p.info("AudioMediaHandler.TrackMuted"),this.emit("trackMuted")}async conditionallyChangeTrack(e){var o;if(!e||this.userSelectedDevice)return e;let r=e;const n=await this.mediaInterface.getAudioInputDevices(),i=this.isNonPreferredDevice?n.filter(c=>c&&!this.isNonPreferredDevice(c)):n;if(!(i!=null&&i.length))return r;i.find(c=>c.deviceId===e.getSettings().deviceId)||(r.stop(),p.info("localmediahandler::setupstreams::found_audio_non_preferred"),r=await this.mediaInterface.getAudioTrack(!1,i[0].deviceId));const s=JSON.parse(er.getItem(co));if(s!=null&&s.devices.some(c=>c.label===r.label))return r;if(!await Cs(r)){const c=(o=s==null?void 0:s.devices.concat({label:r.label}))!=null?o:[{label:r.label}];return er.setItem(co,JSON.stringify({devices:c})),r}p.info("AudioMediaHandler.conditionallyChangeTrack.DetectedSilentTrack");const a=r.getSettings().deviceId;return i.filter(c=>c.deviceId!==a).some(async c=>{if(r=await this.mediaInterface.getAudioTrack(!1,c.deviceId),!await Cs(r)){const u=s.devices.concat({label:r.label});return er.setItem(co,JSON.stringify({devices:u})),p.info("AudioMediaHandler.conditionallyChangeTrack.SuccesfullyChangedTrack"),!0}return p.info("AudioMediaHandler.conditionallyChangeTrack.AnotherSilentTrackFound"),!1}),r}}nd([v.trace("AudioMediaHandler.setTransformedTrack")],ba.prototype,"setTransformedTrack",1);nd([v.trace("AudioMediaHandler.onTrackEnded")],ba.prototype,"onTrackEnded",1);nd([v.trace("AudioMediaHandler.conditionallyChangeTrack")],ba.prototype,"conditionallyChangeTrack",1);let uo=class extends Error{constructor(r,n,i){super(n);g(this,"constraints");g(this,"name");this.name=r,this.constraints=i}};function ka(t,e,r){if(le.isChromiumBased()){if(e==="NotAllowedError")return r.indexOf("by system")>0?"SYSTEM_DENIED":t==="screenshare"?"CANCELED":"DENIED";if(e==="NotReadableError")return"COULD_NOT_START"}else if(le.isSafari()){if(e==="NotAllowedError")return"DENIED"}else if(le.isFirefox()){if(e==="NotFoundError"||e==="NotReadableError")return"SYSTEM_DENIED";if(e==="NotAllowedError")return"DENIED";if(e==="AbortError")return"COULD_NOT_START"}return"COULD_NOT_START"}class UD{constructor(){g(this,"permissions");this.permissions={audio:"NOT_REQUESTED",video:"NOT_REQUESTED",screenshare:"NOT_REQUESTED"}}async getAudioInputDevices(){return(await this.getAvailableDevices()).filter(r=>r.kind==="audioinput")}async getVideoInputDevices(){return(await this.getAvailableDevices()).filter(r=>r.kind==="videoinput")}async getAudioOutputDevices(){return(await this.getAvailableDevices()).filter(r=>r.kind==="audiooutput")}}var FD=Object.defineProperty,VD=Object.getOwnPropertyDescriptor,Ot=(t,e,r,n)=>{for(var i=n>1?void 0:n?VD(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&FD(e,r,i),i},en,Ln,Nt,pl;let lt=(pl=class extends UD{constructor(e){super();S(this,en,void 0);S(this,Ln,void 0);S(this,Nt,void 0);w(this,Nt,new Ap(e)),w(this,Ln,new AbortController),this.getAvailableDevices()}get constraintsBuilder(){return d(this,Nt)}async destruct(){var e;(e=d(this,Ln))==null||e.abort()}handlePermissionErrors(e,r){const n=ka(e,r.name,r.message);this.permissions[e]=n,P.emit(I.MEDIA_PERMISSION_ERROR,{message:n,constraints:r.constraints,kind:e})}async getAudioAndVideoTrack(){const e={audio:d(this,Nt).getAudioConstraints().audio,video:d(this,Nt).getVideoConstraints().video};try{p.info("getUserMediaWithoutTimeout::requesting_user_media",{constraints:JSON.stringify(e)});const r=await navigator.mediaDevices.getUserMedia(e);p.info("getUserMediaWithoutTimeout::received_user_media",{constraints:JSON.stringify(e)});const n=r.getAudioTracks()[0];let i=r.getVideoTracks()[0];if(this.permissions.audio="ACCEPTED",this.permissions.video="ACCEPTED",ie.hasFeature(se.OBS_QUALITY)&&i.label.includes("OBS Virtual")){const o=(await this.getVideoInputDevices()).find(c=>c.label.includes("OBS Virtual"));i=await this.getVideoTrack(o.deviceId)}return P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.audio,kind:"audio"}),P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.video,kind:"video"}),{audioTrack:n,videoTrack:i}}catch(r){throw p.error("WebMediaInterface.getAudioAndVideoTrack",{error:r}),new E("Couldnt fetch audio and video track")}}async getAudioTrack(e,r){const n=d(this,Nt).getAudioConstraints(r);try{p.info("getUserMediaWithoutTimeout::requesting_user_media",{constraints:JSON.stringify(n)});const i=(await navigator.mediaDevices.getUserMedia(n)).getAudioTracks()[0];return p.info("getUserMediaWithoutTimeout::received_user_media",{constraints:JSON.stringify(n)}),i.enabled=!e,this.permissions.audio="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.audio,kind:"audio"}),i}catch(i){throw this.handlePermissionErrors("audio",new uo(i.name,i.message,n)),new E(i.message,"1601")}}async getScreenShareTracks(){const e=d(this,Nt).getScreenShareConstraints();try{p.info("getDisplayMediaWithoutTimeout::requesting_display_media",{constraints:JSON.stringify(e)});const r=await navigator.mediaDevices.getDisplayMedia(e);return p.info("getDisplayMediaWithoutTimeout::received_display_media",{constraints:JSON.stringify(e)}),this.permissions.screenshare="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.screenshare,kind:"screenshare"}),{audioTrack:r.getAudioTracks()[0],videoTrack:r.getVideoTracks()[0]}}catch(r){throw this.handlePermissionErrors("screenshare",new uo(r.name,r.message,e)),p.error("WebMediaInterface.getScreenShareTracks Error while fetching screenshare tracks",{error:r}),new E("Couldnt fetch screen share tracks")}}async getCurrentDeviceLabel(e){const r=await this.getDevice(e||"default");return r==null?void 0:r.label}async getVideoTrack(e){const r=ie.hasFeature(se.OBS_QUALITY),n=await this.getCurrentDeviceLabel(e),i=n&&n.includes("OBS Virtual"),{video:s}=d(this,Nt).getVideoConstraints(e);let a={};r&&i&&typeof s!="boolean"?a={deviceId:s.deviceId}:a=s;try{const o=(await navigator.mediaDevices.getUserMedia({video:a})).getVideoTracks()[0];if(r&&i&&typeof s!="boolean"&&typeof s.width=="object"){const{width:c,height:u}=o.getSettings(),{ideal:h}=s.width;o.applyConstraints({width:{ideal:h},height:{ideal:Math.floor(u*h/c)},frameRate:s.frameRate})}return this.permissions.video="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.video,kind:"video"}),o}catch(o){throw this.handlePermissionErrors("video",new uo(o.name,o.message,a)),p.error("WebMediaInterface.getVideoTrack Error while fetching video track",{error:o}),new E("Couldnt fetch video track")}}async getAvailableDevices(){try{return await navigator.mediaDevices.enumerateDevices()}catch(e){throw p.error("enumerate_devices_failed",{error:e}),new E("Failed to get available devices")}}async getAvailableDevicesByKind(e){try{return(await navigator.mediaDevices.enumerateDevices()).filter(({kind:r})=>e===r)}catch(r){throw p.error("enumerate_devices_failed",{error:r}),new E("Failed to get available devices by kind")}}async getDevice(e){try{return(await navigator.mediaDevices.enumerateDevices()).filter(n=>n.deviceId===e)[0]}catch(r){throw p.error("enumerate_devices_failed",{error:r}),new E("Failed to get device")}}async onDeviceChange(e){var r;if(!((r=d(this,en))!=null&&r.length)){const n=await this.getAvailableDevices();n!=null&&n.length&&(w(this,en,n),e(null,{added:n,removed:[]},!0))}le.supportsDeviceChangeEvent()&&navigator.mediaDevices.addEventListener("devicechange",ga(async n=>{var u,h;const i=d(this,en),s=new Set(i.map(f=>f.deviceId)),a=await this.getAvailableDevices(),o=new Set(a.map(f=>f.deviceId)),c={added:a.filter(f=>!s.has(f.deviceId)),removed:i.filter(f=>!o.has(f.deviceId))};w(this,en,a),((u=c.added)!=null&&u.length||(h=c.removed)!=null&&h.length)&&e(n,c,!1)},100),{signal:d(this,Ln).signal})}},en=new WeakMap,Ln=new WeakMap,Nt=new WeakMap,pl);Ot([v.trace("WebMediaInterface.destruct")],lt.prototype,"destruct",1);Ot([v.trace("WebMediaInterface.handlePermissionErrors")],lt.prototype,"handlePermissionErrors",1);Ot([v.trace("WebMediaInterface.getAudioAndVideoTrack")],lt.prototype,"getAudioAndVideoTrack",1);Ot([v.trace("WebMediaInterface.getAudioTrack")],lt.prototype,"getAudioTrack",1);Ot([v.trace("WebMediaInterface.getScreenShareTracks")],lt.prototype,"getScreenShareTracks",1);Ot([v.trace("WebMediaInterface.getVideoTrack")],lt.prototype,"getVideoTrack",1);Ot([v.trace("WebMediaInterface.getAvailableDevices")],lt.prototype,"getAvailableDevices",1);Ot([v.trace("WebMediaInterface.getAvailableDevicesByKind")],lt.prototype,"getAvailableDevicesByKind",1);Ot([v.trace("WebMediaInterface.getDevice")],lt.prototype,"getDevice",1);Ot([v.trace("WebMediaInterface.onDeviceChange")],lt.prototype,"onDeviceChange",1);lt=Ot([xe(t=>{throw new E(t.message,"1600")})],lt);const id=lt;var $n;class BD{constructor(e){S(this,$n,void 0);g(this,"currentDevice");w(this,$n,e)}async setupSpeaker(e){var n,i;if(!(d(this,$n)instanceof id))return;let r=e;if(e||([r]=await d(this,$n).getAvailableDevicesByKind("audiooutput")),!r)throw new E("No speaker found");((n=this.currentDevice)==null?void 0:n.deviceId)!==r.deviceId&&((i=this.currentDevice)!=null||(this.currentDevice=r),document.querySelectorAll("audio").forEach(async s=>{if(typeof s.sinkId!="undefined"&&this.currentDevice.deviceId&&s.sinkId!==this.currentDevice.deviceId)try{await s.setSinkId(this.currentDevice.deviceId)}catch(a){}}))}}$n=new WeakMap;class GD extends wr{constructor(r){super();g(this,"mediaInterface");g(this,"audioMediaTrack");g(this,"videoMediaTrack");this.mediaInterface=r}get trackEnabled(){return!!this.videoMediaTrack}async enableScreenShare(){var i,s;const{audioTrack:r,videoTrack:n}=await this.mediaInterface.getScreenShareTracks();this.audioMediaTrack=r,this.videoMediaTrack=n,this.addMediaTrackListeners(),((s=(i=this.mediaInterface)==null?void 0:i.permissions)==null?void 0:s.screenshare)!=="ACCEPTED"&&this.mediaInterface.permissions&&(this.mediaInterface.permissions.screenshare="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.mediaInterface.permissions.screenshare,kind:"screenshare"}))}disableScreenShare(){var r,n;this.removeMediaTrackListeners(),(r=this.audioMediaTrack)==null||r.stop(),(n=this.videoMediaTrack)==null||n.stop(),this.videoMediaTrack=void 0,this.audioMediaTrack=void 0}async updateConstraints(r){if(!this.videoMediaTrack)throw new E("No media track enabled!");const n=this.mediaInterface;if(!n.constraintsBuilder)throw new E("update constraints not supported for non web clients","1100");try{this.videoMediaTrack.applyConstraints(n.constraintsBuilder.getUpdatedVideoConstraints(r)),this.addMediaTrackListeners()}catch(i){p.error("ScreenShareHandler.updateConstraints.error",{error:i})}}addMediaTrackListeners(){var r;(r=this.videoMediaTrack)==null||r.addEventListener("ended",this.onTrackEnded.bind(this))}removeMediaTrackListeners(){var r;(r=this.videoMediaTrack)==null||r.removeEventListener("ended",this.onTrackEnded)}onTrackEnded(){this.emit("trackEnded")}}var tn;class qD{constructor(){S(this,tn,void 0)}terminateMiddlewareWebWorker(){if(d(this,tn))try{_s.clearInterval(d(this,tn)),w(this,tn,void 0)}catch(e){p.debug("WorkerTimers::terminateMiddlewareWebWorker::failed")}}async getTransformedVideoTrack(e,r){if(!(e!=null&&e.length))return r;const n=await Promise.all(e==null?void 0:e.map(h=>h())),i=new MediaStream;i.addTrack(r);const s=document.createElement("canvas"),a=s.getContext("2d"),o=document.createElement("video");o.srcObject=i,o.autoplay=!0,this.terminateMiddlewareWebWorker();const c=async()=>{if(r.enabled===!1||r.readyState==="ended"){this.terminateMiddlewareWebWorker(),o.remove(),s.remove();return}try{a.drawImage(o,0,0);for(let h=0;h<n.length;h+=1)await n[h](s,a)}catch(h){p.error("getTransformedVideoTrack::middleware_execution_failed",{error:h})}};try{o.play()}catch(h){}return o.addEventListener("play",()=>{s.width=o.width||r.getSettings().width,s.height=o.width||r.getSettings().height,w(this,tn,_s.setInterval(c,50))},!1),s.captureStream().getVideoTracks()[0]}}tn=new WeakMap;var HD=Object.defineProperty,WD=Object.getOwnPropertyDescriptor,sd=(t,e,r,n)=>{for(var i=n>1?void 0:n?WD(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&HD(e,r,i),i},Un;class Ca extends Rp{constructor(r,n,i){super(r,n,i);S(this,Un,void 0);w(this,Un,new qD)}async setDevice(r){if(!r)throw p.warn("VideoMediaHandler.setDevice No device received"),new E("No device received!");if(r.kind!=="videoinput")throw p.warn("VideoMediaHandler.setDevice Received non video device",{devices:[r]}),new E("Non video device received while setting video device!");if(this.userSelectedDevice=r.deviceId,!(this.mediaTrack&&this.mediaTrack.enabled)){p.warn("VideoMediaHandler.setDevice Tried switching device with video disabled",{devices:[r]}),this.currentDevice=r;return}try{await this.setMediaTrack(await this.mediaInterface.getVideoTrack(this.userSelectedDevice))}catch(n){throw p.error("VideoMediaHandler.setDevice.error",{error:n}),this.disableTrack(),new E("Failed to change device")}}async enableTrack(){if(this.trackEnabled){p.warn("VideoMediaHandler.enableTrack Track already enabled!");return}await this.setMediaTrack(await this.mediaInterface.getVideoTrack(this.userSelectedDevice))}async setTransformedTrack(r){var n;if(!r&&!((n=this.middlewares)!=null&&n.length)){this.transformedMediaTrack=this.mediaTrack;return}try{this.transformedMediaTrack=await d(this,Un).getTransformedVideoTrack(this.middlewares,this.mediaTrack),this.emit("trackChanged")}catch(i){p.error("VideoMediaHandler.setTransformedTrack",{error:i}),this.transformedMediaTrack=this.mediaTrack}}async updateConstraints(r){if(!this._mediaTrack)throw new E("No media track enabled!");const n=this.mediaInterface;if(!n.constraintsBuilder)throw new E("update constraints not supported for non web clients","1100");try{this._mediaTrack.applyConstraints(n.constraintsBuilder.getUpdatedVideoConstraints(r)),await this.setTransformedTrack(),this.addMediaTrackListeners(),await this.setCurrentDevice()}catch(i){p.error("VideoMediaHandler.updateConstraints.error",{error:i})}}terminateMiddlewareWebWorker(){d(this,Un).terminateMiddlewareWebWorker()}async onTrackEnded(){p.info("VideoMediaHandler.TrackEnded"),this.disableTrack(),this.emit("trackEnded")}onTrackMuted(){p.info("VideoMediaHandler.TrackMuted"),this.emit("trackMuted")}async conditionallyChangeTrack(r){if(!r||this.userSelectedDevice)return r;let n=r;const i=await this.mediaInterface.getVideoInputDevices(),s=this.isNonPreferredDevice?i.filter(a=>!this.isNonPreferredDevice(a)):i;return!(s!=null&&s.length)||window.FAST_DYTE||s.find(a=>a.deviceId===r.getSettings().deviceId)||(n.stop(),p.info("localmediahandler::setupstreams::found_video_non_preferred"),n=await this.mediaInterface.getVideoTrack(s[0].deviceId)),n}}Un=new WeakMap;sd([v.trace("VideoMediaHandler.setTransformedTrack")],Ca.prototype,"setTransformedTrack",1);sd([v.trace("VideoMediaHandler.onTrackEnded")],Ca.prototype,"onTrackEnded",1);sd([v.trace("VideoMediaHandler.conditionallyChangeTrack")],Ca.prototype,"conditionallyChangeTrack",1);var jD=Object.defineProperty,KD=Object.getOwnPropertyDescriptor,ft=(t,e,r,n)=>{for(var i=n>1?void 0:n?KD(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&jD(e,r,i),i},Se,Oe,ke,Pr,mt,Si;class tt extends wr{constructor(r,n=Yu,i=!0){super();S(this,Se,void 0);S(this,Oe,void 0);S(this,ke,void 0);S(this,Pr,void 0);S(this,mt,void 0);S(this,Si,void 0);g(this,"audioUpdateInProgress");g(this,"videoUpdateInProgress");this.audioUpdateInProgress=!1,this.videoUpdateInProgress=!1,w(this,Se,new id(r)),w(this,Oe,new ba(d(this,Se),void 0,n)),w(this,ke,new Ca(d(this,Se),void 0,n)),w(this,mt,new GD(d(this,Se))),w(this,Pr,new BD(d(this,Se))),w(this,Si,i),d(this,Oe).on("trackMuted",this.onAudioTrackMuted.bind(this)),d(this,Oe).on("trackChanged",this.onAudioTrackChanged.bind(this)),d(this,ke).on("trackChanged",this.onVideoTrackChanged.bind(this)),d(this,ke).on("trackEnded",this.onVideoTrackEnded.bind(this)),d(this,mt).on("trackEnded",this.onScreenShareEnded.bind(this)),this.onVisibilityChange=this.onVisibilityChange.bind(this),document.addEventListener("visibilitychange",this.onVisibilityChange)}onVisibilityChange(){}async repopulateAvailableDevices(){return!0}async setupStreams({audio:r,video:n}){let i,s;if(r&&n)try{const a=await d(this,Se).getAudioAndVideoTrack();i=a.audioTrack,s=a.videoTrack}catch(a){p.error("LocalMediaHandler::init::Failed to get audio video tracks",{error:a})}if(!i&&r)try{i=await d(this,Se).getAudioTrack(!1)}catch(a){p.error("LocalMediaHandler::init::Failed to get audio track",{error:a})}if(!s&&n)try{s=await d(this,Se).getVideoTrack()}catch(a){p.error("LocalMediaHandler::init::Failed to get video track",{error:a})}await d(this,Oe).setMediaTrack(i),await d(this,ke).setMediaTrack(s);try{await d(this,Pr).setupSpeaker()}catch(a){}d(this,Se).onDeviceChange((a,o,c)=>{this.onDeviceChange(o,c)})}getCurrentDevices(){return{audio:d(this,Oe).currentDevice,video:d(this,ke).currentDevice,speaker:d(this,Pr).currentDevice}}get permissions(){return d(this,Se).permissions}getAllDevices(){return d(this,Se).getAvailableDevices()}getDeviceById(r,n){return d(this,Se).getDevice(r)}onAudioTrackMuted(){this.emit("AUDIO_TRACK_SILENT")}onAudioTrackChanged(){this.emit("AUDIO_TRACK_CHANGE")}get rawAudioTrack(){return d(this,Oe).mediaTrack}get audioTrack(){return d(this,Oe).transformedMediaTrack}get audioEnabled(){return d(this,Oe).trackEnabled}async enableAudio(){if(!this.audioUpdateInProgress){this.audioUpdateInProgress=!0;try{await d(this,Oe).unmuteTrack()}finally{this.audioUpdateInProgress=!1}}}disableAudio(){d(this,Oe).muteTrack()}getAudioDevices(){return d(this,Se).getAudioInputDevices()}async setAudioDevice(r){await d(this,Oe).setDevice(r),this.emit("AUDIO_TRACK_CHANGE"),this.emit("DEVICE_CHANGE",{device:r})}setupSpeaker(){return d(this,Pr).setupSpeaker()}async setSpeakerDevice(r){await d(this,Pr).setupSpeaker(r),this.emit("DEVICE_CHANGE",{device:r})}onVideoTrackChanged(){this.emit("VIDEO_TRACK_CHANGE")}onVideoTrackEnded(){this.emit("VIDEO_TRACK_CHANGE")}get rawVideoTrack(){return d(this,ke).mediaTrack}get videoTrack(){return d(this,ke).transformedMediaTrack}get videoEnabled(){return d(this,ke).trackEnabled}async enableVideo(){if(!this.videoUpdateInProgress){this.videoUpdateInProgress=!0;try{await d(this,ke).unmuteTrack()}finally{this.videoUpdateInProgress=!1}}}disableVideo(){d(this,ke).disableTrack()}getVideoDevices(){return d(this,Se).getVideoInputDevices()}async setVideoDevice(r){await d(this,ke).setDevice(r),this.emit("VIDEO_TRACK_CHANGE"),this.emit("DEVICE_CHANGE",{device:r})}async updateVideoConstraints(r){await d(this,ke).updateConstraints(r)}onScreenShareEnded(){this.emit("SCREENSHARE_ENDED")}get screenShareTracks(){return{audio:d(this,mt).audioMediaTrack,video:d(this,mt).videoMediaTrack}}get screenShareEnabled(){return d(this,mt).trackEnabled}async enableScreenShare(){await d(this,mt).enableScreenShare()}async disableScreenShare(){d(this,mt).disableScreenShare()}async updateScreenshareConstraints(r){await d(this,mt).updateConstraints(r)}getSpeakerDevices(){return d(this,Se).getAudioOutputDevices()}addAudioMiddleware(r){return d(this,Oe).addMiddleware(r)}removeAudioMiddleware(r){return d(this,Oe).removeMiddleware(r)}addVideoMiddleware(r){return d(this,ke).addMiddleware(r)}removeVideoMiddleware(r){return d(this,ke).removeMiddleware(r)}destruct(){d(this,Oe).disableTrack(),d(this,ke).disableTrack(),d(this,ke).terminateMiddlewareWebWorker(),d(this,mt).disableScreenShare(),d(this,Se).destruct()}async onDeviceChange(r,n){var s;const i=await d(this,Se).getAvailableDevices();p.info("repopulated_full_device_list",{devices:JSON.stringify(i)}),this.emit("DEVICE_LIST_UPDATED",r),!(n||!d(this,Si))&&((s=r==null?void 0:r.added)==null||s.forEach(async a=>{var o;a&&!Yu(a)&&(a.kind==="audioinput"&&((o=this.audioTrack)==null?void 0:o.enabled)===!0?await this.setAudioDevice(a):a.kind==="audiooutput"&&await this.setSpeakerDevice(a))}))}removeAllTracks(){this.destruct()}async removeDocumentEventListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}}Se=new WeakMap,Oe=new WeakMap,ke=new WeakMap,Pr=new WeakMap,mt=new WeakMap,Si=new WeakMap;ft([v.trace("MediaHandler.setupStreams")],tt.prototype,"setupStreams",1);ft([v.trace("MediaHandler.enableAudio")],tt.prototype,"enableAudio",1);ft([v.trace("MediaHandler.disableAudio")],tt.prototype,"disableAudio",1);ft([v.trace("MediaHandler.setAudioDevice")],tt.prototype,"setAudioDevice",1);ft([v.trace("MediaHandler.enableVideo")],tt.prototype,"enableVideo",1);ft([v.trace("MediaHandler.disableVideo")],tt.prototype,"disableVideo",1);ft([v.trace("MediaHandler.setVideoDevice")],tt.prototype,"setVideoDevice",1);ft([v.trace("MediaHandler.updateVideoConstraints")],tt.prototype,"updateVideoConstraints",1);ft([v.trace("MediaHandler.enableScreenShare")],tt.prototype,"enableScreenShare",1);ft([v.trace("MediaHandler.disableScreenShare")],tt.prototype,"disableScreenShare",1);ft([v.trace("MediaHandler.updateScreenshareConstraints")],tt.prototype,"updateScreenshareConstraints",1);ft([v.trace("MediaHandler.destruct")],tt.prototype,"destruct",1);ft([v.trace("MediaHandler.onDeviceChange")],tt.prototype,"onDeviceChange",1);class JD extends Error{constructor(r,n){super(r);g(this,"code");this.code=n}}class In extends Error{constructor(r,n,i){super(n);g(this,"constraints");g(this,"name");this.name=r,this.constraints=i}}var YD=Object.defineProperty,zD=Object.getOwnPropertyDescriptor,yr=(t,e,r,n)=>{for(var i=n>1?void 0:n?zD(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&YD(e,r,i),i};const lo={port:void 0},XD=["virtual","emulator","krisp","solstice conference","teams","manycam","blackHole"];function Yr(t){const e=t.label.toLowerCase();return le._bowser.getOSName()==="macOS"&&e.includes("iphone")?(p.log("isVirtualDevice::ignore_macos_continuity"),!0):XD.some(r=>e.includes(r))}var nr,Fn,ml;const Sr=(ml=class{constructor(t){S(this,nr,void 0);S(this,Fn,void 0);w(this,nr,t),w(this,Fn,new AbortController)}static async init(){let t=[];return Sr.isDeviceListAvailable()?(t=await Sr.enumerateDevices(),p.info("initial_full_device_list",{devices:JSON.stringify(t)})):p.error("UnsupportedMediaAPI::navigator.mediaDevices.enumerateDevices",{debuggingHint:"Try checking meetingMetadata.visitedUrl. It should be running on localhost/127.0.0.1 or HTTPS, if not, there would be issues."}),new Sr(t)}async destruct(){var t;(t=d(this,Fn))==null||t.abort()}static isDeviceListAvailable(){return!!(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)}static enumerateDevices(){try{return navigator.mediaDevices.enumerateDevices()}catch(t){return p.error("enumerate_devices_failed",{error:t}),Promise.resolve([])}}static getAudioConstraints(t){const e={},{disableAP:r=!1,disableAEC:n=!1,disableNS:i=!1,disableAGC:s=!1,disableHPF:a=!1}=t.audioOptions||{};if(le.isFirefox()||le.isWebKitBased())e.audio={deviceId:t.audioDeviceId,autoGainControl:!s&&!r,echoCancellation:!n&&!r,noiseSuppression:!i&&!r};else{if(typeof e.audio=="boolean")return e;e.audio={},e.audio.optional=[t.audioDeviceId?{sourceId:t.audioDeviceId}:{sourceId:"default"},{echoCancellation:!n&&!r},{googEchoCancellation:!n&&!r},{googAutoGainControl:!s&&!r},{googNoiseSuppression:!i&&!r},{googHighpassFilter:!a&&!r},{googNoiseSuppression2:!i&&!r},{googEchoCancellation2:!n&&!r},{googAutoGainControl2:!s&&!r}]}return e}static getVideoConstraints(t){const e={},{videoDeviceId:r,videoTrackConstraints:n,facingMode:i="user",frameRate:s={ideal:24,max:30}}=t;return e.video=n||Lo.vga,typeof e.video=="boolean"||(r&&(e.video.deviceId={exact:r}),e.video.facingMode=i,e.video.frameRate=s),e}static async getUserMediaWithTimeout(t={},e=0){try{if(p.info("getUserMediaWithTimeout::requesting_user_media",{timeout:e,constraints:JSON.stringify(t)}),!e){const n=await navigator.mediaDevices.getUserMedia(t);return p.info("getUserMediaWithTimeout::received_user_media",{timeout:e,constraints:JSON.stringify(t)}),n}const r=await Promise.race([navigator.mediaDevices.getUserMedia(t),new Promise((n,i)=>{setTimeout(()=>i(new JD("Get user media timed out","ERR_GUM_TIMEOUT")),e)})]);return p.info("getUserMediaWithTimeout::received_user_media",{timeout:e,constraints:JSON.stringify(t)}),r}catch(r){throw p.error("getUserMediaWithTimeout::failed_to_access_local_media",{error:r,constraints:JSON.stringify(t)}),p.error("Failed to get access to local media.",{error:r,constraints:JSON.stringify(t)}),new In(r.name,r.message,t)}}static async getAudioTrack(t){return(await Sr.getUserMediaWithTimeout(t)).getAudioTracks()[0]}static async getVideoTrack(t){return(await Sr.getUserMediaWithTimeout(t)).getVideoTracks()[0]}static async getScreenShareTracks(t){var s,a;let e=ie.hasFeature(se.EXTENSION_HACK),r=null;if(e)try{lo.port=window.chrome.runtime.connect("nkeimhogjdpnpccoofpliimaahmaaome",{name:"chooseDesktopMedia"})}catch(o){v.addLogInCurrentSpan("error","Extension connect error"),e=!1}e&&(r=await new Promise(o=>{const c=setTimeout(()=>o(void 0),12e3);lo.port.onMessage.addListener(async u=>{if(u.value.streamId){const{streamId:h}=u.value;clearTimeout(c),o(h)}}),lo.port.postMessage({method:"chooseDesktopMedia",sources:["screen"]})}));let n;return r?(v.addLogInCurrentSpan("error","Acquiring extension screenshare track"),n=await navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{maxWidth:1920,maxHeight:1080,chromeMediaSource:"desktop",chromeMediaSourceId:r},optional:[{maxFrameRate:parseInt((s=ie.getValue(se.VAL_MAX_FRAMERATE_EXT))!=null?s:"12",10)},{minFrameRate:parseInt((a=ie.getValue(se.VAL_MIN_FRAMERATE_EXT))!=null?a:"8",10)}]}}),v.addLogInCurrentSpan("error","Acquired extension screenshare track")):n=await navigator.mediaDevices.getDisplayMedia(t),{video:n.getVideoTracks()[0],audio:n.getAudioTracks()[0]}}static async getAudioAndVideoTrack(t){const e=await Sr.getUserMediaWithTimeout(t),r=e.getAudioTracks()[0],n=e.getVideoTracks()[0];return{audioTrack:r,videoTrack:n}}onDeviceChange(t){le.supportsDeviceChangeEvent()&&navigator.mediaDevices.addEventListener("devicechange",ga(async e=>{const r=this.availableDevices,n=new Set(r.map(o=>o.deviceId));await this.repopulateAvailableDevices();const i=this.availableDevices,s=new Set(i.map(o=>o.deviceId)),a={added:i.filter(o=>!n.has(o.deviceId)),removed:r.filter(o=>!s.has(o.deviceId))};this.repopulateAvailableDevices().then(()=>t(e,a))},100),{signal:d(this,Fn).signal})}async repopulateAvailableDevices(){let t=await Sr.enumerateDevices();t=t.map(r=>r.toJSON()),!Vc(cp(t,d(this,nr),If))&&(w(this,nr,t),p.info("repopulated_full_device_list",{devices:JSON.stringify(t)}))}get availableDevices(){return d(this,nr)}getAvailableDevicesByKind(t){return d(this,nr).filter(e=>e.kind===t)}getDeviceById(t,e){return d(this,nr).find(r=>r.deviceId===t&&r.kind===e)}getAudioDevices(){return this.getAvailableDevicesByKind("audioinput").sort((t,e)=>{const r=Yr(t)?0:1;return(Yr(e)?0:1)-r})}getVideoDevices(){return this.getAvailableDevicesByKind("videoinput").sort((t,e)=>{const r=Yr(t)?0:1;return(Yr(e)?0:1)-r})}getSpeakerDevices(){return this.getAvailableDevicesByKind("audiooutput").sort((t,e)=>{const r=Yr(t)?0:1;return(Yr(e)?0:1)-r})}},nr=new WeakMap,Fn=new WeakMap,ml);let Ce=Sr;yr([v.trace("LocalMediaUtils.onDeviceChange")],Ce.prototype,"onDeviceChange",1);yr([v.trace("LocalMediaUtils.repopulateAvailableDevices")],Ce.prototype,"repopulateAvailableDevices",1);yr([v.trace("LocalMediaUtils.isDeviceListAvailable")],Ce,"isDeviceListAvailable",1);yr([v.trace("LocalMediaUtils.enumerateDevices")],Ce,"enumerateDevices",1);yr([v.trace("LocalMediaUtils.getUserMediaWithTimeout")],Ce,"getUserMediaWithTimeout",1);yr([v.trace("LocalMediaUtils.getAudioTrack")],Ce,"getAudioTrack",1);yr([v.trace("LocalMediaUtils.getVideoTrack")],Ce,"getVideoTrack",1);yr([v.trace("LocalMediaUtils.getScreenShareTracks")],Ce,"getScreenShareTracks",1);yr([v.trace("LocalMediaUtils.getAudioAndVideoTrack")],Ce,"getAudioAndVideoTrack",1);var QD=Object.defineProperty,ZD=Object.getOwnPropertyDescriptor,si=(t,e,r,n)=>{for(var i=n>1?void 0:n?ZD(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&QD(e,r,i),i},we,rn;class En{constructor(e){S(this,we,void 0);g(this,"audioMiddlewares",[]);g(this,"videoMiddlewares",[]);S(this,rn,void 0);w(this,we,e)}terminateMiddlewareWebWorker(){if(d(this,rn))try{_s.clearInterval(d(this,rn)),w(this,rn,void 0)}catch(e){p.debug("WorkerTimers::terminateMiddlewareWebWorker::failed")}}async getTransformedVideoTrack(e){var u,h;if(!((u=this.videoMiddlewares)!=null&&u.length))return e;const r=await Promise.all((h=this.videoMiddlewares)==null?void 0:h.map(f=>f())),n=new MediaStream;n.addTrack(e);const i=document.createElement("canvas"),s=i.getContext("2d"),a=document.createElement("video");a.srcObject=n,a.autoplay=!0,this.terminateMiddlewareWebWorker();const o=async()=>{if(!d(this,we).videoEnabled||e.readyState==="ended"){this.terminateMiddlewareWebWorker(),a.remove(),i.remove();return}try{s.drawImage(a,0,0);for(let f=0;f<r.length;f+=1)await r[f](i,s)}catch(f){p.error("getTransformedVideoTrack::middleware_execution_failed",{error:f})}};try{a.play()}catch(f){}return a.addEventListener("play",()=>{i.width=a.width||e.getSettings().width,i.height=a.width||e.getSettings().height,w(this,rn,_s.setInterval(o,50))},!1),i.captureStream().getVideoTracks()[0]}async addVideoMiddleware(e){return le.isWebKitBased()&&!ie.hasFeature(se.ALLOW_SAFARI_MEDIA_MIDDLEWARES)?{success:!1,message:"Video middlewares are not supported in this WebKit engine based browser."}:this.videoMiddlewares.includes(e)?{success:!0,message:"This video middleware has been applied, already. Skipping."}:(this.videoMiddlewares.push(e),d(this,we).videoEnabled?(d(this,we).setVideoTrack(await this.getTransformedVideoTrack(d(this,we).rawVideoTrack)),d(this,we).emit("VIDEO_TRACK_CHANGE"),{success:!0,message:"Successfully applied the video middleware."}):{success:!0,message:"Successfully added the video middleware. It will be applied automatically once webcam is turned on."})}async removeVideoMiddleware(e){const r=this.videoMiddlewares.indexOf(e,0);return r>-1?(this.videoMiddlewares.splice(r,1),d(this,we).videoEnabled&&(d(this,we).setVideoTrack(await this.getTransformedVideoTrack(d(this,we).rawVideoTrack)),d(this,we).emit("VIDEO_TRACK_CHANGE")),{success:!0,message:"Successfully removed the video middleware."}):{success:!0,message:"No such video middleware was found. Skipping."}}async getTransformedAudioTrack(e){var a,o;if(!((a=this.audioMiddlewares)!=null&&a.length))return e;const r=new AudioContext,n=await Promise.all((o=this.audioMiddlewares)==null?void 0:o.map(c=>c(r))),i=r.createMediaStreamSource(new MediaStream([e])),s=r.createMediaStreamDestination();try{let c=i;for(let u=0;u<n.length;u+=1)c.connect(n[u]),c=n[u];c.connect(s)}catch(c){return p.error("getTransformedAudioTrack::middleware_execution_failed",{error:c}),e}return s.stream.getAudioTracks()[0]}async addAudioMiddleware(e){return le.isWebKitBased()&&!ie.hasFeature(se.ALLOW_SAFARI_MEDIA_MIDDLEWARES)?{success:!1,message:"Audio middlewares are not supported in this WebKit engine based browser."}:this.audioMiddlewares.includes(e)?{success:!0,message:"This audio middleware has been applied, already. Skipping."}:(this.audioMiddlewares.push(e),d(this,we).audioEnabled?(d(this,we).setAudioTrack(await this.getTransformedAudioTrack(d(this,we).rawAudioTrack)),d(this,we).emit("AUDIO_TRACK_CHANGE"),{success:!0,message:"Successfully applied the audio middleware."}):{success:!0,message:"Successfully added the audio middleware. It will be applied automatically once mic is turned on."})}async removeAudioMiddleware(e){const r=this.audioMiddlewares.indexOf(e,0);return r>-1?(this.audioMiddlewares.splice(r,1),d(this,we).audioEnabled&&(d(this,we).setAudioTrack(await this.getTransformedAudioTrack(d(this,we).rawAudioTrack)),d(this,we).emit("AUDIO_TRACK_CHANGE")),{success:!0,message:"Successfully removed the audio middleware."}):{success:!0,message:"No such audio middleware was found. Skipping."}}}we=new WeakMap,rn=new WeakMap;si([v.trace("MediaMiddlewareUtils.getTransformedVideoTrack")],En.prototype,"getTransformedVideoTrack",1);si([v.trace("MediaMiddlewareUtils.addVideoMiddleware")],En.prototype,"addVideoMiddleware",1);si([v.trace("MediaMiddlewareUtils.removeVideoMiddleware")],En.prototype,"removeVideoMiddleware",1);si([v.trace("MediaMiddlewareUtils.getTransformedAudioTrack")],En.prototype,"getTransformedAudioTrack",1);si([v.trace("MediaMiddlewareUtils.addAudioMiddleware")],En.prototype,"addAudioMiddleware",1);si([v.trace("MediaMiddlewareUtils.removeAudioMiddleware")],En.prototype,"removeAudioMiddleware",1);const Pn=class{constructor(){g(this,"mediaPermissionEvent");this.mediaPermissionEvent=!0}static getInstance(){return Pn.instance||(Pn.instance=new Pn),Pn.instance}get shouldEmitMediaPermissionEvent(){return this.mediaPermissionEvent}setEmitMediaPermissionEvent(e){this.mediaPermissionEvent=e}};let fs=Pn;g(fs,"instance");const rs=fs.getInstance(),eO={lowVolumeThreshold:-40,clipThreshold:1,silentThreshold:1/1987,delay:500,media:"audio"};var bi,nn,Fs,Sp,ki,Vo;const pd=class{constructor(e){S(this,Fs);S(this,ki);g(this,"analyser");g(this,"silentThreshold");g(this,"lowVolumeThreshold");g(this,"clipThreshold");g(this,"delay");g(this,"audioContext");g(this,"audioSource");g(this,"metadata",{});g(this,"analysing");g(this,"track");S(this,bi,void 0);S(this,nn,void 0);const{lowVolumeThreshold:r,silentThreshold:n,clipThreshold:i,delay:s,media:a}={...eO,...e};this.lowVolumeThreshold=r,this.silentThreshold=n,this.clipThreshold=i,this.delay=s,this.analysing=!1,w(this,nn,a)}setTrack(e){if(!e)return;this.track=e.clone();const r=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new r,this.analyser=this.audioContext.createAnalyser(),d(this,nn)==="screenshare"){P.emit(I.SCREENSHARE_AUDIO_TRACK_CREATED);return}P.emit(I.AUDIO_TRACK_CREATED)}getTrackMetadata(){if(!this.track)return null;switch(this.metadata.label=this.track.label,this.metadata.channelCountMode=this.analyser.channelCountMode,this.metadata.channelCount=this.analyser.channelCount,this.metadata.channelInterpretation=this.analyser.channelInterpretation,this.metadata.outputs=this.analyser.numberOfOutputs,this.analyser.numberOfOutputs){case 1:this.metadata.channelType="MONO";break;case 2:this.metadata.channelType="STEREO";break;case 4:this.metadata.channelType="QUAD";break}return this.metadata}async startTrackAnalysis(){if(!this.track||this.analysing)return!1;try{return await this.audioContext.resume(),await W(this,Fs,Sp).call(this),this.analysing=!0,!0}catch(e){return p.error(e),!1}}stopTrackAnalysis(){this.analysing&&(this.analysing=!1,clearTimeout(d(this,bi)))}cleanup(){var e,r,n,i,s;if(this.stopTrackAnalysis(),(e=this.analyser)==null||e.disconnect(),(r=this.audioSource)==null||r.disconnect(this.analyser),(n=this.audioSource)==null||n.disconnect(),(i=this.audioContext)==null||i.close(),this.audioContext=void 0,this.analyser=void 0,this.audioSource=void 0,(s=this.track)==null||s.stop(),this.track=void 0,d(this,nn)==="screenshare"){P.emit(I.SCREENSHARE_AUDIO_TRACK_CLOSED);return}P.emit(I.AUDIO_TRACK_CLOSED)}static dbFS(e){const r=20*(Math.log(e)/Math.log(10));return Math.round(r*10)/10}};let Is=pd;bi=new WeakMap,nn=new WeakMap,Fs=new WeakSet,Sp=async function(){try{const e=new MediaStream;e.addTrack(this.track),this.audioSource=this.audioContext.createMediaStreamSource(e),this.audioSource.connect(this.analyser),await new Promise(r=>{window.requestAnimationFrame(()=>{W(this,ki,Vo).call(this),r(!0)})})}catch(e){p.error(e)}},ki=new WeakSet,Vo=function(){const e=new Float32Array(this.analyser.fftSize);this.analyser.getFloatTimeDomainData(e);let r=0;for(const a of e)r+=a*a;const n=Math.sqrt(r/e.length),i=pd.dbFS(n),s={volume:n,lowVolume:i<this.lowVolumeThreshold,silence:n<this.silentThreshold,clip:n>this.clipThreshold,timestamp:new Date().getTime()};d(this,nn)==="screenshare"?P.emit(I.SCREENSHARE_AUDIO_TRACK_ANALYSIS,s):P.emit(I.AUDIO_TRACK_ANALYSIS,s),w(this,bi,setTimeout(()=>{window.requestAnimationFrame(W(this,ki,Vo).bind(this))},this.delay))};const Zt=new Is,mi=new Is({media:"screenshare"}),li={},Mt={executeWithLock({methodName:t,lockName:e,timeout:r}){return(n,i,s)=>{const a=s.value;return s.value=function(...c){if(li[e]){const f=new Error(`Unsupported concurrent calls on Dyte method: ${t}.`);throw f.name="UnsupportedConcurrentMethodExecution",p.error("DyteLocker::UnsupportedConcurrentMethodExecution",{error:{stack:f.stack},dyteLocker:{methodName:t,lockName:e}}),f}li[e]=!0;const u=setTimeout(()=>delete li[e],r),h=a.apply(this,c);return Promise.resolve(h).then(()=>{delete li[e],clearTimeout(u)}).catch(()=>{delete li[e],clearTimeout(u)}),h},s}}};var tO=Object.defineProperty,rO=Object.getOwnPropertyDescriptor,re=(t,e,r,n)=>{for(var i=n>1?void 0:n?rO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&tO(e,r,i),i},J,Dr,gl;const bp=(gl=class extends Qs.EventEmitter{constructor(e,r){super();S(this,J,void 0);S(this,Dr,void 0);g(this,"mediaMiddlewareUtils");g(this,"audioTrack");g(this,"rawAudioTrack");g(this,"videoTrack");g(this,"rawVideoTrack");g(this,"screenShareTracks");g(this,"audioEnabled");g(this,"videoEnabled");g(this,"screenShareEnabled");g(this,"currentDevices");g(this,"permissions");g(this,"audioUpdateInProgress");g(this,"videoUpdateInProgress");g(this,"screenShareUpdateInProgress");g(this,"initialSetupComplete",!1);g(this,"isDeprecated",()=>!0);w(this,J,e),w(this,Dr,new Ap(r)),this.audioEnabled=!0,this.videoEnabled=!0,this.audioUpdateInProgress=!1,this.videoUpdateInProgress=!1,this.screenShareUpdateInProgress=!1,this.screenShareEnabled=!1,this.permissions={audio:"NOT_REQUESTED",video:"NOT_REQUESTED",screenshare:"NOT_REQUESTED"},this.screenShareTracks={audio:void 0,video:void 0},this.currentDevices={audio:void 0,video:void 0,speaker:void 0},d(this,J).onDeviceChange((n,i)=>{this.onDeviceChange(i,!1),this.emit("DEVICE_LIST_UPDATED",i)}),this.conditionallyRestartAudio=this.conditionallyRestartAudio.bind(this),this.conditionallyRestartVideo=this.conditionallyRestartVideo.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),document.addEventListener("visibilitychange",this.onVisibilityChange),this.on("AUDIO_TRACK_CHANGE",()=>{this.notifyIfTrackSilent()}),P.on(I.PRODUCER_TRACK_ENDED,({kind:n})=>{n==="mic"&&this.conditionallyRestartAudio(),n==="webcam"&&this.conditionallyRestartVideo()})}handlePermissionErrors(e,r){const n=ka(e,r.name,r.message);this.permissions[e]=n,P.emit(I.MEDIA_PERMISSION_ERROR,{message:n,constraints:r.constraints,kind:e})}async repopulateAvailableDevices(){return d(this,J).repopulateAvailableDevices()}onVisibilityChange(e){document.visibilityState==="visible"&&(le.isMobile()&&this.conditionallyRestartAudio(),this.conditionallyRestartVideo())}async conditionallyRestartAudio(e){var n,i;await new Promise(s=>setTimeout(s,50)),p.info("performingCheck::shouldReacquireAudioTrack",{actions:{trackRobustness:{eventType:e==null?void 0:e.type}}});const r=await this.shouldReacquireTrack("audio");p.info("performedCheck::shouldReacquireAudioTrack",{actions:{trackRobustness:{reacquireTrack:r}}}),r&&(p.info("reacquiring_audio_track"),this.removeMediaStreamTrackListeners(this.rawAudioTrack),le.isChromiumBased()&&await d(this,J).repopulateAvailableDevices(),await this.setupAudioStream((i=(n=this.currentDevices)==null?void 0:n.audio)==null?void 0:i.deviceId),this.addMediaStreamTrackListeners(this.rawAudioTrack),this.emit("AUDIO_TRACK_CHANGE"))}async conditionallyRestartVideo(e){var n,i;await new Promise(s=>setTimeout(s,50)),p.info("performingCheck::shouldReacquireVideoTrack",{actions:{trackRobustness:{eventType:e==null?void 0:e.type}}});const r=await this.shouldReacquireTrack("video");p.info("performedCheck::shouldReacquireVideoTrack",{actions:{trackRobustness:{reacquireTrack:r}}}),r&&(p.info("reacquiring_video_track"),this.removeMediaStreamTrackListeners(this.rawVideoTrack),await d(this,J).repopulateAvailableDevices(),await this.setupVideoStream((i=(n=this.currentDevices)==null?void 0:n.video)==null?void 0:i.deviceId),this.addMediaStreamTrackListeners(this.rawVideoTrack),this.emit("VIDEO_TRACK_CHANGE"))}async shouldReacquireTrack(e){if(e==="audio"){if(this.audioUpdateInProgress||!this.audioEnabled)return!1;if(!this.rawAudioTrack||!this.audioTrack)return!0;const s=this.rawAudioTrack.muted||this.audioTrack.muted;return(this.rawAudioTrack.readyState==="ended"||this.audioTrack.readyState==="ended")&&this.audioEnabled||s}if(this.videoUpdateInProgress||!this.videoEnabled)return!1;if(!this.rawVideoTrack||!this.videoTrack)return!0;const r=this.rawVideoTrack.muted||this.videoTrack.muted,i=(this.rawVideoTrack.readyState==="ended"||this.videoTrack.readyState==="ended")&&this.videoEnabled;return document.visibilityState==="visible"&&(i||r)}onAudioUnmute(e){p.info("audio_track_unmuted",{actions:{trackRobustness:{eventType:e==null?void 0:e.type}}})}onVideoUnmute(e){p.info("video_track_unmuted",{actions:{trackRobustness:{eventType:e==null?void 0:e.type}}})}removeMediaStreamTrackListeners(e){if(p.info(`Removing ${e.kind} listerners`),!e)return;const r=e.kind==="audio"?this.conditionallyRestartAudio:this.conditionallyRestartVideo;return e.removeEventListener("ended",r),e.removeEventListener("mute",r),e.removeEventListener("unmute",e.kind==="audio"?this.onAudioUnmute:this.onVideoUnmute),e}addMediaStreamTrackListeners(e){if(!e)return null;p.info(`adding_${e.kind}_stream_listerners`);const r=e.kind==="audio",n=r?this.conditionallyRestartAudio:this.conditionallyRestartVideo;return e.addEventListener("ended",async()=>{await n();const i=r?this.audioEnabled:this.videoEnabled,s=r?this.audioTrack:this.videoTrack,a=r?"FORCE_MUTE_AUDIO":"FORCE_MUTE_VIDEO";i&&!(s&&s.readyState==="live"&&s.enabled)&&(p.info(`LocalMediaHandler::trackEnded::Failed to restart ${e.kind} track`),this.emit(a))}),e.addEventListener("mute",n),e.addEventListener("unmute",r?this.onAudioUnmute:this.onVideoUnmute),e}async notifyIfTrackSilent(){var e,r,n,i,s,a;this.audioEnabled&&this.audioTrack&&this.audioTrack.readyState!=="ended"&&this.audioTrack.enabled&&await Cs(this.audioTrack)===!0&&(p.info("LocalMediaHandler:notifyIfTrackSilent:TrackSilent",{media:{audio:{enabled:this.audioEnabled,deviceId:(r=(e=this.audioTrack)==null?void 0:e.getSettings())==null?void 0:r.deviceId,permission:(n=this.permissions)==null?void 0:n.audio,deviceName:(s=(i=this.currentDevices)==null?void 0:i.audio)==null?void 0:s.label,trackId:(a=this.audioTrack)==null?void 0:a.id}}}),this.emit("AUDIO_TRACK_SILENT"))}async setupAudioStream(e,r=!0){var n,i,s;if(!this.audioUpdateInProgress)try{this.audioUpdateInProgress=!0;const a=d(this,J).getAudioDevices();if(!a.length)throw this.audioEnabled=!1,new In("COULD_NOT_START","No audio devices",{});let o=e;(!o||!a.find(u=>u.deviceId===o))&&(o=await this.getPreferredDeviceId("AUDIO"),p.debug("setupAudioStream::AUDIO::getPreferredDeviceId",{preferredDevice:{preferredDeviceId:o,kind:"audio"}}));const c=Ce.getAudioConstraints({audioDeviceId:o});r&&((n=this.rawAudioTrack)==null||n.stop(),(i=this.audioTrack)==null||i.stop()),this.rawAudioTrack=await Ce.getAudioTrack(c),o=this.rawAudioTrack.getSettings().deviceId,((s=this.currentDevices.audio)==null?void 0:s.deviceId)!==o&&(this.currentDevices.audio=d(this,J).getDeviceById(o,"audioinput"),this.emit("DEVICE_CHANGE",{device:this.currentDevices.audio})),this.rawAudioTrack.enabled=this.audioEnabled,this.setAudioTrack(await this.mediaMiddlewareUtils.getTransformedAudioTrack(this.rawAudioTrack)),this.addMediaStreamTrackListeners(this.rawAudioTrack),await d(this,J).repopulateAvailableDevices(),this.permissions.audio="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.audio,kind:"audio"}),o&&er.setItem("lastUsedAudioDeviceId",o)}catch(a){this.handlePermissionErrors("audio",a)}finally{this.audioUpdateInProgress=!1}}async getPreferredDeviceId(e){var n,i;let r;if(e==="AUDIO"){const s=d(this,J).getAudioDevices(),a=er.getItem("lastUsedAudioDeviceId");p.debug("getPreferredDeviceId::lastUsedAudioDeviceId",{preferredDevice:{lastUsedPreferredDeviceId:a,kind:"audio"}});let o;a&&(o=s.find(c=>c.deviceId===a)),o?r=a:ie.hasFeature(se.REMOVE_OPERATIONAL_MIC)||(r=(await this.getOperationalMicDeviceId()).deviceId),r||(r=(n=s[0])==null?void 0:n.deviceId)}if(e==="VIDEO"){const s=er.getItem("lastUsedVideoDeviceId");p.debug("getPreferredDeviceId::lastUsedVideoDeviceId",{preferredDevice:{kind:"video",lastUsedPreferredDeviceId:s}});const a=d(this,J).getVideoDevices();let o;s&&(o=a.find(c=>c.deviceId===s)),o?r=s:r=(await this.getOperationalWebcamDeviceId()).deviceId,r||(r=(i=a[0])==null?void 0:i.deviceId)}return r}async setupVideoStream(e,r=!0){var n,i;if(!this.videoUpdateInProgress)try{this.videoUpdateInProgress=!0;const s=d(this,J).getVideoDevices();if(!s.length)throw this.videoEnabled=!1,new In("COULD_NOT_START","No video devices",{});let a=e;if((!a||!s.find(o=>o.deviceId===a))&&(a=await this.getPreferredDeviceId("VIDEO"),p.debug("setupVideoStream::VIDEO::getPreferredDeviceId",{preferredDevice:{preferredDeviceId:a,kind:"video"}})),r&&((n=this.videoTrack)==null||n.stop()),this.videoEnabled){const o=d(this,Dr).getVideoConstraints(a);this.rawVideoTrack=await Ce.getVideoTrack(o),a=this.rawVideoTrack.getSettings().deviceId,this.setVideoTrack(await this.mediaMiddlewareUtils.getTransformedVideoTrack(this.rawVideoTrack)),this.addMediaStreamTrackListeners(this.rawVideoTrack)}await d(this,J).repopulateAvailableDevices(),((i=this.currentDevices.video)==null?void 0:i.deviceId)!==a&&(this.currentDevices.video=d(this,J).getDeviceById(a,"videoinput"),this.emit("DEVICE_CHANGE",{device:this.currentDevices.video})),this.permissions.video="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.video,kind:"video"}),a&&er.setItem("lastUsedVideoDeviceId",a)}catch(s){this.handlePermissionErrors("video",s)}finally{this.videoUpdateInProgress=!1}}async setupScreenShareStreams(){if(this.screenShareUpdateInProgress)return;const e=d(this,Dr).getScreenShareConstraints();ie.hasFeature(se.SCREENSHARE_MAX_DIMENSIONS)&&(e.video.width.max=window.screen.width,e.video.height.max=window.screen.height);try{this.screenShareUpdateInProgress=!0;const r=await Ce.getScreenShareTracks(e);this.setScreenShareTracks(r)}catch(r){throw this.handlePermissionErrors("screenshare",new In(r.name,r.message,e)),new E(r.message)}finally{this.screenShareUpdateInProgress=!1}}async setupSpeaker(e){var i;const r=d(this,J).getSpeakerDevices();if(!r.length)return;const n=e!=null?e:r[0].deviceId;((i=this.currentDevices.speaker)==null?void 0:i.deviceId)!==n&&(this.currentDevices.speaker=d(this,J).getDeviceById(n,"audiooutput"),this.emit("DEVICE_CHANGE",{device:this.currentDevices.speaker})),document.querySelectorAll("audio").forEach(async s=>{if(typeof s.sinkId!="undefined"&&this.currentDevices.speaker.deviceId&&s.sinkId!==this.currentDevices.speaker.deviceId)try{await s.setSinkId(this.currentDevices.speaker.deviceId)}catch(a){}})}async getOperationalWebcamDeviceId(){const e=d(this,J).getVideoDevices();if(!e.length)return{isOperational:!1,deviceId:null};rs.setEmitMediaPermissionEvent(!1);const r=[],n=await e.reduce(async(i,s)=>{const a=await i;if(a!==null)return a;const o=d(this,Dr).getVideoConstraints(s.deviceId);try{return(await Ce.getVideoTrack(o)).stop(),s.deviceId}catch(c){p.error("getOperationalWebcamDeviceId::could_not_acquire_video_device",{error:c,constraints:o}),r.push({exception:c,constraints:o})}return a},Promise.resolve(null));if(rs.setEmitMediaPermissionEvent(!0),!n&&r.length>0&&r.length===e.length){const{exception:i,constraints:s}=r[0];throw new In(i.name,i.message,s)}return n?{isOperational:!0,deviceId:n}:{isOperational:!1,deviceId:e[0].deviceId}}async getOperationalMicDeviceId(){const e=d(this,J).getAudioDevices();if(!e.length)return{isOperational:!1,deviceId:null};const r=[];rs.setEmitMediaPermissionEvent(!1);const n=await e.reduce(async(i,s)=>{const a=await i;if(a!==null)return a;const o=Ce.getAudioConstraints({audioDeviceId:s.deviceId});try{const c=await Ce.getAudioTrack(o),u=await Cs(c);if(c==null||c.stop(),!u)return s}catch(c){p.error("getOperationalMicDeviceId::could_not_acquire_audio_device",{error:c,constraints:o}),r.push({exception:c,constraints:o})}return a},Promise.resolve(null));if(rs.setEmitMediaPermissionEvent(!0),!n&&r.length>0&&r.length===e.length){const{exception:i,constraints:s}=r[0];throw new In(i.name,i.message,s)}return n?{isOperational:!0,deviceId:n.deviceId}:{isOperational:!1,deviceId:e[0].deviceId}}async setupStreams({audio:e,video:r}){var i;const n={};this.currentDevices||(this.currentDevices={audio:void 0,video:void 0,speaker:void 0});try{if(e&&!this.audioUpdateInProgress&&d(this,J).getAudioDevices().length!==0){const c=await this.getPreferredDeviceId("AUDIO");p.info("setupStreams::AUDIO::getPreferredDeviceId",{preferredDevice:{preferredDeviceId:c,kind:"audio"}});const u=Ce.getAudioConstraints({audioDeviceId:c});n.audio=u.audio}if(r&&!this.videoUpdateInProgress&&d(this,J).getVideoDevices().length!==0){const c=await this.getPreferredDeviceId("VIDEO");p.info("setupStreams::VIDEO::getPreferredDeviceId",{preferredDevice:{preferredDeviceId:c,kind:"video"}});const u=d(this,Dr).getVideoConstraints(c);n.video=u.video}if(((i=Object.keys(n))==null?void 0:i.length)===0){this.audioEnabled=e!=null?e:this.audioEnabled,this.videoEnabled=r!=null?r:this.videoEnabled,this.audioUpdateInProgress=!1,this.videoUpdateInProgress=!1,this.initialSetupComplete=!0;return}const{audioTrack:s,videoTrack:a}=await Ce.getAudioAndVideoTrack(n);e&&s&&(this.audioTrack=s,this.rawAudioTrack=s,this.permissions.audio="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.audio,kind:"audio"}),this.currentDevices.audio=d(this,J).getDeviceById(s.getSettings().deviceId,"audioinput"),er.setItem("lastUsedAudioDeviceId",s.getSettings().deviceId)),r&&a&&(this.videoTrack=a,this.rawVideoTrack=a,this.permissions.video="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.video,kind:"video"}),this.currentDevices.video=d(this,J).getDeviceById(a.getSettings().deviceId,"videoinput"),er.setItem("lastUsedVideoDeviceId",a.getSettings().deviceId)),await d(this,J).repopulateAvailableDevices()}catch(s){s.name==="NotAllowedError"&&(e&&await this.setupAudioStream(),r&&await this.setupVideoStream())}this.audioEnabled=!!this.audioTrack,this.videoEnabled=!!this.videoTrack,this.screenShareEnabled=!1,this.audioUpdateInProgress=!1,this.videoUpdateInProgress=!1,this.initialSetupComplete=!0,await this.setupSpeaker()}stopAudioTrack(){var e,r;this.audioUpdateInProgress||(this.audioUpdateInProgress=!0,(e=this.audioTrack)==null||e.stop(),(r=this.rawAudioTrack)==null||r.stop(),this.audioEnabled=!1,this.audioUpdateInProgress=!1)}stopVideoTrack(){var e,r;this.videoUpdateInProgress||(this.videoUpdateInProgress=!0,(e=this.videoTrack)==null||e.stop(),(r=this.rawVideoTrack)==null||r.stop(),this.videoEnabled=!1,this.videoUpdateInProgress=!1)}stopScreenShareTracks(e={}){var i,s,a,o;if(this.screenShareUpdateInProgress)return;this.screenShareUpdateInProgress=!0;const{audio:r=!0,video:n=!0}=e;r&&((s=(i=this.screenShareTracks)==null?void 0:i.audio)==null||s.stop()),n&&((o=(a=this.screenShareTracks)==null?void 0:a.video)==null||o.stop()),this.screenShareEnabled=!1,this.screenShareUpdateInProgress=!1}removeAudioTrack(){this.stopAudioTrack(),this.audioTrack=void 0,this.rawAudioTrack=void 0,ie.hasFeature(se.TROUBLESHOOTING)&&Zt.cleanup()}removeVideoTrack(){this.stopVideoTrack(),this.videoTrack=void 0,this.rawVideoTrack=void 0}removeScreenShareTracks(e){var r;(r=this.screenShareTracks.video)==null||r.removeEventListener("ended",this.onScreenShareEnded),this.stopScreenShareTracks(e),this.screenShareTracks={audio:void 0,video:void 0}}removeAllTracks(){this.removeAudioTrack(),this.removeVideoTrack(),this.removeScreenShareTracks({audio:!!this.screenShareTracks.audio,video:!!this.screenShareTracks.video})}setAudioTrack(e){e!==this.audioTrack&&(e===void 0&&this.stopAudioTrack(),this.audioTrack=e,this.audioTrack&&(this.audioTrack.enabled=this.audioEnabled))}setVideoTrack(e){e!==this.videoTrack&&(e===void 0&&this.stopVideoTrack(),this.videoTrack=e)}setScreenShareTracks(e){var i;const{audio:r,video:n}=e;(!r||!n)&&this.stopScreenShareTracks({audio:!!r,video:!!n}),this.screenShareTracks=e,(i=this.screenShareTracks.video)==null||i.addEventListener("ended",this.onScreenShareEnded.bind(this))}onScreenShareEnded(){this.emit("SCREENSHARE_ENDED")}disableAudio(){this.audioEnabled=!1,this.audioTrack&&(this.audioTrack.enabled=this.audioEnabled),this.rawAudioTrack&&(this.rawAudioTrack.enabled=this.audioEnabled)}async enableAudio(){var e;if(this.permissions.audio==="DENIED"){this.audioEnabled=!1;return}try{if((!this.audioTrack||this.audioTrack.readyState==="ended")&&await this.setupAudioStream((e=this.currentDevices.audio)==null?void 0:e.deviceId),!this.audioTrack||!this.rawAudioTrack){this.audioEnabled=!1,p.error("LocalMediaHandler::enableAudio:Setting up audio stream failed while enabling audio",{debuggingHint:"Refer to SelfController::mediaPermissionError log."});return}this.audioEnabled=!0}catch(r){this.audioEnabled=!1,this.audioTrack=void 0,this.rawAudioTrack=void 0,p.error("LocalMediaHandler::enableAudio",{error:r},!0)}this.audioTrack&&(this.audioTrack.enabled=!0),this.rawAudioTrack&&(this.rawAudioTrack.enabled=!0),!(this.permissions.audio==="ACCEPTED"||!this.audioEnabled)&&(this.permissions.audio="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.audio,kind:"audio"}))}async toggleAudio(){var e;if(this.permissions.audio==="DENIED"){this.audioEnabled=!1;return}try{if((!this.audioTrack||this.audioTrack.readyState==="ended")&&await this.setupAudioStream((e=this.currentDevices.audio)==null?void 0:e.deviceId),!this.audioTrack||!this.rawAudioTrack){this.audioEnabled=!1;return}this.audioEnabled=!this.audioEnabled}catch(r){this.audioEnabled=!1,p.error("LocalMediaHandler::toggleAudio",{error:r},!0)}this.audioTrack&&(this.audioTrack.enabled=this.audioEnabled),this.rawAudioTrack&&(this.rawAudioTrack.enabled=this.audioEnabled)}async toggleVideo(){var e;if(this.permissions.video==="DENIED"){this.videoEnabled=!1;return}if(this.videoEnabled){this.removeVideoTrack();return}this.videoEnabled=!0;try{await this.setupVideoStream((e=this.currentDevices.video)==null?void 0:e.deviceId)}catch(r){this.videoEnabled=!1}this.videoTrack&&(this.videoTrack.enabled=this.videoEnabled),this.rawVideoTrack&&(this.rawVideoTrack.enabled=this.videoEnabled),!(this.permissions.video==="ACCEPTED"||!this.videoEnabled)&&(this.permissions.video="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.video,kind:"video"}))}async toggleScreenShare(){if(this.screenShareEnabled){this.removeScreenShareTracks({audio:!!this.screenShareTracks.audio,video:!!this.screenShareTracks.video});return}try{if(await this.setupScreenShareStreams(),this.screenShareEnabled=!0,this.permissions.screenshare==="ACCEPTED")return;this.permissions.screenshare="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:this.permissions.screenshare,kind:"screenshare"})}catch(e){this.screenShareEnabled=!1}}getAllDevices(){return d(this,J).availableDevices}getDeviceById(e,r){return d(this,J).getDeviceById(e,r)}getAudioDevices(){return d(this,J).getAudioDevices()}getVideoDevices(){return d(this,J).getVideoDevices()}getSpeakerDevices(){return d(this,J).getSpeakerDevices()}async onDeviceChange(e,r){var n,i;this.initialSetupComplete&&((n=e==null?void 0:e.added)==null||n.forEach(async s=>{s&&(r||!Yr(s))&&(s.kind==="audioinput"?(await this.setupAudioStream(s.deviceId),this.emit("AUDIO_TRACK_CHANGE")):s.kind==="videoinput"&&this.videoEnabled?(await this.setupVideoStream(s.deviceId),this.emit("VIDEO_TRACK_CHANGE")):s.kind==="audiooutput"&&await this.setupSpeaker(s.deviceId))}),(i=e==null?void 0:e.removed)==null||i.forEach(async s=>{var a,o,c;s&&((s.kind==="audioinput"&&!this.audioEnabled||s.kind==="videoinput"&&!this.videoEnabled||ie.hasFeature(se.DEVICE_REMOVE_EXP)||!le.isChromiumBased())&&(s.kind==="audioinput"&&s.deviceId===((a=this.currentDevices.audio)==null?void 0:a.deviceId)?(await this.setupAudioStream(),this.emit("AUDIO_TRACK_CHANGE")):s.kind==="videoinput"&&s.deviceId===((o=this.currentDevices.video)==null?void 0:o.deviceId)&&(await this.setupVideoStream(),this.emit("VIDEO_TRACK_CHANGE"))),s.kind==="audiooutput"&&s.deviceId===((c=this.currentDevices.speaker)==null?void 0:c.deviceId)&&await this.setupSpeaker())}))}static async init(e){const r=await Ce.init(),n=new bp(r,e),i=new En(n);return n.mediaMiddlewareUtils=i,n}emit(e,...r){return super.emit(e,...r)}on(e,r){return super.on(e,r)}async removeDocumentEventListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}addAudioMiddleware(e){return this.mediaMiddlewareUtils.addAudioMiddleware(e)}removeAudioMiddleware(e){return this.mediaMiddlewareUtils.removeAudioMiddleware(e)}addVideoMiddleware(e){return this.mediaMiddlewareUtils.addVideoMiddleware(e)}removeVideoMiddleware(e){return this.mediaMiddlewareUtils.removeVideoMiddleware(e)}async enableVideo(){await this.toggleVideo()}async disableVideo(){await this.toggleVideo()}async enableScreenShare(){await this.toggleScreenShare()}async disableScreenShare(){await this.toggleScreenShare()}getCurrentDevices(){return this.currentDevices}destruct(){this.mediaMiddlewareUtils.terminateMiddlewareWebWorker(),d(this,J).destruct(),this.removeAllTracks(),this.removeAllListeners()}},J=new WeakMap,Dr=new WeakMap,gl);let ee=bp;re([Mt.executeWithLock({methodName:"oldLocalMediaHandler.conditionallyRestartAudio",lockName:"oldLocalMediaHandler.conditionallyRestartAudio",timeout:3e3})],ee.prototype,"conditionallyRestartAudio",1);re([Mt.executeWithLock({methodName:"oldLocalMediaHandler.conditionallyRestartVideo",lockName:"oldLocalMediaHandler.conditionallyRestartVideo",timeout:3e3})],ee.prototype,"conditionallyRestartVideo",1);re([v.trace("OldMediaHandler.shouldReacquireTrack")],ee.prototype,"shouldReacquireTrack",1);re([v.trace("OldMediaHandler.removeMediaStreamTrackListeners")],ee.prototype,"removeMediaStreamTrackListeners",1);re([v.trace("OldMediaHandler.addMediaStreamTrackListeners")],ee.prototype,"addMediaStreamTrackListeners",1);re([v.trace("OldMediaHandler.setupAudioStream")],ee.prototype,"setupAudioStream",1);re([v.trace("OldMediaHandler.getPreferredDeviceId")],ee.prototype,"getPreferredDeviceId",1);re([v.trace("OldMediaHandler.setupVideoStream")],ee.prototype,"setupVideoStream",1);re([v.trace("OldMediaHandler.setupScreenShareStreams")],ee.prototype,"setupScreenShareStreams",1);re([v.trace("OldMediaHandler.setupSpeaker")],ee.prototype,"setupSpeaker",1);re([v.trace("OldMediaHandler.getOperationalWebcamDeviceId")],ee.prototype,"getOperationalWebcamDeviceId",1);re([v.trace("OldMediaHandler.getOperationalMicDeviceId")],ee.prototype,"getOperationalMicDeviceId",1);re([v.trace("OldMediaHandler.setupStreams")],ee.prototype,"setupStreams",1);re([v.trace("OldMediaHandler.stopAudioTrack")],ee.prototype,"stopAudioTrack",1);re([v.trace("OldMediaHandler.stopVideoTrack")],ee.prototype,"stopVideoTrack",1);re([v.trace("OldMediaHandler.stopScreenShareTracks")],ee.prototype,"stopScreenShareTracks",1);re([v.trace("OldMediaHandler.removeAudioTrack")],ee.prototype,"removeAudioTrack",1);re([v.trace("OldMediaHandler.removeVideoTrack")],ee.prototype,"removeVideoTrack",1);re([v.trace("OldMediaHandler.removeScreenShareTracks")],ee.prototype,"removeScreenShareTracks",1);re([v.trace("OldMediaHandler.removeAllTracks")],ee.prototype,"removeAllTracks",1);re([v.trace("OldMediaHandler.setAudioTrack")],ee.prototype,"setAudioTrack",1);re([v.trace("OldMediaHandler.setVideoTrack")],ee.prototype,"setVideoTrack",1);re([v.trace("OldMediaHandler.setScreenShareTracks")],ee.prototype,"setScreenShareTracks",1);re([v.trace("OldMediaHandler::disableAudio")],ee.prototype,"disableAudio",1);re([v.trace("OldMediaHandler::enableAudio")],ee.prototype,"enableAudio",1);re([v.trace("OldMediaHandler.toggleAudio")],ee.prototype,"toggleAudio",1);re([v.trace("OldMediaHandler.toggleVideo")],ee.prototype,"toggleVideo",1);re([v.trace("OldMediaHandler.toggleScreenShare")],ee.prototype,"toggleScreenShare",1);class kp extends ht{constructor(){super(...arguments);g(this,"localMediaHandler")}async updatePermission(){var c,u;const r=(h,f)=>{this.mediaPermissions[h]=f;const m={message:this.mediaPermissions[h],kind:h};f==="DENIED"?P.emit(I.MEDIA_PERMISSION_ERROR,m):P.emit(I.MEDIA_PERMISSION_UPDATE,m)};if(le.getName()==="firefox")return;const n="microphone",i="camera",s=await((c=navigator==null?void 0:navigator.permissions)==null?void 0:c.query({name:n})),a=await((u=navigator==null?void 0:navigator.permissions)==null?void 0:u.query({name:i})),o=(h,f)=>{switch(f){case"granted":r(h,"ACCEPTED");break;case"denied":r(h,"DENIED");break;case"prompt":r(h,"NOT_REQUESTED");break}this.localMediaHandler.repopulateAvailableDevices()};s&&(s.onchange=()=>o("audio",s.state)),a&&(a.onchange=()=>o("video",a.state))}async init(r={},n=!1){var i,s,a,o;if(le.init(),!this.localMediaHandler)try{let c=!0;if(B.defaults.mediaHandler)c=!1,this.localMediaHandler=B.defaults.mediaHandler.localMediaHandler;else if(navigator.RNLocalMediaHandlerImpl){const{RNLocalMediaHandlerImpl:u}=navigator;this.localMediaHandler=await u.init()}else ie.hasFeature(se.NEW_LOCAL_MEDIA_HANDLER)||window.FAST_DYTE?this.localMediaHandler=new tt(r.constraints,(i=B==null?void 0:B.defaults)==null?void 0:i.isNonPreferredDevice,(s=B==null?void 0:B.defaults)==null?void 0:s.autoSwitchAudioDevice):this.localMediaHandler=await ee.init(r.constraints);if(P.on(I.MEDIA_PERMISSION_UPDATE,async u=>{if(u.message==="ACCEPTED"){const h=this.getCurrentDevices(),f=await this.getAudioDevices(),m=await this.getVideoDevices(),T=await this.getSpeakerDevices(),A=ie.hasFeature(se.NEW_LOCAL_MEDIA_HANDLER);switch(u==null?void 0:u.kind){case"audio":!h.audio&&f.length>0&&(A||this.setDevice(f[0])),!h.speaker&&T.length>0&&(A||this.setDevice(T[0]));break;case"video":!h.video&&m.length>0&&(A||this.setDevice(m[0]));break;default:break}}if(u.message==="NOT_REQUESTED")switch(u==null?void 0:u.kind){case"audio":this.rawAudioTrack&&this.disableAudio();break;case"video":this.rawVideoTrack&&this.disableVideo();break;default:break}this.emit("mediaPermissionUpdate",u)}),P.on(I.MEDIA_PERMISSION_ERROR,async u=>{const{kind:h,message:f}=u;h==="audio"?this.disableAudio():h==="video"?this.disableVideo():h==="screenshare"&&this.disableScreenShare(),p.error("SelfController::mediaPermissionError",{error:{message:u.message},constraints:u.constraints,mediaPermissionsErrors:{kind:h,message:f}}),this.emit("mediaPermissionError",u),this.emit("mediaPermissionUpdate",{message:f,kind:h})}),c){const u=this.localMediaHandler.setupStreams({video:(a=r==null?void 0:r.video)!=null?a:!0,audio:(o=r==null?void 0:r.audio)!=null?o:!0});n||await u}}catch(c){p.error("DyteSelf::init::Failed To Setup Streams",{error:{name:c.name,message:c.message}})}}get audioTrack(){return this.localMediaHandler.audioTrack}get rawAudioTrack(){return this.localMediaHandler.rawAudioTrack}get mediaPermissions(){return this.localMediaHandler.permissions}async addAudioMiddleware(r){return this.localMediaHandler.addAudioMiddleware(r)}async removeAudioMiddleware(r){return this.localMediaHandler.removeAudioMiddleware(r)}get videoTrack(){return this.localMediaHandler.videoTrack}get rawVideoTrack(){return this.localMediaHandler.rawVideoTrack}async addVideoMiddleware(r){return this.localMediaHandler.addVideoMiddleware(r)}async removeVideoMiddleware(r){return this.localMediaHandler.removeVideoMiddleware(r)}get screenShareTracks(){return this.localMediaHandler.screenShareTracks}get audioEnabled(){return this.localMediaHandler.audioEnabled}get videoEnabled(){return this.localMediaHandler.videoEnabled}get screenShareEnabled(){return this.localMediaHandler.screenShareEnabled}async enableAudio(){await this.localMediaHandler.enableAudio(),this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack})}async enableVideo(){await this.localMediaHandler.enableVideo(),this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack})}async disableAudio(){this.localMediaHandler.disableAudio(),this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack})}async disableVideo(){await this.localMediaHandler.disableVideo(),this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack})}async disableScreenShare(){}getCurrentDevices(){return this.localMediaHandler.getCurrentDevices()}async getAudioDevices(){return await this.localMediaHandler.getAudioDevices()}async getVideoDevices(){return await this.localMediaHandler.getVideoDevices()}async getSpeakerDevices(){return await this.localMediaHandler.getSpeakerDevices()}getDeviceById(r,n){let i;return n==="audio"?i="audioinput":n==="video"?i="videoinput":n==="speaker"&&(i="audiooutput"),this.localMediaHandler.getDeviceById(r,i)}async setDevice(r){const n={added:[r],removed:[]};if("isDeprecated"in this.localMediaHandler){await this.localMediaHandler.onDeviceChange(n,!0);return}switch(r.kind){case"audioinput":try{await this.localMediaHandler.setAudioDevice(r)}catch(i){}finally{this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack})}break;case"audiooutput":await this.localMediaHandler.setSpeakerDevice(r);break;case"videoinput":try{await this.localMediaHandler.setVideoDevice(r)}catch(i){}finally{this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack})}break}this.emit("deviceUpdate",{device:r})}}const nO={nonBlackPixelLumaThreshold:20,identicalFrameSsimThreshold:.985,media:"video"};var Ci,Or,sn,Ii,Bo,Vs,Cp,Bs,Ip,Gs,Pp,Pi,Go,qs,Dp;const Dn=class{constructor(e){S(this,Ii);S(this,Vs);S(this,Bs);g(this,"metadata",{});g(this,"video");g(this,"canvas");g(this,"nonBlackPixelLumaThreshold");g(this,"identicalFrameSsimThreshold");g(this,"previousFrame",new Uint8ClampedArray);S(this,Ci,void 0);g(this,"track");g(this,"analysing");S(this,Or,void 0);S(this,sn,void 0);g(this,"preview");const{nonBlackPixelLumaThreshold:r,identicalFrameSsimThreshold:n,media:i}={...nO,...e};this.nonBlackPixelLumaThreshold=r,this.identicalFrameSsimThreshold=n,this.analysing=!1,w(this,Or,i),this.preview=!1}setTrack(e){var i,s,a;(i=this.track)==null||i.stop(),this.track=e;const{height:r,width:n}=(a=(s=this.track)==null?void 0:s.getConstraints())!=null?a:{};if(this.metadata.resolution=[n,r],d(this,Or)==="screenshare"){P.emit(I.SCREENSHARE_VIDEO_TRACK_CREATED);return}P.emit(I.VIDEO_TRACK_CREATED)}getTrackMetadata(){return this.track?(this.metadata.label=this.track.label,this.metadata):null}async startTrackAnalysis(){var e;return!this.track||this.analysing?!1:(!this.video&&!((e=this.video)!=null&&e.src)&&(w(this,sn,new MediaStream),d(this,sn).addTrack(this.track),this.video=document.createElement("video"),this.canvas=document.createElement("canvas"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),[this.video.width,this.video.height]=this.metadata.resolution,this.video.srcObject=d(this,sn)),window.requestAnimationFrame(W(this,Ii,Bo).bind(this)),this.analysing=!0,!0)}stopTrackAnalysis(){this.analysing&&(this.analysing=!1,clearTimeout(d(this,Ci)))}cleanup(){var e;if(this.stopTrackAnalysis(),(e=this.track)==null||e.stop(),this.track=void 0,w(this,sn,void 0),this.video&&(this.video.srcObject=void 0,this.video=void 0),this.canvas=void 0,this.previousFrame=new Uint8ClampedArray,d(this,Or)==="screenshare"){P.emit(I.SCREENSHARE_VIDEO_TRACK_CLOSED);return}P.emit(I.VIDEO_TRACK_CLOSED)}};let Xr=Dn;Ci=new WeakMap,Or=new WeakMap,sn=new WeakMap,Ii=new WeakSet,Bo=function(){var e;try{const r=W(this,Vs,Cp).call(this),n=W(this,Bs,Ip).call(this,r.data,r.data.length),i=W(e=Dn,Gs,Pp).call(e,this.previousFrame,r.data);this.previousFrame=r.data;const s={isBlackFrame:n,videoScore:i,isFrozenFrame:i>this.identicalFrameSsimThreshold,timestamp:new Date().getTime()};d(this,Or)==="screenshare"?P.emit(I.SCREENSHARE_VIDEO_TRACK_ANALYSIS,s):P.emit(I.VIDEO_TRACK_ANALYSIS,s),w(this,Ci,setTimeout(()=>{this.track&&window.requestAnimationFrame(W(this,Ii,Bo).bind(this))},3e3))}catch(r){d(this,Or)==="screenshare"?P.emit(I.SCREENSHARE_VIDEO_TRACK_ANALYSIS_ERROR):P.emit(I.VIDEO_TRACK_ANALYSIS_ERROR)}},Vs=new WeakSet,Cp=function(){var r,n;this.canvas.width=(r=this.video)==null?void 0:r.width,this.canvas.height=(n=this.video)==null?void 0:n.height;const e=this.canvas.getContext("2d",{willReadFrequently:!0});return e.drawImage(this.video,0,0,this.canvas.width,this.canvas.height),e.getImageData(0,0,this.canvas.width,this.canvas.height)},Bs=new WeakSet,Ip=function(e,r){const n=this.nonBlackPixelLumaThreshold;let i=0;for(let s=4;s<r;s+=4)if(i+=.21*e[s]+.72*e[s+1]+.07*e[s+2],i>n*(s/4))return!1;return!0},Gs=new WeakSet,Pp=function(e,r){var Z,K,ve;if(e.length!==r.length)return 0;const n=.01,i=.03,s=255,a=n*s*(n*s),o=i*s*(i*s),c=o/2,u=W(Z=Dn,Pi,Go).call(Z,e),h=u.mean,f=u.variance,m=Math.sqrt(f),T=W(K=Dn,Pi,Go).call(K,r),A=T.mean,C=T.variance,R=Math.sqrt(C),b=W(ve=Dn,qs,Dp).call(ve,e,r,h,A),D=(2*h*A+a)/(h*h+A*A+a),H=(b+c)/(m*R+c),k=(2*m*R+o)/(f+C+o);return D*k*H},Pi=new WeakSet,Go=function(e){let r=0,n;for(n=0;n<e.length;n++)r+=e[n];const i=r/(e.length-1);let s=0;for(n=1;n<e.length;n++)s=e[n-1]-i,r+=e[n]+s*s;return{mean:i,variance:r/e.length}},qs=new WeakSet,Dp=function(e,r,n,i){let s=0;for(let a=0;a<e.length;a+=1)s+=(e[a]-n)*(r[a]-i);return s/e.length},S(Xr,Gs),S(Xr,Pi),S(Xr,qs);const pt=new Xr,gi=new Xr({media:"screenshare"});var iO=Object.defineProperty,sO=Object.getOwnPropertyDescriptor,be=(t,e,r,n)=>{for(var i=n>1?void 0:n?sO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&iO(e,r,i),i},Cr=(t=>(t.OFF_STAGE="OFF_STAGE",t.REQUESTED_TO_JOIN_STAGE="REQUESTED_TO_JOIN_STAGE",t.ACCEPTED_TO_JOIN_STAGE="ACCEPTED_TO_JOIN_STAGE",t.ON_STAGE="ON_STAGE",t))(Cr||{}),Vn,xt,Bn,an,_l;let _e=(_l=class extends kp{constructor(e,r,n,i,s){var a;super();g(this,"id");g(this,"name");g(this,"picture");g(this,"customParticipantId");g(this,"waitlistStatus");S(this,Vn,void 0);S(this,xt,void 0);S(this,Bn,void 0);g(this,"role");g(this,"userId");g(this,"organizationId");g(this,"supportsRemoteControl",!1);g(this,"device");S(this,an,void 0);g(this,"presetName");g(this,"roomState","init");g(this,"roomJoined",!1);this.id=e,this.userId=r.id,this.name=r.name,this.picture=r.picture,this.customParticipantId=(a=r.customParticipantId)!=null?a:r.clientSpecificId,this.waitlistStatus="none",w(this,xt,n),w(this,Vn,i),w(this,Bn,!1),this.organizationId=r.organizationId,this.supportsRemoteControl=le.isElectron(),this.device=le.getDeviceInfo(),this.presetName=s,i.viewType!==st.Chat&&this.updatePermission()}get clientSpecificId(){return this.customParticipantId}get stageStatus(){return d(this,an)}static async __init__(){var h,f,m,T,A;const e=(f=(h=B.defaults)==null?void 0:h.audio)!=null?f:!0,r=(T=(m=B.defaults)==null?void 0:m.video)!=null?T:!0,n=qe.v4(),i={id:qe.v4(),name:fi.faker.person.fullName(),email:"",picture:fi.faker.image.avatar(),loggedIn:!0,scope:["test"],clientSpecificId:"mock_self",customParticipantId:"mock_self",organizationId:qe.v4()},s=$o.default(st.GroupCall,!1),a=Uo.default(),o="group_call_host",c=new _e(n,i,s,a,o);if(a.viewType===st.Chat)return c;const u=wD(a.mediaConstraints);return Mf(u,(A=B.defaults)==null?void 0:A.mediaConfiguration),await c.init({audio:e,video:r,constraints:u},!1),c.setupEvents(),c}setupEvents(){P.on(I.ROOM_NODE_CONNECTED,async({wasDisconnected:e,wasJoinAttempted:r})=>{e&&await this.resetSelf(r)}),P.onAsync(I.SET_STAGE_STATUS,async e=>{switch(w(this,an,e),e){case"ACCEPTED_TO_JOIN_STAGE":this.emit("joinStageRequestAccepted");break;case"REQUESTED_TO_JOIN_STAGE":this.emit("peerRequestToJoinStage");break;case"OFF_STAGE":this.emit("stageLeft");break}}),P.on(I.STOPPED_PRESENTING,()=>{this.localMediaHandler.destruct(),this.setWebinarStageStatus("OFF_STAGE"),this.emit("stageLeft")}),this.localMediaHandler.on("AUDIO_TRACK_CHANGE",async()=>{P.emit(I.AUDIO_TRACK_CHANGED),p.info("DyteSelf::setupEvents::AUDIO_TRACK_CHANGE",{...zr(this)}),this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack})}),this.localMediaHandler.on("VIDEO_TRACK_CHANGE",async()=>{P.emit(I.VIDEO_TRACK_CHANGED),p.info("DyteSelf::setupEvents::VIDEO_TRACK_CHANGE",{...zr(this)}),this.roomJoined&&this.rawVideoTrack===void 0?(p.info("DyteSelf::VIDEO_TRACK_CHANGE::Forcing_disable_video"),this.disableVideo()):this.videoEnabled&&this.roomJoined,this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack})}),this.localMediaHandler.on("DEVICE_CHANGE",async({device:e})=>{this.emit("deviceUpdate",{device:e})}),this.localMediaHandler.on("DEVICE_LIST_UPDATED",e=>{this.emit("deviceListUpdate",e)}),this.localMediaHandler.on("SCREENSHARE_TRACK_CHANGE",async()=>{if(P.emit(I.SCREENSHARE_TRACK_CHANGED),!this.roomJoined){p.error("DyteSelf.SCREENSHARE_TRACK_CHANGE.LocalMediaInitialized_WithoutRoomNode");return}p.info("DyteSelf::setupEvents::SCREENSHARE_TRACK_CHANGE",{...zr(this)}),this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks})}),this.localMediaHandler.on("SCREENSHARE_ENDED",async()=>{await this.disableScreenShare(),p.info("DyteSelf::setupEvents::SCREENSHARE_ENDED",{...zr(this)})}),this.localMediaHandler.on("AUDIO_TRACK_SILENT",()=>{}),this.localMediaHandler.on("FORCE_MUTE_AUDIO",()=>{this.disableAudio()})}get permissions(){return d(this,xt)}get suggestedTheme(){return d(this,Vn)}get config(){return d(this,Vn)}setName(e){if(!e)throw new E("Name cannot be empty.");this.name=e}async setupTracks(e={}){var r,n;return e.forceReset&&this.localMediaHandler.removeAllTracks(),this.localMediaHandler.setupStreams({video:(r=e.video)!=null?r:!0,audio:(n=e.audio)!=null?n:!0})}async resetSelf(e){}async destructMediaHandler(){return this.localMediaHandler.destruct()}async removeDocumentEventListeners(){return this.localMediaHandler.removeDocumentEventListeners()}async enableAudio(){if(this.permissions.canProduceAudio!==Jr.notAllowed&&!(d(this,xt).canProduceAudio===Jr.canRequest&&(this.stageStatus==="OFF_STAGE"||this.stageStatus==="REQUESTED_TO_JOIN_STAGE"))&&!this.audioEnabled&&(await this.localMediaHandler.enableAudio(),!(this.roomJoined&&(this.permissions.mediaRoomType!=="HIVE"||this.stageStatus==="ON_STAGE")&&(this.audioTrack,!this.audioEnabled)))){this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack});try{Zt.setTrack(this.rawAudioTrack)}catch(e){p.error("Troubleshooter::micTest::Error while setting track",{error:e})}}}async enableVideo(){var e;if(d(this,xt).canProduceVideo!==Jr.notAllowed&&!(d(this,xt).canProduceVideo===Jr.canRequest&&(this.stageStatus==="OFF_STAGE"||this.stageStatus==="REQUESTED_TO_JOIN_STAGE"))&&!this.videoEnabled){await this.localMediaHandler.enableVideo(),this.roomJoined&&(this.permissions.mediaRoomType!=="HIVE"||this.stageStatus),this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack}),p.info("DyteSelf.enableVideo",{...zr(this)});try{pt.setTrack((e=this.videoTrack)==null?void 0:e.clone())}catch(r){p.error("Troubleshooter::camTest::Error while setting track",{error:r})}}}async updateVideoConstraints(e){if(!this.localMediaHandler.updateVideoConstraints)throw new E("Unsupported");await this.localMediaHandler.updateVideoConstraints(e)}async enableScreenShare(){var e;if(!this.roomJoined)throw new E("Can`t enable screenshare without joining room");if(d(this,xt).canProduceScreenshare!==Jr.notAllowed&&!(d(this,xt).canProduceScreenshare===Jr.canRequest&&(this.stageStatus==="OFF_STAGE"||this.stageStatus==="REQUESTED_TO_JOIN_STAGE"))&&!this.screenShareEnabled){if(await this.localMediaHandler.enableScreenShare(),this.screenShareTracks.audio||this.screenShareTracks.video,this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks}),this.screenShareTracks.audio)try{mi.setTrack(this.screenShareTracks.audio)}catch(r){p.error("Troubleshooter::screenshareMicTest::Error while setting track",{error:r})}if(this.screenShareTracks.video)try{gi.setTrack((e=this.screenShareTracks.video)==null?void 0:e.clone())}catch(r){p.error("Troubleshooter::screenshareCamTest::Error while setting track",{error:r})}}}async updateScreenshareConstraints(e){if(!this.localMediaHandler.updateScreenshareConstraints)throw new E("Unsupported");await this.localMediaHandler.updateScreenshareConstraints(e)}async disableAudio(){this.audioEnabled&&(this.localMediaHandler.disableAudio(),this.roomJoined,this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack}))}async disableVideo(){this.videoEnabled&&(await this.localMediaHandler.disableVideo(),this.roomJoined,!("isDeprecated"in this.localMediaHandler&&this.mediaPermissions.video!=="ACCEPTED")&&(this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack}),pt.preview||pt.cleanup()))}async disableScreenShare(){this.screenShareEnabled&&(await this.localMediaHandler.disableScreenShare(),this.roomJoined,this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks}),gi.cleanup(),mi.cleanup())}getAllDevices(){return this.localMediaHandler.getAllDevices()}setIsPinned(e,r=!0){w(this,Bn,e);const n=e?"pinned":"unpinned";r&&this.emit(n,this)}get isPinned(){return d(this,Bn)}get webinarStageStatus(){return d(this,an)}async pin(){if(!this.roomJoined)throw new E("Can`t pin participants without joining room")}async unpin(){if(!this.roomJoined)throw new E("Can`t unpin participants without joining room")}async setDevice(e){var i,s,a;if(!e)throw new E("No device selected");const r={added:[e],removed:[]},n=this.getCurrentDevices();if(e.deviceId&&(((i=n==null?void 0:n.audio)==null?void 0:i.deviceId)===e.deviceId||((s=n==null?void 0:n.video)==null?void 0:s.deviceId)===e.deviceId||((a=n==null?void 0:n.speaker)==null?void 0:a.deviceId)===e.deviceId)&&p.warn("DyteSelf.setDevice.setting_to_in_use_device",{devices:[e]}),"isDeprecated"in this.localMediaHandler){await this.localMediaHandler.onDeviceChange(r,!0);return}switch(e.kind){case"audioinput":try{await this.localMediaHandler.setAudioDevice(e)}catch(o){this.roomJoined,this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack})}break;case"audiooutput":await this.localMediaHandler.setSpeakerDevice(e);break;case"videoinput":try{await this.localMediaHandler.setVideoDevice(e)}catch(o){this.roomJoined,this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack})}break}}cleanUpTracks(){var e,r,n,i;(e=this.audioTrack)==null||e.stop(),(r=this.rawAudioTrack)==null||r.stop(),(n=this.videoTrack)==null||n.stop(),(i=this.rawVideoTrack)==null||i.stop()}async requestToJoinStage(){P.emitAsync(I.REQUEST_TO_JOIN_STAGE)}async withdrawRequestToJoinStage(){P.emitAsync(I.WITHDRAW_REQUEST_TO_JOIN_STAGE)}async leaveStage(){P.emitAsync(I.LEAVE_STAGE)}async joinStage(){P.emitAsync(I.JOIN_STAGE)}setWebinarStageStatus(e){switch(w(this,an,e),P.emit(I.SET_WEBINAR_STAGE_STATUS,e),e){case"ACCEPTED_TO_JOIN_STAGE":this.emit("joinStageRequestAccepted");break;case"REQUESTED_TO_JOIN_STAGE":this.emit("peerRequestToJoinStage");break;case"OFF_STAGE":this.emit("stageLeft");break}}async disablePreview(){return this}},Vn=new WeakMap,xt=new WeakMap,Bn=new WeakMap,an=new WeakMap,_l);be([v.trace("DyteSelf.setupEvents")],_e.prototype,"setupEvents",1);be([v.trace("DyteSelf.setupTracks")],_e.prototype,"setupTracks",1);be([v.trace("DyteSelf.resetSelf")],_e.prototype,"resetSelf",1);be([v.trace("DyteSelf.destructMediaHandler")],_e.prototype,"destructMediaHandler",1);be([v.trace("DyteSelf.removeDocumentEventListeners")],_e.prototype,"removeDocumentEventListeners",1);be([Mt.executeWithLock({methodName:"meeting.self.enableAudio",lockName:"DyteSelf.toggleAudio",timeout:3e3}),v.trace("DyteSelf.enableAudio")],_e.prototype,"enableAudio",1);be([Mt.executeWithLock({methodName:"meeting.self.enableVideo",lockName:"DyteSelf.toggleVideo",timeout:3e3}),v.trace("DyteSelf.enableVideo")],_e.prototype,"enableVideo",1);be([v.trace("DyteSelf.updateVideoConstraints")],_e.prototype,"updateVideoConstraints",1);be([v.trace("DyteSelf.enableScreenShare"),Mt.executeWithLock({methodName:"meeting.self.enableScreenShare",lockName:"DyteSelf.toggleScreenShare",timeout:3e3})],_e.prototype,"enableScreenShare",1);be([v.trace("DyteSelf.updateScreenshareConstraints")],_e.prototype,"updateScreenshareConstraints",1);be([Mt.executeWithLock({methodName:"meeting.self.disableAudio",lockName:"DyteSelf.toggleAudio",timeout:3e3}),v.trace("DyteSelf.disableAudio")],_e.prototype,"disableAudio",1);be([Mt.executeWithLock({methodName:"meeting.self.disableVideo",lockName:"DyteSelf.toggleVideo",timeout:3e3}),v.trace("DyteSelf.disableVideo")],_e.prototype,"disableVideo",1);be([Mt.executeWithLock({methodName:"meeting.self.disableScreenShare",lockName:"DyteSelf.toggleScreenShare",timeout:3e3}),v.trace("DyteSelf.disableScreenShare")],_e.prototype,"disableScreenShare",1);be([v.trace("DyteSelf.setDevice")],_e.prototype,"setDevice",1);be([v.trace("DyteSelf.requestToJoinStage")],_e.prototype,"requestToJoinStage",1);be([v.trace("DyteSelf.withdrawRequestToJoinStage")],_e.prototype,"withdrawRequestToJoinStage",1);be([v.trace("DyteSelf.leaveStage")],_e.prototype,"leaveStage",1);be([v.trace("DyteSelf.joinStage")],_e.prototype,"joinStage",1);be([v.trace("DyteSelf.deprecated.disablePreview")],_e.prototype,"disablePreview",1);_e=be([xe(t=>{throw new E(t.message,"1100")})],_e);var aO=Object.defineProperty,oO=Object.getOwnPropertyDescriptor,Ar=(t,e,r,n)=>{for(var i=n>1?void 0:n?oO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&aO(e,r,i),i},Gn,on,Lt,vl;let Pt=(vl=class extends ht{constructor(e,r){super();g(this,"id");g(this,"userId");g(this,"name");g(this,"picture");g(this,"isHost");g(this,"customParticipantId");g(this,"flags");g(this,"device");g(this,"videoTrack");g(this,"audioTrack");g(this,"screenShareTracks");g(this,"videoEnabled");g(this,"audioEnabled");g(this,"screenShareEnabled");g(this,"producers");S(this,Gn,void 0);g(this,"supportsRemoteControl",!1);S(this,on,void 0);g(this,"presetName");S(this,Lt,void 0);const{id:n,userId:i,displayName:s,device:a,picture:o,isHost:c,flags:u,clientSpecificId:h,stageStatus:f,customParticipantId:m,audioMuted:T,audioTrack:A,videoEnabled:C=!1,videoTrack:R,producers:b,metadata:D}=e;this.id=n,this.userId=i,this.name=s,this.device=a,this.picture=o,this.isHost=c,this.flags=u,w(this,on,f!=null?f:Cr.ON_STAGE),this.customParticipantId=m!=null?m:h,this.audioEnabled=!T,this.audioTrack=A,this.videoEnabled=C,this.videoTrack=R,this.screenShareTracks={audio:void 0,video:void 0},this.producers=b!=null?b:[],this.presetName=D==null?void 0:D.preset_name,w(this,Gn,!1),w(this,Lt,r),this.setupEvents()}get clientSpecificId(){return this.customParticipantId}get webinarStageStatus(){return d(this,on)}get stageStatus(){return d(this,on)}get roomJoined(){return d(this,Lt).roomJoined}setVideoEnabled(e,r=!0){this.videoEnabled=e,r&&(p.info("DyteParticipant::setVideoEnabled::videoUpdate",{...zr(this)}),this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack}))}setAudioEnabled(e,r=!0){this.audioEnabled=e,r&&(p.info("DyteParticipant::setAudioEnabled::audioUpdate",{...zr(this)}),this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack}))}setScreenShareEnabled(e,r=!0){this.screenShareEnabled=e,r&&this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks})}setupEvents(){P.onAsync(I.UPDATE_PEER_STAGE_STATUS,async({id:e,status:r})=>{e===this.id&&r!==this.stageStatus&&this.setStageStatus(r)})}async pin(){if(!this.roomJoined)throw new E("Can`t pin participant without joining room");if(!d(this,Lt).permissions.pinParticipant)throw new E("You do not have permission to pin participants.")}async unpin(){if(!this.roomJoined)throw new E("Can`t unpin participant without joining room");if(!d(this,Lt).permissions.pinParticipant)throw new E("You do not have permission to unpin participants.")}setIsPinned(e,r=!0){w(this,Gn,e);const n=e?"pinned":"unpinned";r&&this.emit(n,this)}async disableAudio(){const e=this.id;if(p.info("DyteParticipant::disable_audio",{dyteParticipant:{id:e}}),!this.roomJoined)throw new E("Can`t disable participant audio without joining room");if(!d(this,Lt).permissions.canDisableParticipantAudio)throw p.error("DyteParticipant::unauthorized_disable_audio",{dyteParticipant:{id:e}}),new E("Unauthorized: User does not have permission to disable participant audio.")}async kick(){const e=this.id;if(p.info("DyteParticipant::kick",{dyteParticipant:{id:e}}),!this.roomJoined)throw new E("Can`t kick participant without joining room");if(d(this,Lt).permissions.kickParticipant){await P.emitAsync(I.KICK_PEER,{peerId:e});return}throw p.error("DyteParticipant::unauthorized_kick",{dyteParticipant:{id:e}}),new E("Unauthorized: User does not have permission to kick participants.")}async disableVideo(){const e=this.id;if(p.info("DyteParticipant::disable_video",{dyteParticipant:{id:e}}),!this.roomJoined)throw new E("Can`t disable participant video without joining room");if(!d(this,Lt).permissions.canDisableParticipantVideo)throw p.error("DyteParticipant::unauthorized_disable_video",{dyteParticipant:{id:e}}),new E("Unauthorized: User does not have permission to disable participant video.")}async acceptJoinStageRequest(){P.emitAsync(I.ACCEPT_JOIN_STAGE_REQUEST,{userId:this.userId})}async rejectRequestToJoinStage(){P.emitAsync(I.REJECT_REQUEST_TO_JOIN_STAGE,{userId:this.userId})}async getPermissions(){return{}}async removeFromStage(){P.emitAsync(I.REMOVE_FROM_STAGE,{userId:this.userId})}setStageStatus(e){w(this,on,e);let r;e===Cr.OFF_STAGE&&(r="peerStoppedPresenting"),e===Cr.ON_STAGE&&(r="peerStartedPresenting"),e===Cr.ACCEPTED_TO_JOIN_STAGE&&(r="peerAcceptedToJoinStage"),e===Cr.REQUESTED_TO_JOIN_STAGE&&(P.emit(I.NEW_STAGE_REQUEST,{count:1}),r="peerRequestToJoinStage"),r&&this.emit(r,this),this.emit("stageStatusUpdate",this)}setWebinarStageStatus(e){this.setStageStatus(e)}get isPinned(){return d(this,Gn)}},Gn=new WeakMap,on=new WeakMap,Lt=new WeakMap,vl);Ar([v.trace("DyteParticipant.disableAudio")],Pt.prototype,"disableAudio",1);Ar([v.trace("DyteParticipant.kick")],Pt.prototype,"kick",1);Ar([v.trace("DyteParticipant.disableVideo")],Pt.prototype,"disableVideo",1);Ar([v.trace("DyteParticipant.acceptJoinStageRequest")],Pt.prototype,"acceptJoinStageRequest",1);Ar([v.trace("DyteParticipant.rejectRequestToJoinStage")],Pt.prototype,"rejectRequestToJoinStage",1);Ar([v.trace("DyteParticipant.getPermissions")],Pt.prototype,"getPermissions",1);Ar([v.trace("DyteParticipant.removeFromStage")],Pt.prototype,"removeFromStage",1);Ar([v.trace("DyteParticipant.setStageStatus")],Pt.prototype,"setStageStatus",1);Pt=Ar([xe(t=>{throw new E(t.message,"1200")})],Pt);var ye,cn;class Op extends Map{constructor(r){const{onAddEvent:n,onDeleteEvent:i,onClearEvent:s}=r;super();S(this,ye,void 0);S(this,cn,void 0);g(this,"onAddEvent");g(this,"onDeleteEvent");g(this,"onClearEvent");w(this,ye,new wr),this.onAddEvent=n,this.onDeleteEvent=i,this.onClearEvent=s,w(this,cn,new Map)}emit(r,...n){return d(this,ye).emit(r,...n)}on(r,n){return d(this,ye).on(r,n)}addListener(r,n){return d(this,ye).addListener(r,n)}off(r,n){return d(this,ye).off(r,n)}once(r,n){return d(this,ye).once(r,n)}prependListener(r,n){return d(this,ye).prependListener(r,n)}prependOnceListener(r,n){return d(this,ye).prependOnceListener(r,n)}removeListener(r,n){return d(this,ye).removeListener(r,n)}removeAllListeners(r){return d(this,ye).removeAllListeners(r)}listeners(r){return d(this,ye).listeners(r)}listenerCount(r){return d(this,ye).listenerCount(r)}getMaxListeners(){return d(this,ye).getMaxListeners()}setMaxListeners(r){return d(this,ye).setMaxListeners(r)}eventNames(){return d(this,ye).eventNames()}add(r,n=!0){return this.set(r.id,r,n)}set(r,n,i=!0){const s=super.set(r,n),a=(o,...c)=>{this.emit(o,n,...c)};return d(this,cn).set(r,a),n.on("*",a),i&&d(this,ye).emit(this.onAddEvent,n),s}delete(r,n=!0,i=!1){const s=this.get(r);if(!s)return!1;s.removeListener("*",d(this,cn).get(r));const a=super.delete(r);return i&&s.removeAllListeners(),n&&d(this,ye).emit(this.onDeleteEvent,s),a}clear(r=!0,n=!1){this.forEach(s=>{s.removeListener("*",d(this,cn).get(s.id)),n&&s.removeAllListeners()});const i=super.clear();return r&&d(this,ye).emit(this.onClearEvent),i}toArray(){return Array.from(this.values())}}ye=new WeakMap,cn=new WeakMap;class ns extends Op{constructor(e){const{onAddEvent:r="participantJoined",onDeleteEvent:n="participantLeft",onClearEvent:i="participantsCleared"}=e!=null?e:{};super({onAddEvent:r,onDeleteEvent:n,onClearEvent:i})}add(e,r=!0){return this.has(e.id)&&Object.is(this.get(e.id),e)===!1&&this.delete(e.id),super.add(e,r)}clear(e=!0,r=!1){return super.clear(e,r)}delete(e,r=!0,n=!1){return super.delete(e,r,n)}}class cO{constructor(){g(this,"_orderedArray");g(this,"_map");this._map=new Map,this._orderedArray=[]}add(e,r){if(!this._map.has(e))return this._map.set(e,{peerId:e,priority:r}),this._orderedArray.splice(Math.max(r-1,0),0,e),this.index(e);const n=this.index(e);this.delete(e);const i=this.add(e,r);return n!==i?(p.info("DyteSelectedPeer::add()::new_position_for_active_speaker",{selectedPeer:{oldIndex:n,newIndex:i}}),i):-1}delete(e){if(this._map.has(e)){const r=this.index(e);this._map.delete(e),this._orderedArray.splice(r,1)}}index(e){return this._map.has(e)?this._orderedArray.indexOf(e):-1}[Symbol.iterator](){return this._orderedArray[Symbol.iterator]()}}class dO{constructor(){g(this,"_activeSpeakerPeers");g(this,"_compulsoryPeers");this._activeSpeakerPeers=new cO,this._compulsoryPeers=new Set}add(e,r){if(r<0)return this._compulsoryPeers.add(e),0;if(this.compulsoryPeers.includes(e)&&(r>0||r===246267631)){if(p.info("DyteSelectedPeer::removing_compulsory_peer",{selectedPeer:{peerId:e}}),this._removeFromCompulsoryPeer(e),r===246267631)return-1}else if(r===229490415)return this.delete(e),-1;return this._activeSpeakerPeers.add(e,r)}delete(e){p.info("DyteSelectedPeer::deleting_peer_from_selectedPeer",{selectedPeer:{peerId:e}}),this._removeFromCompulsoryPeer(e),this._activeSpeakerPeers.delete(e)}index(e){return this._activeSpeakerPeers.index(e)}get peers(){return Array.from(new Set(this.compulsoryPeers.concat(this.activeSpeakerPeers)))}get compulsoryPeers(){return Array.from(this._compulsoryPeers.values())}get peerPriorities(){return Array.from(this._activeSpeakerPeers).map((e,r)=>r)}get activeSpeakerPeers(){return Array.from(this._activeSpeakerPeers)}_removeFromCompulsoryPeer(e){this._compulsoryPeers.delete(e)}}var Mr;class uO extends wr{constructor(){super();S(this,Mr,void 0);w(this,Mr,new Map)}__set(r,n){return d(this,Mr).set(r,n)}__clear(){return d(this,Mr).clear()}get(r){return d(this,Mr).get(r)}toArray(){return Array.from(d(this,Mr).values())}}Mr=new WeakMap;const lO={setup_screen:{is_enabled:!1},alone_here:{is_enabled:!1},waiting_room:{is_enabled:!1,enable_preview:!0},control_bar:{is_enabled:!0,elements:{plugins:!0,screenshare:!0,invite:!1,participants:!0,chat:!0,reactions:!1,polls:!0,fullscreen:!0,layout:!0}},header:{is_enabled:!0,elements:{logo:"",timer:!0,title:!0,participant_count:!0,change_layout:!0}},pip_mode:!0,auto_tune:!0,grid:{multi:{max_video_count:9,video_fit:"cover"},single:{max_video_count:6,video_fit:"cover"},default_view:"MULTI"},colors:{primary:"#2160FD",secondary:"#1A1A1A",text:"#EEEEEE",background:"#1A1A1A",text_primary:"#EEEEEE",video_background:"#1A1A1A"},controls:{pip_toggle:!1},plugins:[]},hO=Tt(lO);var Me,qn,Hn,Di,Oi;const Hs=class{constructor(e){S(this,Me,void 0);S(this,qn,void 0);S(this,Hn,void 0);S(this,Di,void 0);S(this,Oi,[]);if(!e)throw new E("Could not load preset theme.");w(this,Me,e),w(this,qn,1),w(this,Hn,st.GroupCall)}static fromResponse(e){return new Hs(e)}static default(){return new Hs(hO)}configFromPermissions(e){var r,n,i,s,a,o,c,u,h,f,m,T;w(this,qn,e.maxScreenshareCount||1),w(this,Hn,e.viewType),w(this,Di,{audio:{enableHighBitrate:!1,enableStereo:!1},video:{quality:(i=(n=(r=e==null?void 0:e.produce)==null?void 0:r.video)==null?void 0:n.quality)!=null?i:Ye.video.quality,frameRate:(o=(a=(s=e==null?void 0:e.produce)==null?void 0:s.video)==null?void 0:a.frameRate)!=null?o:Ye.video.frameRate},screenshare:{quality:(h=(u=(c=e==null?void 0:e.produce)==null?void 0:c.screenshare)==null?void 0:u.quality)!=null?h:Ye.screenshare.quality,frameRate:(T=(m=(f=e==null?void 0:e.produce)==null?void 0:f.screenshare)==null?void 0:m.frameRate)!=null?T:Ye.screenshare.frameRate}})}setDisabledPlugins(e){const r=d(this,Me).plugins;r&&r.length>0&&w(this,Oi,e.filter(n=>!r.includes(n)))}get setupScreen(){return d(this,Me).setupScreen}get aloneHere(){return d(this,Me).aloneHere}get waitingRoom(){return d(this,Me).waitingRoom}get controlBar(){return d(this,Me).controlBar}get header(){return d(this,Me).header}get pipMode(){var e;return((e=d(this,Me).controls)==null?void 0:e.pipToggle)||d(this,Me).pipMode}get viewType(){return d(this,Hn)}get autoTune(){return d(this,Me).autoTune}get grid(){return d(this,Me).grid}get maxVideoStreams(){return{mobile:this.grid.multi.maxVideoCount>6?6:this.grid.multi.maxVideoCount,desktop:this.grid.multi.maxVideoCount}}get maxScreenShareCount(){return d(this,qn)}get colors(){return d(this,Me).colors}get controls(){return d(this,Me).controls}get plugins(){return d(this,Me).plugins}get disabledPlugins(){return d(this,Oi)}get mediaConstraints(){return d(this,Di)}get isV2(){return!1}};let qo=Hs;Me=new WeakMap,qn=new WeakMap,Hn=new WeakMap,Di=new WeakMap,Oi=new WeakMap;function fO(t,e=2){return t.replace(/[^\u00BF-\u1FFF\u2C00-\uD7FF\w\s]/g,"").trim().split(/\s+/).slice(0,e).map(i=>i.charAt(0)).join("").toUpperCase()}const Xu=1080,Qu=1920,pO=(t,e,r,n,i,s)=>{let a=.5,o=.5;const c=i,u=s,h=Math.min(r/c,n/u);let f=c*h,m=u*h,T,A,C,R,b=1;return f<r&&(b=r/f),Math.abs(b-1)<1e-14&&m<n&&(b=n/m),f*=b,m*=b,C=c/(f/r),R=u/(m/n),T=(c-C)*a,A=(u-R)*o,T<0&&(T=0),A<0&&(A=0),C>c&&(C=c),R>u&&(R=u),[T,A,C,R,t,e,r,n]};var St,$e,ir,he,$t,sr,gt,fe;class mO extends ht{constructor(r){var n,i,s,a,o,c,u,h;super();S(this,St,void 0);S(this,$e,void 0);S(this,ir,void 0);S(this,he,{height:Xu,width:Qu});S(this,$t,{brand:"#2160FD",background:"#141414",videoBackground:"#191919",textOnBrand:"#EEEEEE"});S(this,sr,void 0);S(this,gt,{});S(this,fe,void 0);g(this,"cleanupEventListeners",()=>{d(this,fe).removeListener("stageJoined",this.enablePipMediaControls),d(this,fe).removeListener("stageLeft",this.unmountEvents),d(this,fe).removeListener("videoUpdate",this.onSelfVideoUpdateListener),d(this,fe).removeListener("audioUpdate",this.onSelfAudioUpdateListener),d(this,fe).removeListener("roomLeft",this.disable)});g(this,"enablePipMediaControls",()=>{this.mountAudioEvents(),this.mountVideoEvents()});g(this,"onSelfVideoUpdateListener",({videoEnabled:r})=>{this.updateMediaSession("CAMERA",r)});g(this,"onSelfAudioUpdateListener",({audioEnabled:r})=>{this.updateMediaSession("MIC",r)});g(this,"eventCallback",r=>{r==="CAMERA"&&(d(this,fe).videoEnabled?d(this,fe).disableVideo():d(this,fe).enableVideo(),this.emit("cameraToggled")),r==="MIC"&&(d(this,fe).audioEnabled?d(this,fe).disableAudio():d(this,fe).enableAudio(),this.emit("micToggled")),r==="END"&&(P.emit(I.PIP_HANGUP),this.cleanupEventListeners(),this.emit("hangup"),this.cleanup())});g(this,"unmountEvents",()=>{navigator.mediaSession===void 0||navigator.mediaSession.setCameraActive===void 0||(navigator.mediaSession.setActionHandler("togglemicrophone",void 0),navigator.mediaSession.setActionHandler("togglecamera",void 0))});g(this,"animate",()=>{d(this,gt)!==void 0&&this.paintCanvas(),d(this,sr)!==void 0&&w(this,sr,requestAnimationFrame(()=>this.animate()))});g(this,"disable",()=>{this.cleanupEventListeners(),cancelAnimationFrame(d(this,sr)),document.body.removeChild(d(this,$e)),w(this,sr,void 0),document.exitPictureInPicture()});if(w(this,fe,r),r.config.isV2===!0)w(this,$t,{brand:r.config.designTokens.colors.brand[500],background:r.config.designTokens.colors.background[1e3],videoBackground:r.config.designTokens.colors.videoBg,textOnBrand:r.config.designTokens.colors.textOnBrand});else if(r.config.isV2===!1){const f=qo.default();w(this,$t,{brand:(i=(n=r.config.colors)==null?void 0:n.primary)!=null?i:f.colors.primary,background:(a=(s=r.config.colors)==null?void 0:s.background)!=null?a:f.colors.background,videoBackground:(c=(o=r.config.colors)==null?void 0:o.videoBackground)!=null?c:f.colors.videoBackground,textOnBrand:(h=(u=r.config.colors)==null?void 0:u.textPrimary)!=null?h:f.colors.textPrimary})}}createVideoContainer(){w(this,$e,document.createElement("div")),d(this,$e).style.width="0.1px",d(this,$e).style.height="0.1px",d(this,$e).style.overflow="hidden",d(this,$e).style.position="absolute",d(this,$e).style.bottom="0",d(this,$e).style.right="0",d(this,$e).style.opacity="0",d(this,$e).appendChild(d(this,ir))}setupEventListeners(){d(this,fe).addListener("stageJoined",this.enablePipMediaControls),d(this,fe).addListener("stageLeft",this.unmountEvents),d(this,fe).addListener("videoUpdate",this.onSelfVideoUpdateListener),d(this,fe).addListener("audioUpdate",this.onSelfAudioUpdateListener),d(this,fe).addListener("roomLeft",this.disable)}createCanvas(){const r=document.createElement("canvas");r.height=d(this,he).height,r.width=d(this,he).width,w(this,St,r)}setupMediaSessionEvents(){navigator.mediaSession===void 0||navigator.mediaSession.setCameraActive===void 0||(navigator.mediaSession.setActionHandler("hangup",()=>{this.eventCallback("END")}),this.mountAudioEvents(),this.mountVideoEvents())}mountAudioEvents(){navigator.mediaSession===void 0||navigator.mediaSession.setMicrophoneActive===void 0||d(this,fe).permissions.canProduceAudio&&navigator.mediaSession.setActionHandler("togglemicrophone",()=>{this.eventCallback("MIC")})}mountVideoEvents(){navigator.mediaSession===void 0||navigator.mediaSession.setCameraActive===void 0||d(this,fe).permissions.canProduceVideo&&navigator.mediaSession.setActionHandler("togglecamera",()=>{this.eventCallback("CAMERA")})}getSources(){const r=Object.values(d(this,gt)),n=r.filter(i=>i.pinned);return n.length===1?n:r}drawEmptyTile(r,n,i,s,a){if(d(this,St)===void 0)return;const o=d(this,St).getContext("2d"),c=d(this,St).width,u=4,h=4,f=n-u*2,m=i-u*2,T=Math.floor(c/f),A=Math.floor(r/T),R=r%T*(f+u)+u,b=A*(m+u)+u;o.fillStyle=d(this,$t).videoBackground,o.strokeStyle=d(this,$t).brand,o.beginPath(),o.moveTo(R+h,b),o.arcTo(R+f,b,R+f,b+h,h),o.arcTo(R+f,b+m,R+f-h,b+m,h),o.arcTo(R,b+m,R,b+m-h,h),o.arcTo(R,b,R+h,b,h),o.closePath(),o.fill(),o.stroke();const D=f/6,H=f/2+R,k=m/2+b;if(o.save(),(s||a)&&(o.beginPath(),o.arc(H,k,D,0,Math.PI*2),o.fillStyle=d(this,$t).brand,o.fill()),s&&(o.fillStyle=d(this,$t).textOnBrand,o.font=`${D/2}px sans-serif`,o.textAlign="center",o.textBaseline="middle",o.fillText(s,H,k)),a){const Z=new Image;Z.src=a,Z.onload=()=>{o.drawImage(Z,H-D,k-D,D*2,D*2),o.restore()}}}drawGrid(r,n,i){if(d(this,St)===void 0)return;const s=d(this,St).getContext("2d");s.fillStyle=d(this,$t).background,s.fillRect(0,0,d(this,he).width,d(this,he).height);const a=this.getSources();let o=0,c=0;for(;o<d(this,he).height-5;){let u=0;for(;u<d(this,he).width-5&&c<i;){const h=a[c].element;if(a[c].enabled){const[f,m,T,A,C,R,b,D]=pO(u,o,r,n,h.videoWidth,h.videoHeight);s.drawImage(h,f,m,T,A,C,R,b,D)}else this.drawEmptyTile(c,r,n,a[c].displayText);c+=1,u+=r}o+=n}}calcGridElemSize(r){switch(r){case 0:case 1:return[d(this,he).width,d(this,he).height];case 2:return[Math.floor(d(this,he).width/2),d(this,he).height];case 3:case 4:return[Math.floor(d(this,he).width/2),Math.floor(d(this,he).height/2)];case 5:case 6:return[Math.floor(d(this,he).width/3),Math.floor(d(this,he).height/2)];case 7:case 8:case 9:return[Math.floor(d(this,he).width/3),Math.floor(d(this,he).height/3)];default:return[Math.floor(d(this,he).width/3),Math.floor(d(this,he).height/2)]}}paintCanvas(){const r=this.getSources().length,[n,i]=this.calcGridElemSize(r);this.drawGrid(n,i,r)}isSupported(){return!!window.chrome&&document.pictureInPictureEnabled}get isActive(){return document.pictureInPictureElement!==null}cleanup(){if(this.isSupported()&&document.exitPictureInPicture!==void 0&&document.pictureInPictureElement!==null&&document.exitPictureInPicture(),d(this,$e))try{document.body.removeChild(d(this,$e))}catch(r){}this.removeAllSources(),w(this,St,void 0),w(this,ir,void 0),w(this,sr,void 0)}init({height:r,width:n}={}){this.createCanvas(),this.setupMediaSessionEvents();const i=document.createElement("video");w(this,he,{height:r!=null?r:Xu,width:n!=null?n:Qu}),i.height=d(this,he).height,i.width=d(this,he).width,i.autoplay=!0,i.muted=!0,i.srcObject=d(this,St).captureStream(24),w(this,ir,i),d(this,ir).onloadedmetadata=()=>{try{this.emit("pipStarted"),d(this,ir).onleavepictureinpicture=()=>{this.emit("pipEnded")}}catch(s){this.emit("pipEnded")}},this.createVideoContainer(),this.paintCanvas()}updateMediaSession(r,n){navigator.mediaSession!==void 0&&(r==="CAMERA"&&navigator.mediaSession.setCameraActive!==void 0&&navigator.mediaSession.setCameraActive(n),r==="MIC"&&navigator.mediaSession.setMicrophoneActive!==void 0&&navigator.mediaSession.setMicrophoneActive(n))}enableSource(r){d(this,gt)[r]!==void 0&&(d(this,gt)[r].enabled=!0)}disableSource(r){d(this,gt)[r]!==void 0&&(d(this,gt)[r].enabled=!1)}addSource(r,n,i,s=!1,a=void 0){s&&this.removePinnedSource(),d(this,gt)[r]={id:r,element:n,enabled:i,pinned:s,displayText:a?fO(a):void 0}}removeSource(r){delete d(this,gt)[r]}removePinnedSource(){const[r]=this.getSources();r&&this.removeSource(r.id)}removeAllSources(){w(this,gt,{})}enable(){this.setupEventListeners(),this.updateMediaSession("CAMERA",d(this,fe).videoEnabled),this.updateMediaSession("MIC",d(this,fe).audioEnabled),document.body.appendChild(d(this,$e)),w(this,sr,requestAnimationFrame(()=>this.animate())),d(this,ir).requestPictureInPicture()}}St=new WeakMap,$e=new WeakMap,ir=new WeakMap,he=new WeakMap,$t=new WeakMap,sr=new WeakMap,gt=new WeakMap,fe=new WeakMap;var gO=Object.defineProperty,_O=Object.getOwnPropertyDescriptor,rt=(t,e,r,n)=>{for(var i=n>1?void 0:n?_O(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&gO(e,r,i),i},ar,Tl;let Ve=(Tl=class extends ht{constructor(e,r){var n;super();g(this,"waitlisted");g(this,"joined");g(this,"active");g(this,"pinned");g(this,"all");g(this,"pip");S(this,ar,void 0);g(this,"viewMode");g(this,"currentPage");g(this,"lastActiveSpeaker");g(this,"selectedPeers");w(this,ar,e),this.waitlisted=new ns,this.joined=new ns,this.active=new ns,this.pinned=new ns,this.all=new uO,this.selectedPeers=new dO,this.viewMode="ACTIVE_GRID",this.currentPage=0,((n=r==null?void 0:r.pip)==null||n)&&(this.pip=new mO(e))}get roomJoined(){return d(this,ar).roomJoined}get count(){return this.joined.size}get maxActiveParticipantsCount(){return 6}get pageCount(){if(this.viewMode==="PAGINATED"){const e=this.joined.toArray().filter(r=>r.stageStatus==="ON_STAGE");return Math.ceil(e.length/this.maxActiveParticipantsCount)}return 0}acceptWaitingRoomRequest(e){var r,n;(n=(r=this.waitlisted.get(e))==null?void 0:r.userId)!=null}async acceptAllWaitingRoomRequest(e){e.map(r=>{var n,i;return(i=(n=this.waitlisted.get(r))==null?void 0:n.userId)!=null?i:r})}async rejectWaitingRoomRequest(e){}async setViewMode(e){if(p.info("DyteParticipants::set_view_mode",{pageNavigation:{viewMode:e,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}}),!["ACTIVE_GRID","PAGINATED"].includes(e))throw p.error("DyteParticipants::setViewMode::invalid_view_mode",{pageNavigation:{viewMode:e,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}}),new E(`Invalid view mode: ${e}. Try ACTIVE_GRID or PAGINATED.`);if(this.viewMode===e){p.info("DyteParticipants::setViewMode::view_mode_same_as_previous",{pageNavigation:{viewMode:e,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}});return}if(this.viewMode=e,e==="PAGINATED"){this.currentPage=1;const r=[];P.emit(I.GET_PAGE,{peerIds:r})}else e==="ACTIVE_GRID"&&(this.currentPage=0);this.emit("viewModeChanged",{viewMode:e,currentPage:this.currentPage,pageCount:this.pageCount})}getPeerIdsForCurrentPage(){p.info("DyteParticipants::getPeerIdsForCurrentPage()",{pageNavigation:{viewMode:this.viewMode,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}});const{compulsoryPeers:e}=this.selectedPeers,r=e.filter(o=>this.joined.has(o)),n=Array.from(this.pinned.keys()).filter(o=>!r.includes(o)),i=Array.from(this.joined.toArray().filter(o=>o.stageStatus==="ON_STAGE").map(o=>o.id)),s=Math.max((this.currentPage-1)*(this.maxActiveParticipantsCount-r.length-n.length)),a=this.currentPage*(this.maxActiveParticipantsCount-r.length-n.length);return r.concat(n,i.slice(s,a))}async setPage(e){if(p.info("DyteParticipants::set_page",{pageNavigation:{settingPage:e,viewMode:this.viewMode,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}}),this.viewMode!=="PAGINATED")return;if(!Number.isInteger(e))throw p.error("DyteParticipants::invalid_page_number",{pageNavigation:{settingPage:e,viewMode:this.viewMode,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}}),new E(`Invalid page: ${e}. Page must be an integer.`);if(e<1||e>this.pageCount)throw p.error("DyteParticipants::invalid_page_number",{pageNavigation:{settingPage:e,viewMode:this.viewMode,currentPage:this.currentPage,pageCount:this.pageCount,maxActiveParticipantsCount:this.maxActiveParticipantsCount}}),new E(`Invalid page: ${e}. Page must be greater than 0 and less than or equal to ${this.pageCount}.`);this.currentPage=e;const r=[];P.emit(I.GET_PAGE,{peerIds:r}),this.emit("pageChanged",{viewMode:this.viewMode,currentPage:this.currentPage,pageCount:this.pageCount})}async disableAllAudio(e){if(p.info("DyteParticipants::disable_all_audio",{actions:{disableAllAudio:{allowUnmute:e}}}),!this.roomJoined)throw new E("Can`t disable all audio without joining room");if(!d(this,ar).permissions.canAllowParticipantAudio)throw p.error("DyteParticipants::unauthorized_disable_all_audio",{actions:{disableAllAudio:{allowUnmute:e}}}),new E("Unauthorized: User does not have permission to disable peer audio.")}async disableAllVideo(){if(p.info("DyteParticipants::disable_all_video"),!this.roomJoined)throw new E("Can`t disable all video without joining room");if(!d(this,ar).permissions.canAllowParticipantVideo)throw p.error("DyteParticipants::unauthorized_disable_all_video"),new E("Unauthorized: User does not have permission to disable peer video.")}async disableAudio(e){this.joined.get(e).disableAudio()}async disableVideo(e){this.joined.get(e).disableVideo()}async kick(e){await P.emitAsync(I.KICK_PEER,{peerId:e})}async kickAll(){if(p.info("DyteParticipants::kick_all"),!this.roomJoined)throw new E("Can`t kick all without joining room");if(!d(this,ar).permissions.kickParticipant)throw p.error("DyteParticipants::unauthorized_kick_all"),new E("Unauthorized: User does not have permission to kick peers.")}async broadcastMessage(e,r,n){if(p.info("DyteParticipants::broadcastMessage"),!this.roomJoined)throw new E("Can`t broadcast message without joining room");if(!(e!=null&&e.trim()))throw new E("`type` must be a non-empty string.")}async acceptAllRequestToJoinStageRequests(e){P.emitAsync(I.ACCEPT_ALL_REQUESTS_TO_JOIN_STAGE,{data:e})}async getAllJoinedPeers(e,r,n){return[]}async updatePermissions(e,r){const n=this.joined.toArray().filter(i=>e.includes(i.id)).map(i=>i.userId);[...new Set(n)]}async getAllPeersInRoom(){return[]}async setMockParticipantCount(e,r){const n=e-this.joined.size;if(n>0)for(let s=0;s<n;s++){const a=new Pt({id:qe.v4(),displayName:fi.faker.person.fullName(),picture:fi.faker.image.avatar(),clientSpecificId:fi.faker.string.alphanumeric(6),audioMuted:!0,isHost:!1,userId:qe.v4(),audioTrack:void 0,videoTrack:void 0,videoEnabled:!1,flags:{}},d(this,ar));this.joined.add(a)}else this.joined.toArray().reverse().forEach((s,a)=>{a<n&&this.joined.delete(s.id)});r-this.active.size>0?this.joined.toArray().forEach((s,a)=>{a<n&&this.active.add(s)}):this.active.toArray().reverse().forEach((s,a)=>{a<n&&this.active.delete(s.id)})}},ar=new WeakMap,Tl);rt([v.trace("DyteParticipants.setViewMode")],Ve.prototype,"setViewMode",1);rt([v.trace("DyteParticipants.setPage")],Ve.prototype,"setPage",1);rt([v.trace("DyteParticipants.disableAllAudio")],Ve.prototype,"disableAllAudio",1);rt([v.trace("DyteParticipants.disableAllVideo")],Ve.prototype,"disableAllVideo",1);rt([v.trace("DyteParticipants.disablePeerAudio")],Ve.prototype,"disableAudio",1);rt([v.trace("DyteParticipants.disablePeerVideo")],Ve.prototype,"disableVideo",1);rt([v.trace("DyteParticipants.kickPeer")],Ve.prototype,"kick",1);rt([v.trace("DyteParticipants.kickAll")],Ve.prototype,"kickAll",1);rt([v.trace("DyteParticipants.broadcastMessage")],Ve.prototype,"broadcastMessage",1);rt([v.trace("DyteParticipants.acceptAllRequestToJoinStageRequests")],Ve.prototype,"acceptAllRequestToJoinStageRequests",1);rt([v.trace("DyteParticipants.getAllJoinedPeers")],Ve.prototype,"getAllJoinedPeers",1);rt([v.trace("DyteParticipant.updatePermissions")],Ve.prototype,"updatePermissions",1);rt([v.trace("DyteParticipants.getAllPeersInRoom")],Ve.prototype,"getAllPeersInRoom",1);Ve=rt([xe(t=>{throw new E(t.message,"1200")})],Ve);class Zu extends Op{constructor(){super({onAddEvent:"pluginAdded",onDeleteEvent:"pluginDeleted"})}add(e,r=!0){return super.add(e,r)}delete(e,r=!0,n=!1){return super.delete(e,r,n)}}var vO=Object.defineProperty,TO=Object.getOwnPropertyDescriptor,EO=(t,e,r,n)=>{for(var i=n>1?void 0:n?TO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&vO(e,r,i),i};let Ho=class{constructor(){g(this,"all");g(this,"active");this.all=new Zu,this.active=new Zu}};Ho=EO([xe(t=>{throw new E(t.message,"0600")})],Ho);const ze={isV2AuthToken:!1,meetingId:null,overrides:{},roomNodeOptions:void 0},hi={baseURL:"http://localhost:5000",createdAt:"2021-08-05T10:49:56.602Z",description:"Develop plugins locally",id:"09259e3b-7be8-46f6-9801-106bf1866e1c",name:"Localhost Dev",organizationId:"4ad15a19-80e2-4105-bf43-48039fd2963e",picture:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/dyte.png",private:!1,published:!0,staggered:!1,tags:["#localhost","#dev"],type:"self_hosted",updatedAt:"2021-08-05T10:50:07.681Z"};function wO(t,e){if(e){ze.isV2AuthToken=!1;return}try{const{meetingId:r}=JSON.parse(atob(t.split(".")[1]));if(!r)throw Error(`Received V1 auth token ${t}`);ze.isV2AuthToken=!0,ze.meetingId=r}catch(r){throw p.error("constants::setIsV2AuthToken",{error:r,debuggingHint:`Unable to decode auth token: ${t}`},!0),new E("Invalid auth token")}}function yO(t){ze.overrides=t}const AO=3,RO=30,SO=8e3;class bO{constructor(e){g(this,"ipInfo");g(this,"axios");g(this,"requests");g(this,"roomName");g(this,"roomUUID");g(this,"peerId");g(this,"authToken");g(this,"organizationId");g(this,"iceServers");g(this,"pluginInformation");g(this,"userDetails");g(this,"roomDetails");const{timeout:r=SO,retry:n=AO,retryDelay:i=RO,baseURL:s="https://api.cluster.dyte.in",authToken:a,cachedUserDetails:o}=e||{};this.iceServers=o==null?void 0:o.iceServers,this.pluginInformation=o==null?void 0:o.pluginInformation,this.userDetails=o==null?void 0:o.userDetails,this.roomDetails=o==null?void 0:o.roomDetails,this.requests=Eo.create({baseURL:s,responseType:"json",timeout:r,retry:n,retryDelay:i}),this.axios=Eo,this.setAuthToken(a,{bearer:!0}),this.requests.interceptors.request.use(c=>(v.injectContext(this.requests.defaults.headers.common),c),async c=>{p.error("xhr::axios",{debuggingHint:"otelRequestInterceptor failed.",error:c})}),this.requests.interceptors.response.use(c=>{try{c.config.url!==v.logsEndpoint&&p.debug("xhr::axios",{networkCall:{status:c.status,statusText:c.statusText,baseURL:c.config.baseURL,url:c.config.url,method:c.config.method}})}catch(u){console.error("xhr::dyte",{error:"responseInterceptorFailed",err:u,response:c})}return c},async c=>{var u;try{if(!c)return Promise.reject(new Error("Unknown error occurred"));c&&c.config&&((u=c.config)==null?void 0:u.url)!==v.logsEndpoint&&p.error("xhr::axios",{error:c,networkCall:{status:c.status,statusText:c.statusText,baseURL:c.config.baseURL,url:c.config.url,retries:c.config.retry,method:c.config.method,isOnline:navigator.onLine?"online":"offline"}});const{config:h,message:f}=c;return h&&f&&h.retry!==void 0&&h.retry>0&&(f.includes("timeout")||f.includes("Network Error"))?(h.retry-=1,this.requests(h)):Promise.reject(c)}catch(h){return console.error("xhr::dyte",{error:"responseInterceptorFailed",err:h,responseError:c}),Promise.reject(h)}})}setAuthToken(e,r){const{bearer:n}=r||{};this.authToken=e,this.requests.defaults.headers.common.Authorization=n?`Bearer ${e}`:e}setHeader(e,r){this.requests.defaults.headers.common[e]=r}setRoomName(e){this.roomName=e}setRoomUUID(e){this.roomUUID=e}setPeerId(e){this.peerId=e}setOrganizationId(e){this.organizationId=e}}var kO=Object.defineProperty,CO=Object.getOwnPropertyDescriptor,Mp=(t,e,r,n)=>{for(var i=n>1?void 0:n?CO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&kO(e,r,i),i};class Ia extends bO{constructor(e){super(e),this.setHeader("x-dyte-web-core-version",hp)}async getIPDetails({peerId:e}){}async getICEServers(){if(this.iceServers)return this.iceServers;const{success:e,iceServers:r}=(await this.requests.get("/iceservers")).data;if(e)return r}async getPlugins(e){var s,a,o,c,u,h,f;if(this.pluginInformation)return this.pluginInformation;let{plugins:r}=(await this.requests.get("/v2/plugins/user")).data.data;const n=((a=(s=ie.getValue(se.V1_PLUGINS))==null?void 0:s.toString())==null?void 0:a.split(","))||[],i=r.reduce((m,T)=>(m[n.includes(T.id)?"v1":"v2"].push(T),m),{v1:[],v2:[]});return e?r=i.v2:r=i.v1,(u=(c=(o=B.modules)==null?void 0:o.devTools)==null?void 0:c.plugins)!=null&&u.length&&((f=(h=B.modules)==null?void 0:h.devTools)==null||f.plugins.forEach(m=>{var A,C,R;const T={...hi,tags:[...hi.tags]};T.baseURL=`http://localhost:${m.port}`,T.name=m.name,T.picture=(A=m.picture)!=null?A:hi.picture,T.description=(C=m.description)!=null?C:hi.description,T.staggered=(R=m.staggered)!=null?R:hi.staggered,T.createdAt=new Date().toISOString(),T.updatedAt=new Date().toISOString(),T.id=m.id,T.organizationId=this.organizationId,r.push(T)})),r}async getPluginDetails(e){const{plugin:r}=(await this.requests.get(`/v2/plugins/view/${e}`)).data.data;return r}async getPluginConfig(e){return(await this.axios.get(`${e}/dyte-config.json`)).data}async authorizePlugin(e){const r={peerId:this.peerId};ze.isV2AuthToken||(r.roomName=this.roomName);const{token:n}=(await this.requests.post(`/v2/plugins/authorize/${e}`,r)).data.data;return n}async getPresignedUrls(e,r){const n={roomUUID:this.roomUUID,filename:e};ie.hasFeature(se.FEAT_CHAT_SDK)&&(n.viewType=r);const{getLocation:i,putLocation:s}=(await this.requests.post("/v1/meetings/genPreSignedUploadUrl",n)).data.data;return{getLocation:i,putLocation:s}}async uploadFile(e,r){if(navigator.isReactNative&&"uri"in e)try{await fetch(r,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:{uri:e.uri,name:e.name}})}catch(n){p.error(`sendFileMessage::${n}`)}else await this.axios.put(r,e,{headers:{"Content-Type":e.type}})}}Mp([v.trace("APIClient.getIPDetails")],Ia.prototype,"getIPDetails",1);Mp([v.trace("APIClient.getICEServers")],Ia.prototype,"getICEServers",1);var IO=Object.defineProperty,PO=Object.getOwnPropertyDescriptor,zt=(t,e,r,n)=>{for(var i=n>1?void 0:n?PO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&IO(e,r,i),i};class Xt extends Ia{async startLivestreaming(){var r,n;return(n=(r=(await this.requests.post(`/v2/meetings/${ze.meetingId}/livestreams`)).data)==null?void 0:r.data)==null?void 0:n.playback_url}async stopLivestreaming(){return this.requests.post(`/v2/meetings/${ze.meetingId}/active-livestream/stop`)}async getActiveLivestream(){const{playbackUrl:e,status:r}=Tt((await this.requests.get(`/v2/meetings/${ze.meetingId}/active-livestream`)).data.data);return{status:r,playbackUrl:e}}async getUserDetails(){if(this.userDetails)return this.userDetails;const e=(await this.requests.get("v2/internals/participant-details")).data.data;return Tt(e)}getUserPreset(){throw new Error("getUserPreset does not exist for v2")}async startRecording(e,r){return(await this.requests.post("/v2/recordings",{...yp(e),meeting_id:ze.meetingId,allow_multiple_recordings:!!r})).data.data.id}async updateRecording(e,r){return this.requests.put(`v2/recordings/${e}`,{action:r})}async getActiveRecording(){const{status:e,id:r}=(await this.requests.get(`v2/recordings/active-recording/${ze.meetingId}`)).data.data;return{status:e,id:r}}async getActiveTranscript(){const{transcript_download_url:e}=(await this.requests.get(`v2/meetings/${ze.meetingId}/active-transcript`)).data.data;try{return{transcript:(await this.axios.get(e)).data}}catch(r){throw new E("Cant fetch transcript s3 url")}}async getRoomNodeData({peerId:e}){if(this.roomDetails)return this.roomDetails;const r=await this.getIPDetails({peerId:e});this.ipInfo=r;const{roomNodeLink:n,title:i,useHiveMedia:s}=Tt((await this.requests.post("v2/internals/rooms",{ip_information:r})).data.data);return{roomNodeUrl:n,meetingTitle:i,useHiveMedia:s!=null?s:!1}}}zt([v.trace("APIClient.startLivestreaming")],Xt.prototype,"startLivestreaming",1);zt([v.trace("APIClient.stopLivestreaming")],Xt.prototype,"stopLivestreaming",1);zt([v.trace("APIClient.getActiveLivestream")],Xt.prototype,"getActiveLivestream",1);zt([v.trace("APIClient.getUserDetails")],Xt.prototype,"getUserDetails",1);zt([v.trace("APIClient.getUserPreset")],Xt.prototype,"getUserPreset",1);zt([v.trace("APIClient.startRecording")],Xt.prototype,"startRecording",1);zt([v.trace("APIClient.stopRecording")],Xt.prototype,"updateRecording",1);zt([v.trace("APIClient.getActiveRecording")],Xt.prototype,"getActiveRecording",1);zt([v.trace("APIClient.getActiveTranscript")],Xt.prototype,"getActiveTranscript",1);zt([v.trace("APIClient.getRoomNodeData")],Xt.prototype,"getRoomNodeData",1);var DO=Object.defineProperty,OO=Object.getOwnPropertyDescriptor,wn=(t,e,r,n)=>{for(var i=n>1?void 0:n?OO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&DO(e,r,i),i};class yn extends Ia{startLivestreaming(){throw new Error("Method not implemented.")}stopLivestreaming(){throw new Error("Method not implemented.")}getActiveLivestream(){throw new Error("Method not implemented.")}async getUserDetails(){const{user:e}=(await this.requests.get("/auth/basicUserDetails")).data;return e}async getUserPreset(e){const{preset:r}=(await this.requests.post("/v1/userpreset",{roomName:e,authToken:this.authToken,clientType:"CLIENT_APP",version:"0.5.0"})).data.data;return Tt(r)}async startRecording(e){const r=await this.requests.post(`/v1/organizations/${this.organizationId}/rooms/${this.roomName}/recording`,e);if(r.status!==201)throw new Error("Recording failed to start");return r.data.data.recording.id}async updateRecording(e,r){if(r!=="stop")return;if((await this.requests.put(`/v1/organizations/${this.organizationId}/rooms/${this.roomName}/recordings/${e}`,{recordingAction:"stop"})).status!==201)throw new Error("Recording failed to stop")}async getActiveRecording(){return this.organizationId?(await this.requests.get(`/v1/organizations/${this.organizationId}/rooms/${this.roomName}/active-recording?limit=50`)).data.data.recording:{}}async getActiveTranscript(){return p.error("getActiveTranscript does not work in v1 meeting"),{transcript:""}}async getRoomNodeData({roomName:e,peerId:r}){const n=`
				query Session($roomName: String!, $password: String, $ipInformation: String) {
						session(roomName: $roomName, password: $password) {
							title,
							roomNodeLink(ipInformation: $ipInformation),
							useHiveMedia,
							roomName,
							password
						}
					}
				`,i=await this.getIPDetails({peerId:r});this.ipInfo=i;const{roomNodeLink:s,title:a,useHiveMedia:o}=(await this.requests.post("/graphql",{query:n,variables:{roomName:e,ipInformation:JSON.stringify(i)}})).data.data.session;return{roomNodeUrl:s,meetingTitle:a,useHiveMedia:o!=null?o:!1}}}wn([v.trace("APIClientV1.getUserDetails")],yn.prototype,"getUserDetails",1);wn([v.trace("APIClientV1.getUserPreset")],yn.prototype,"getUserPreset",1);wn([v.trace("APIClientV1.startRecording")],yn.prototype,"startRecording",1);wn([v.trace("APIClientV1.updateRecording")],yn.prototype,"updateRecording",1);wn([v.trace("APIClientV1.getActiveRecording")],yn.prototype,"getActiveRecording",1);wn([v.trace("APIClient.getActiveTranscript")],yn.prototype,"getActiveTranscript",1);wn([v.trace("APIClientV1.getRoomNodeData")],yn.prototype,"getRoomNodeData",1);let MO;function Yn(){return MO}function NO(t,e){return`<blockquote>${e.replace(/<blockquote>[.\s\S]*<\/blockquote>\n\n/m,"")}</blockquote>

${t}`}var xO=Object.defineProperty,LO=Object.getOwnPropertyDescriptor,Be=(t,e,r,n)=>{for(var i=n>1?void 0:n?LO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&xO(e,r,i),i};const el=t=>new Promise((e,r)=>{const n=new FileReader;n.readAsDataURL(t),n.onload=()=>e(n.result),n.onerror=r}),$O=["text","image","file","custom","poll"];var $,Ws,El;let Pe=(El=class extends ht{constructor(e,r){super();g(this,"messages");g(this,"channels",[]);S(this,$,void 0);S(this,Ws,void 0);w(this,$,e),w(this,Ws,r),this.messages=[]}get roomJoined(){return d(this,$).roomJoined}async sendMessageInternal(e,r,n,i={}){switch(e.type){case"text":{const s=i.replyTo&&i.replyTo.type==="text"?NO(e.message,i.replyTo.message):e.message;await this.sendTextMessageInternal(s,r,n);break}case"image":await this.sendImageMessageInternal(e.image,r,n);break;case"file":await this.sendFileMessageInternal(e.file,r,n);break;default:p.error("sendMessage::message_type_not_supported",{dyteChat:{messageType:e.type}});break}}async sendTextMessageInternal(e,r,n){var s,a,o,c,u,h;if(r&&r.length>0){if(!((s=d(this,$).permissions)!=null&&s.chatPrivate.canSend)||!((a=d(this,$).permissions)!=null&&a.chatPrivate.text))throw p.error("sendTextMessage::private_chat_permission_denied"),new E("Could not send message to private chat.","0501")}else if(!((c=(o=d(this,$).permissions)==null?void 0:o.chatPublic)!=null&&c.canSend)||!((h=(u=d(this,$).permissions)==null?void 0:u.chatPublic)!=null&&h.text))throw p.error("sendTextMessage::public_chat_permission_denied"),new E("Could not send message to public chat.","0501");if(!e)throw p.error("sendTextMessage::message_can_not_be_empty"),new E("Message can not be empty.","0502");if(n)return;if(r!==void 0&&r.length>0){p.error("sendTextMessage::private_chat_unsupported");return}const i={id:qe.v4(),userId:d(this,$).userId,displayName:d(this,$).name,message:e,type:"text",time:new Date};this.messages.push(i),this.emit("chatUpdate",{action:"add",message:i,messages:this.messages})}async sendImageMessageInternal(e,r,n){var s,a,o,c,u,h;if(r&&r.length>0){if(!((s=d(this,$).permissions)!=null&&s.chatPrivate.canSend)||!((a=d(this,$).permissions)!=null&&a.chatPrivate.files)){p.error("sendImageMessage::private_chat_permission_denied");return}}else if(!((c=(o=d(this,$).permissions)==null?void 0:o.chatPublic)!=null&&c.canSend)||!((h=(u=d(this,$).permissions)==null?void 0:u.chatPublic)!=null&&h.files)){p.error("sendImageMessage::permission_denied");return}if(!e){p.error("sendImageMessage::required_argument_image_can_not_be_empty");return}if(!["image/gif","image/jpeg","image/png"].includes(e.type)){p.error("sendImageMessage::image_type_not_supported",{dyteChat:{imageType:e.type}});return}try{if(n)return;if(r!==void 0&&r.length>0){p.error("sendImageMessage::private_chat_unsupported");return}const f=await el(e),m={userId:d(this,$).userId,displayName:d(this,$).name,type:"image",link:f,time:new Date,id:qe.v4()};if(this.messages.push(m),this.emit("chatUpdate",{action:"add",message:m,messages:this.messages}),!this.roomJoined)throw p.error("DyteChat.sendImageMessage.RoomNodeClientSocketUsed_WithoutRoomJoin"),new E("Can`t sendImageMessage without joining room")}catch(f){throw new E("Error sending image message.")}}async sendFileMessageInternal(e,r,n){var i,s,a,o,c,u;if(r&&r.length>0){if(!((i=d(this,$).permissions)!=null&&i.chatPrivate.canSend)||!((s=d(this,$).permissions)!=null&&s.chatPrivate.files)){p.error("sendFileMessage::private_chat_permission_denied");return}}else if(!((o=(a=d(this,$).permissions)==null?void 0:a.chatPublic)!=null&&o.canSend)||!((u=(c=d(this,$).permissions)==null?void 0:c.chatPublic)!=null&&u.files)){p.error("sendFileMessage::permission_denied");return}if(!e){p.error("sendFileMessage::required_argument_file_can_not_be_empty");return}try{if(n)return;if(r!==void 0&&r.length>0){p.error("sendFileMessage::private_chat_unsupported");return}const h=await el(e),f={id:qe.v4(),userId:d(this,$).userId,displayName:d(this,$).name,type:"file",link:h,name:e.name,size:"size"in e?e.size:0,time:new Date};this.messages.push(f),this.emit("chatUpdate",{action:"add",message:f,messages:this.messages})}catch(h){throw new E("Error sending file message.")}}async sendTextMessage(e,r){return this.sendTextMessageInternal(e,r)}async sendCustomMessage(e,r){var s,a,o,c,u,h,f,m,T,A,C,R,b,D,H;if(r&&r.length>0){if(!((s=d(this,$).permissions)!=null&&s.chatPrivate.canSend)||!((a=d(this,$).permissions)!=null&&a.chatPrivate.files)||!((o=d(this,$).permissions)!=null&&o.chatPrivate.text)){p.error("sendCustomMessage::private_chat_permission_denied");return}}else if(!((u=(c=d(this,$).permissions)==null?void 0:c.chatPublic)!=null&&u.canSend)||!((f=(h=d(this,$).permissions)==null?void 0:h.chatPublic)!=null&&f.files)||!((T=(m=d(this,$).permissions)==null?void 0:m.chatPublic)!=null&&T.text)){p.error("sendCustomMessage::permission_denied");return}const n=async k=>{try{if(typeof k=="string")return k;const Z=Yn(),{getLocation:K,putLocation:ve}=await Z.getPresignedUrls(k.name,d(this,$).config.viewType);return await Z.uploadFile(k,ve),K}catch(Z){throw new E("Error sending image message.")}},i={...e,files:await Promise.all((C=(A=e.files)!=null?A:[])==null?void 0:C.map(k=>n(k))),images:await Promise.all((b=(R=e.images)!=null?R:[])==null?void 0:b.map(async k=>n(k))),videos:await Promise.all((H=(D=e.videos)!=null?D:[])==null?void 0:H.map(async k=>n(k)))};if(r!==void 0&&r.length>0){p.error("sendCustomMessage::private_chat_unsupported");return}if(!this.roomJoined)throw p.error("DyteChat.sendCustomMessage.RoomNodeClientSocketUsed_WithoutRoomJoin"),new E("Can`t sendCustomMessage without joining room");({userId:d(this,$).userId,displayName:d(this,$).name,...i,type:$O.indexOf("custom"),time:+new Date})}async sendImageMessage(e,r){return this.sendImageMessageInternal(e,r)}async sendFileMessage(e,r){return this.sendFileMessageInternal(e,r)}async sendMessage(e,r){return this.sendMessageInternal(e,r)}async editTextMessage(e,r,n){var i,s,a,o,c,u;if(((s=(i=d(this,$).permissions)==null?void 0:i.chatMessage)==null?void 0:s.canEdit)==="NONE")throw new E("Not permitted to edit messages","0501");if(!((o=(a=d(this,$).permissions)==null?void 0:a.chatPublic)!=null&&o.canSend)||!((u=(c=d(this,$).permissions)==null?void 0:c.chatPublic)!=null&&u.text)){p.error("editTextMessage::permission_denied");return}r||p.error("editTextMessage::message_can_not_be_empty")}async editImageMessage(e,r,n){var s,a,o,c;if(!((a=(s=d(this,$).permissions)==null?void 0:s.chatPublic)!=null&&a.canSend)||!((c=(o=d(this,$).permissions)==null?void 0:o.chatPublic)!=null&&c.files)){p.error("editImageMessage::permission_denied");return}if(!r){p.error("editImageMessage::required_argument_image_can_not_be_empty");return}if(!["image/gif","image/jpeg","image/png"].includes(r.type)){p.error("sendImageMessage::image_type_not_supported",{dyteChat:{imageType:r.type}});return}}async editFileMessage(e,r,n){var i,s,a,o;if(!((s=(i=d(this,$).permissions)==null?void 0:i.chatPublic)!=null&&s.canSend)||!((o=(a=d(this,$).permissions)==null?void 0:a.chatPublic)!=null&&o.files)){p.error("sendFileMessage::permission_denied");return}if(!r){p.error("sendFileMessage::required_argument_file_can_not_be_empty");return}}async editMessage(e,r,n){switch(r.type){case"text":{this.editTextMessage(e,r.message,n);break}case"image":{this.editImageMessage(e,r.image,n);break}case"file":{this.editFileMessage(e,r.file,n);break}default:{p.error("editMessage::message_type_not_supported",{dyteChat:{messageType:r.type}});break}}}async deleteMessage(e,r){var n,i;if(((i=(n=d(this,$).permissions)==null?void 0:n.chatMessage)==null?void 0:i.canDelete)==="NONE")throw new E("Not permitted to delete messages","0501")}getMessagesByUser(e){return this.messages.filter(r=>r.userId===e)}getMessagesByType(e){return this.messages.filter(r=>r.type===e)}async pin(e){if(!this.roomJoined)throw new E("Can`t pin message without joining room");if(!d(this,$).permissions.pinParticipant)throw new E("You do not have permission to pin messages.")}async unpin(e){if(!this.roomJoined)throw new E("Can`t unpin message without joining room");if(!d(this,$).permissions.pinParticipant)throw new E("You do not have permission to unpin messages.")}async getMessages(e,r,n,i=0,s=void 0){return{messages:[],next:""}}async createChannel(e,r,n={}){var s;const i=(s=d(this,$).permissions)==null?void 0:s.chatChannel;if(i){if(i.canCreate==="NONE")throw new E("Not permitted to create channels","0501");if(n.visibility==="public"&&!(i.canCreate==="PUBLIC"||i.canCreate==="ALL"))throw new E("Not permitted to create public channels","0501");if(n.visibility==="private"&&!(i.canCreate==="PRIVATE"||i.canCreate==="ALL"))throw new E("Not permitted to create private channels","0501")}if(!e||e.trim().length===0)throw new E("channel name cannot be empty.","0510");return[...new Set([...r,d(this,$).userId])],{}}updateChannel(e,r){var s,a,o,c,u;const n=this.channels.find(h=>h.id===e),i=(s=d(this,$).permissions)==null?void 0:s.chatChannel;if(i){if(i.canUpdate==="NONE")throw new E("Not permitted to update channels","0501");if(n.visibility==="public"&&!(i.canUpdate==="PUBLIC"||i.canUpdate==="ALL"))throw new E("Not permitted to update public channels","0501");if(n.visibility==="private"&&!(i.canUpdate==="PRIVATE"||i.canUpdate==="ALL"))throw new E("Not permitted to update private channels","0501")}return(a=r.memberIds)!=null||n.memberIds,(o=r.displayName)!=null||n.displayName,(c=r.displayPictureUrl)!=null||n.displayPictureUrl,(u=r.visibility)!=null||n.visibility,{}}async sendMessageToChannel(e,r,n={}){return this.sendMessageInternal(e,null,r,n)}async getChannelMembers(e){return[]}async searchMessages(e,r={}){if(!ie.hasFeature(se.FEAT_CHAT_SDK_SEARCH))throw new E("searchMessages is temporarily disabled!");return[]}async markLastReadMessage(e,r){}get pinned(){return this.messages.filter(e=>e.pinned)}},$=new WeakMap,Ws=new WeakMap,El);Be([v.trace("DyteChat.sendTextMessage")],Pe.prototype,"sendTextMessage",1);Be([v.trace("DyteChat.sendImageMessage")],Pe.prototype,"sendImageMessage",1);Be([v.trace("DyteChat.sendFileMessage")],Pe.prototype,"sendFileMessage",1);Be([v.trace("DyteChat.sendMessage")],Pe.prototype,"sendMessage",1);Be([v.trace("DyteChat.editTextMessage")],Pe.prototype,"editTextMessage",1);Be([v.trace("DyteChat.editImageMessage")],Pe.prototype,"editImageMessage",1);Be([v.trace("DyteChat.editFileMessage")],Pe.prototype,"editFileMessage",1);Be([v.trace("DyteChat.editMessage")],Pe.prototype,"editMessage",1);Be([v.trace("DyteChat.deleteMessage")],Pe.prototype,"deleteMessage",1);Be([v.trace("DyteChat.createChannel")],Pe.prototype,"createChannel",1);Be([v.trace("DyteChat.updateChannel")],Pe.prototype,"updateChannel",1);Be([v.trace("DyteChat.sendMessageToChannel")],Pe.prototype,"sendMessageToChannel",1);Be([v.trace("DyteChat.getChannelMembers")],Pe.prototype,"getChannelMembers",1);Be([v.trace("DyteChat.searchMessages")],Pe.prototype,"searchMessages",1);Be([v.trace("DyteChat.markLastReadMessage")],Pe.prototype,"markLastReadMessage",1);Pe=Be([xe(t=>{throw new E(t.message,"0500")})],Pe);var UO=Object.defineProperty,FO=Object.getOwnPropertyDescriptor,VO=(t,e,r,n)=>{for(var i=n>1?void 0:n?FO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&UO(e,r,i),i},Ut,wl;let Wo=(wl=class extends ht{constructor(e){super();g(this,"items");S(this,Ut,void 0);w(this,Ut,e),this.items=[]}get roomJoined(){return d(this,Ut).roomJoined===!0}async create(e,r,n=!1,i=!1){if(d(this,Ut).config.viewType!=="LIVESTREAM"&&!this.roomJoined)throw new E("Can't create polls without joining room");if(!d(this,Ut).permissions.polls.canCreate){p.error("DytePolls::create::permission_denied");return}if(!e||!r){p.error("DytePolls::question_and_options_can_not_be_empty",{dytePolls:{hasQuestion:!!e,optionsLength:r==null?void 0:r.length}});return}if(r.length<2){p.error("DytePolls::there_must_be_at_least_two_options",{dytePolls:{hasQuestion:!!e,optionsLength:r.length}});return}const s={question:e,options:r.map(a=>({text:a,votes:[],count:0})),id:qe.v4(),voted:[],anonymous:n,hideVotes:i,createdBy:d(this,Ut).name,createdByUserId:d(this,Ut).userId};this.items.push(s)}async vote(e,r){if(!d(this,Ut).permissions.polls.canVote){p.error("DytePolls::vote::permission_denied");return}console.log()}},Ut=new WeakMap,wl);Wo=VO([xe(t=>{throw new E(t.message,"0700")})],Wo);var BO=Object.defineProperty,GO=Object.getOwnPropertyDescriptor,Xi=(t,e,r,n)=>{for(var i=n>1?void 0:n?GO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&BO(e,r,i),i},Wn,jn,ps,yl;let mn=(yl=class extends ht{constructor(e){super();S(this,jn);S(this,Wn,void 0);g(this,"recordingPeerIds",[]);g(this,"recordings",[]);w(this,Wn,e)}get recordingState(){return this.recordings.some(e=>e.state==="RECORDING")?"RECORDING":this.recordings.some(e=>e.state==="PAUSED")?"PAUSED":this.recordings.some(e=>e.state==="STARTING")?"STARTING":this.recordings.some(e=>e.state==="STOPPING")?"STOPPING":"IDLE"}updateRecordings(e){this.recordings=e,this.emit("recordingUpdate",this.recordingState)}async start(e){if(!d(this,Wn).permissions.canRecord)throw p.error("DyteRecording::start::permission_denied"),new E("User does not have permission to start recording");if((e==null?void 0:e.allowMultiple)!==!0&&(this.recordingState==="STARTING"||this.recordingState==="RECORDING"||this.recordingState==="STOPPING"))throw p.error("DyteRecording::start::recording_in_progress",{recording:{state:this.recordingState}}),new E(`Cant start recording, recordingState irregular: ${this.recordingState}`);try{const r=Yn(),{recording:n={}}=B.defaults,i=await r.startRecording(n,e==null?void 0:e.allowMultiple);this.updateRecordings([...this.recordings,{id:i,state:"STARTING"}])}catch(r){throw p.error("DyteRecording::stop::recording_failed_to_start",{error:r}),new E("Error while starting recording")}}async stop(e){await W(this,jn,ps).call(this,"stop",["RECORDING","PAUSED"],e)}async pause(e){await W(this,jn,ps).call(this,"pause",["RECORDING"],e)}async resume(e){await W(this,jn,ps).call(this,"resume",["PAUSED"],e)}},Wn=new WeakMap,jn=new WeakSet,ps=async function(e,r,n){if(!d(this,Wn).permissions.canRecord)throw p.error("DyteRecording::stop::permission_denied"),new E("User does not have permission to stop recording");let i=[];if(n!==void 0){const s=this.recordings.find(a=>a.id===n);if(s===void 0)throw new E("Could not find the specified recording");if(r.includes(s.state)){p.error("DyteRecording::stop::recording_not_in_expected_state",{recording:{state:s.state}});return}i.push(s)}else i=this.recordings.filter(s=>r.includes(s.state));i.forEach(async s=>{const a=s.state;e==="stop"&&(s.state="STOPPING",this.emit("recordingUpdate","STOPPING"));try{await Yn().updateRecording(s.id,e)}catch(o){throw p.error("DyteRecording::stop::recording_failed_to_stop",{error:o}),s.state!==a&&(s.state=a,this.emit("recordingUpdate",a)),new E("Error while stopping recording")}})},yl);Xi([v.trace("DyteRecording.start")],mn.prototype,"start",1);Xi([v.trace("DyteRecording.stop")],mn.prototype,"stop",1);Xi([v.trace("DyteRecording.stop")],mn.prototype,"pause",1);Xi([v.trace("DyteRecording.stop")],mn.prototype,"resume",1);mn=Xi([xe(t=>{throw new E(t.message,"1000")})],mn);class Np{static hasFeature(e){return!1}static getFeatureValue(e){return""}static getAllFeatures(){return{}}}class ad{constructor(e,r){g(this,"logger");g(this,"features");g(this,"browserSpecs");this.logger=e,this.features=r,this.browserSpecs=le}static init(){return new ad(p,Np)}}var qO=Object.defineProperty,HO=Object.getOwnPropertyDescriptor,xp=(t,e,r,n)=>{for(var i=n>1?void 0:n?HO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&qO(e,r,i),i},Kn;class od extends ht{constructor(r){super();S(this,Kn,void 0);g(this,"state","IDLE");g(this,"playbackUrl");g(this,"viewerCount");w(this,Kn,r),this.viewerCount=0}setLivestreamState(r){const n=this.state;this.state=r,n!==r&&this.emitCurrentLivestreamState()}emitCurrentLivestreamState(){this.emit("livestreamUpdate",this.state)}async start(){if(!d(this,Kn).permissions.canLivestream)throw p.error("DyteLivestream::start::permission_denied"),new E("User does not have permission to start livestreaming");this.setLivestreamState("STARTING");try{const n=await Yn().startLivestreaming();this.playbackUrl=n}catch(r){throw p.error("DyteRecording::stop::livestream_failed_to_start",{error:r}),this.setLivestreamState("IDLE"),new E("Error while starting livestream")}}async stop(){if(!d(this,Kn).permissions.canLivestream)throw p.error("DyteLivestream::stop::permission_denied"),new E("User does not have permission to stop livestreaming");if(this.state!=="LIVESTREAMING")throw p.error("DyteLivestream::stop::inconsistent_state"),new E("Livestream not started yet");try{this.setLivestreamState("STOPPING"),await Yn().stopLivestreaming()}catch(r){throw p.error("DyteLivestream::stop::livestream_failed_to_stop",{error:r}),this.setLivestreamState("STOPPING"),new E("Error while stopping livestream")}}}Kn=new WeakMap;xp([v.trace("livestream.start")],od.prototype,"start",1);xp([v.trace("livestream.stop")],od.prototype,"stop",1);var WO=Object.defineProperty,jO=Object.getOwnPropertyDescriptor,An=(t,e,r,n)=>{for(var i=n>1?void 0:n?jO(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&WO(e,r,i),i},j,Mi,js,Ft,bt,Qt,Ni,jo;class Wr extends ht{constructor(r,n,i){super();S(this,bt);S(this,Ni);S(this,j,void 0);S(this,Mi,void 0);S(this,js,void 0);S(this,Ft,void 0);g(this,"status","ON_STAGE");g(this,"getSocketStageRequests",async()=>{});w(this,j,r),w(this,Mi,n),w(this,js,i),w(this,Ft,[]),this.setupEvents()}setupEvents(){d(this,j).permissions.acceptStageRequests&&d(this,j).permissions.stageEnabled&&this.getSocketStageRequests(),P.onAsync(I.GET_STAGE_REQUESTS,async r=>{w(this,Ft,r)}),P.onAsync(I.UPDATE_STAGE_REQUESTS,async({request:r,add:n})=>{n?w(this,Ft,[...d(this,Ft),r]):w(this,Ft,d(this,Ft).filter(i=>i.peerId!==r.peerId))})}getAccessRequests(){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(!d(this,j).permissions.acceptStageRequests)throw p.error("DyteStage::get_access_request::permission_denied"),new E("You do not have permission to perform this action/");return W(this,Ni,jo).call(this)?{stageRequests:d(this,Ft)}:{stageRequests:d(this,Mi).joined.toArray().filter(n=>n.stageStatus===Cr.REQUESTED_TO_JOIN_STAGE).map(n=>({displayName:n.name,userId:n.userId,peerId:n.id}))}}async requestAccess(){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(this.status!=="OFF_STAGE")throw new E(`Unable to request access you are currently ${this.status}`);if(W(this,Ni,jo).call(this)){if(d(this,j).permissions.stageAccess===x.Allowed){W(this,bt,Qt).call(this,"ACCEPTED_TO_JOIN_STAGE");return}W(this,bt,Qt).call(this,"REQUESTED_TO_JOIN_STAGE")}else{if(!d(this,j).roomJoined)throw new E("Can`t request to join stage without joining room");if(d(this,j).permissions.stageAccess===x.Allowed){W(this,bt,Qt).call(this,"ACCEPTED_TO_JOIN_STAGE");return}if(d(this,j).permissions.stageAccess===x.NotAllowed)throw p.error("DyteStage::requestGoToStage::permission_denied"),new E("User does not have permission to go on stage");if(this.status!=="OFF_STAGE")return;try{W(this,bt,Qt).call(this,"REQUESTED_TO_JOIN_STAGE")}catch(r){W(this,bt,Qt).call(this,"OFF_STAGE")}}}async cancelRequestAccess(){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(!d(this,j).roomJoined)throw new E("Can`t request to join stage without joining room");d(this,j).stageStatus===Cr.REQUESTED_TO_JOIN_STAGE&&W(this,bt,Qt).call(this,"OFF_STAGE")}grantAccess(r){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(!d(this,j).permissions.acceptStageRequests)throw p.error("DyteStage::grant_access::permission_denied"),new E("You do not have permission to perform this action/");if(!d(this,j).roomJoined)throw new E("Can`t rejectRequestToJoinStage for participant without joining room")}denyAccess(r){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(!d(this,j).permissions.acceptStageRequests)throw p.error("DyteStage::deny_access::permission_denied"),new E("You do not have permission to perform this action/");if(!d(this,j).roomJoined)throw new E("Can`t rejectRequestToJoinStage for participant without joining room")}async join(){if(this.status==="ON_STAGE")throw new E("You are already on stage.");if(d(this,j).permissions.stageAccess!==x.Allowed&&this.status!=="ACCEPTED_TO_JOIN_STAGE")throw new E(`Unable to join stage you are currently ${this.status}`);if(!d(this,j).roomJoined)throw new E("Can`t join stage without joining room");d(this,j).emit("stageJoined"),W(this,bt,Qt).call(this,"ON_STAGE")}async leave(){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(!d(this,j).roomJoined)throw new E("Can`t leave stage without joining room");await d(this,j).disableScreenShare(),await d(this,j).disableAudio(),await d(this,j).disableVideo(),W(this,bt,Qt).call(this,"OFF_STAGE")}async kick(r){if(!d(this,j).permissions.stageEnabled)throw p.error("DyteStage::stage_disabled"),new E("Stage is disabled");if(!d(this,j).permissions.acceptStageRequests)throw p.error("DyteStage::kick::permission_denied"),new E("You do not have permissions for kick");if(!d(this,j).roomJoined)throw new E("Can`t kick participant without joining room")}}j=new WeakMap,Mi=new WeakMap,js=new WeakMap,Ft=new WeakMap,bt=new WeakSet,Qt=async function(r){this.status!==r&&(this.status=r,await P.emitAsync(I.SET_STAGE_STATUS,r),this.emit("stageStatusUpdate",r))},Ni=new WeakSet,jo=function(){return!1};An([v.trace("DyteStage.getStageRequests")],Wr.prototype,"getAccessRequests",1);An([v.trace("DyteStage.requestAccess")],Wr.prototype,"requestAccess",1);An([v.trace("DyteStage.cancelRequestAccess")],Wr.prototype,"cancelRequestAccess",1);An([v.trace("DyteStage.grantAccess")],Wr.prototype,"grantAccess",1);An([v.trace("DyteStage.denyAccess")],Wr.prototype,"denyAccess",1);An([v.trace("DyteStage.joinStage")],Wr.prototype,"join",1);An([v.trace("DyteStage.leaveStage")],Wr.prototype,"leave",1);var or,xi,cr,Li,Ko;class KO extends wr{constructor(r,n){super();S(this,Li);S(this,or,void 0);S(this,xi,void 0);S(this,cr,void 0);w(this,or,r),w(this,cr,!1),w(this,xi,n)}get mediaPermission(){return d(this,or).mediaPermissions.audio}async getTrackMetadata(r=!1){if(!Zt.track){if(!r)return null;const n=await W(this,Li,Ko).call(this);Zt.setTrack(n)}return Zt.getTrackMetadata()}async startTrackAnalysis(r=!1){if(d(this,cr))return!0;w(this,cr,!0);let n=await Zt.startTrackAnalysis();if(!n&&r){const i=await W(this,Li,Ko).call(this);Zt.setTrack(i),n=await Zt.startTrackAnalysis()}return n||w(this,cr,!1),n}stopTrackAnalysis(){return d(this,cr)&&(w(this,cr,!1),Zt.stopTrackAnalysis()),!0}}or=new WeakMap,xi=new WeakMap,cr=new WeakMap,Li=new WeakSet,Ko=async function(){var r;try{const n=d(this,or).getCurrentDevices(),i=(r=n==null?void 0:n.audio)==null?void 0:r.deviceId,s=await d(this,xi).getAudioTrack(!1,i);return d(this,or).mediaPermissions.audio="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:d(this,or).mediaPermissions.audio,kind:"audio"}),s}catch(n){const i=ka("audio",n.name,n.message);throw d(this,or).mediaPermissions.audio=i,P.emit(I.MEDIA_PERMISSION_ERROR,{message:i,constraints:n.constraints,kind:"audio"}),new E("Failed to fetch audio track","1700")}};var Ks,Lp,Js,$p,$i,Jo;const Ys=class{constructor(e=1e3){S(this,Ks);S(this,Js);g(this,"sendTransport");g(this,"recvTransport");g(this,"collectStpStats");g(this,"collectRtpStats");g(this,"pingInterval");this.pingInterval=e}initSendTransport(e){this.sendTransport=e,P.emit(I.SEND_TRANSPORT_CREATED)}initRecvTransport(e){this.recvTransport=e,P.emit(I.RECV_TRANSPORT_CREATED)}collectSendTransportStats(){return!this.sendTransport||this.collectStpStats?!1:(this.collectStpStats=setInterval(W(this,Ks,Lp).bind(this),this.pingInterval),!0)}collectRecvTransportStats(){return!this.recvTransport||this.collectRtpStats?!1:(this.collectRtpStats=setInterval(W(this,Js,$p).bind(this),this.pingInterval),!0)}stopStatsCollection(e){return e==="send"?(clearInterval(this.collectStpStats),this.collectStpStats=void 0,!0):e==="receive"?(clearInterval(this.collectRtpStats),this.collectRtpStats=void 0,!0):!1}cleanup(e){this.stopStatsCollection(e),e==="send"?(this.sendTransport=void 0,this.collectStpStats=void 0,P.emit(I.SEND_TRANSPORT_CLOSED)):(this.recvTransport=void 0,this.collectRtpStats=void 0,P.emit(I.RECV_TRANSPORT_CLOSED))}};let ms=Ys;Ks=new WeakSet,Lp=function(){this.sendTransport||this.stopStatsCollection("send"),this.sendTransport.getStats().then(e=>{var r;return W(r=Ys,$i,Jo).call(r,e,"send")})},Js=new WeakSet,$p=function(){this.recvTransport||this.stopStatsCollection("receive"),this.recvTransport.getStats().then(e=>{var r;return W(r=Ys,$i,Jo).call(r,e,"receive")})},$i=new WeakSet,Jo=function(e,r){e.forEach(n=>{n.type==="candidate-pair"&&P.emit(I.CANDIDATE_PEER_UPDATE,{...n,transport:r}),n.type==="inbound-rtp"&&P.emit(I.INBOUND_RTP_UPDATE,{...n,transport:r}),n.type==="outbound-rtp"&&P.emit(I.OUTBOUND_RTP_UPDATE,{...n,transport:r})})},S(ms,$i);const is=new ms;var Nr;class JO extends wr{constructor(){super();S(this,Nr,void 0);w(this,Nr,!1)}async getNetworkMetadata(){return{}}startNetworkAnalysis(){return w(this,Nr,is.collectSendTransportStats()&&is.collectRecvTransportStats()),d(this,Nr)}stopNetworkAnalysis(){return w(this,Nr,!(is.stopStatsCollection("send")&&is.stopStatsCollection("receive"))),d(this,Nr)}}Nr=new WeakMap;var dn,Je;class YO extends wr{constructor(r){super();S(this,dn,void 0);S(this,Je,void 0);w(this,dn,r),w(this,Je,{audio:!1,video:!1})}get mediaPermission(){return d(this,dn).mediaPermissions.screenshare}getAudioTrackMetaData(){var r;return(r=d(this,dn).screenShareTracks)!=null&&r.audio?mi.getTrackMetadata():null}getVideoTrackMetaData(){var r;return(r=d(this,dn).screenShareTracks)!=null&&r.video?gi.getTrackMetadata():null}async startAudioTrackAnalysis(){if(d(this,Je).audio)return!0;const r=await mi.startTrackAnalysis();return d(this,Je).audio=r,d(this,Je).audio}async startVideoTrackAnalysis(){if(d(this,Je).video)return!0;const r=await gi.startTrackAnalysis();return d(this,Je).video=r,d(this,Je).video}stopAudioTrackAnalysis(){return d(this,Je)&&(d(this,Je).audio=!1,mi.stopTrackAnalysis()),!0}stopVideoTrackAnalysis(){return d(this,Je)&&(d(this,Je).video=!1,gi.stopTrackAnalysis()),!0}}dn=new WeakMap,Je=new WeakMap;var Vt,Ui,Bt,dr,zs,Up;class zO extends wr{constructor(r,n){super();S(this,zs);S(this,Vt,void 0);S(this,Ui,void 0);S(this,Bt,void 0);S(this,dr,void 0);g(this,"preview");w(this,Vt,r),w(this,Ui,n),w(this,Bt,!1),w(this,dr,!1)}get mediaPermission(){return d(this,Vt).mediaPermissions.video}getTrackMetadata(){return d(this,Vt).videoTrack?null:pt.getTrackMetadata()}async startTrackAnalysis({preview:r}={preview:!1}){return d(this,Bt)?!0:await pt.startTrackAnalysis()?((r||this.preview)&&w(this,dr,!0),w(this,Bt,!0),!0):!1}stopTrackAnalysis(){d(this,Bt)&&(pt.stopTrackAnalysis(),w(this,Bt,!1),d(this,dr)&&w(this,dr,!1))}async startPreview(){let{track:r}=pt;return r||(r=await W(this,zs,Up).call(this)),this.preview||(pt.setTrack(r),this.preview=!0,pt.preview=!0),r}stopPreview(){d(this,Bt)&&d(this,dr)&&this.stopTrackAnalysis(),this.preview=!1,pt.preview=!1,pt.cleanup()}cleanup(){d(this,Bt)&&d(this,dr)&&this.stopTrackAnalysis(),this.preview=!1,pt.preview=!1}}Vt=new WeakMap,Ui=new WeakMap,Bt=new WeakMap,dr=new WeakMap,zs=new WeakSet,Up=async function(){var r;try{const n=d(this,Vt).getCurrentDevices(),i=(r=n==null?void 0:n.video)==null?void 0:r.deviceId,s=await d(this,Ui).getVideoTrack(i);return d(this,Vt).mediaPermissions.video="ACCEPTED",P.emit(I.MEDIA_PERMISSION_UPDATE,{message:d(this,Vt).mediaPermissions.video,kind:"video"}),s}catch(n){const i=ka("video",n.name,n.message);throw d(this,Vt).mediaPermissions.video=i,P.emit(I.MEDIA_PERMISSION_ERROR,{message:i,constraints:n.constraints,kind:"video"}),new E("Failed to fetch video track","1700")}};class XO{constructor(e){g(this,"audio");g(this,"video");g(this,"screenshare");g(this,"network");const r=new id;this.audio=new KO(e,r),this.video=new zO(e,r),this.screenshare=new YO(e),this.network=new JO}}function QO(t){let e="",r=[""];const n=[r];let i=0,s=0,a=!0,o;for(o of t)o==='"'?(a&&o===e&&(r[i]+=o),a=!a):o===","&&a?o=r[++i]="":o===`
`&&a?(e==="\r"&&(r[i]=r[i].slice(0,-1)),r=n[++s]=[o=""],i=0):r[i]+=o,e=o;return n}var ZO=Object.defineProperty,eM=Object.getOwnPropertyDescriptor,cd=(t,e,r,n)=>{for(var i=n>1?void 0:n?eM(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&ZO(e,r,i),i};let xr=class extends ht{constructor(){super();g(this,"transcripts");this.transcripts=[]}static async init(e){const r=new xr;try{e&&await r.getActiveTranscript()}catch(n){p.error("Error fetching active transcriptions ",n)}return r}static parseTranscript(e){try{if(!e)return;const[[r,n,i,s,a,o]]=QO(e);return{id:qe.v4(),name:a,peerId:n,userId:i,customParticipantId:s,transcript:o,isPartialTranscript:!1,date:new Date(parseInt(r,10)*1e3)}}catch(r){p.error(`Failed to parse transcript: ${e}`,r);return}}static parseTranscripts(e){return e?e.split(`
`).map(xr.parseTranscript).filter(Boolean):[]}async getActiveTranscript(){try{const e=Yn(),{transcript:r}=await e.getActiveTranscript();this.transcripts=xr.parseTranscripts(r)}catch(e){}}async onTranscript(e){this.transcripts.push(e),this.emit("transcript",e)}};cd([v.trace("DyteAi.getActiveTranscript")],xr.prototype,"getActiveTranscript",1);cd([v.trace("DyteAi.onTranscript")],xr.prototype,"onTranscript",1);xr=cd([xe(t=>{throw new E(t.message,"0000")})],xr);function dd(t){let e=typeof t;if(e=="object"){if(Array.isArray(t))return"array";if(t===null)return"null"}return e}function tM(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}let ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Pa=[];for(let t=0;t<ur.length;t++)Pa[ur[t].charCodeAt(0)]=t;Pa["-".charCodeAt(0)]=ur.indexOf("+");Pa["_".charCodeAt(0)]=ur.indexOf("/");function rM(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let r=new Uint8Array(e),n=0,i=0,s,a=0;for(let o=0;o<t.length;o++){if(s=Pa[t.charCodeAt(o)],s===void 0)switch(t[o]){case"=":i=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=s,i=1;break;case 1:r[n++]=a<<2|(s&48)>>4,a=s,i=2;break;case 2:r[n++]=(a&15)<<4|(s&60)>>2,a=s,i=3;break;case 3:r[n++]=(a&3)<<6|s,i=0;break}}if(i==1)throw Error("invalid base64 string.");return r.subarray(0,n)}function nM(t){let e="",r=0,n,i=0;for(let s=0;s<t.length;s++)switch(n=t[s],r){case 0:e+=ur[n>>2],i=(n&3)<<4,r=1;break;case 1:e+=ur[i|n>>4],i=(n&15)<<2,r=2;break;case 2:e+=ur[i|n>>6],e+=ur[n&63],r=0;break}return r&&(e+=ur[i],e+="=",r==1&&(e+="=")),e}var Ps;(function(t){t.symbol=Symbol.for("protobuf-ts/unknown"),t.onRead=(r,n,i,s,a)=>{(e(n)?n[t.symbol]:n[t.symbol]=[]).push({no:i,wireType:s,data:a})},t.onWrite=(r,n,i)=>{for(let{no:s,wireType:a,data:o}of t.list(n))i.tag(s,a).raw(o)},t.list=(r,n)=>{if(e(r)){let i=r[t.symbol];return n?i.filter(s=>s.no==n):i}return[]},t.last=(r,n)=>t.list(r,n).slice(-1)[0];const e=r=>r&&Array.isArray(r[t.symbol])})(Ps||(Ps={}));var Ae;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(Ae||(Ae={}));function iM(){let t=0,e=0;for(let n=0;n<28;n+=7){let i=this.buf[this.pos++];if(t|=(i&127)<<n,!(i&128))return this.assertBounds(),[t,e]}let r=this.buf[this.pos++];if(t|=(r&15)<<28,e=(r&112)>>4,!(r&128))return this.assertBounds(),[t,e];for(let n=3;n<=31;n+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<n,!(i&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function ho(t,e,r){for(let s=0;s<28;s=s+7){const a=t>>>s,o=!(!(a>>>7)&&e==0),c=(o?a|128:a)&255;if(r.push(c),!o)return}const n=t>>>28&15|(e&7)<<4,i=!!(e>>3);if(r.push((i?n|128:n)&255),!!i){for(let s=3;s<31;s=s+7){const a=e>>>s,o=!!(a>>>7),c=(o?a|128:a)&255;if(r.push(c),!o)return}r.push(e>>>31&1)}}const gs=(1<<16)*(1<<16);function Fp(t){let e=t[0]=="-";e&&(t=t.slice(1));const r=1e6;let n=0,i=0;function s(a,o){const c=Number(t.slice(a,o));i*=r,n=n*r+c,n>=gs&&(i=i+(n/gs|0),n=n%gs)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),[e,n,i]}function Yo(t,e){if(e>>>0<=2097151)return""+(gs*e+(t>>>0));let r=t&16777215,n=(t>>>24|e<<8)>>>0&16777215,i=e>>16&65535,s=r+n*6777216+i*6710656,a=n+i*8147497,o=i*2,c=1e7;s>=c&&(a+=Math.floor(s/c),s%=c),a>=c&&(o+=Math.floor(a/c),a%=c);function u(h,f){let m=h?String(h):"";return f?"0000000".slice(m.length)+m:m}return u(o,0)+u(a,o)+u(s,1)}function tl(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let r=0;r<9;r++)e.push(t&127|128),t=t>>7;e.push(1)}}function sM(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let r=5;t&128&&r<10;r++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}let ne;function aM(){const t=new DataView(new ArrayBuffer(8));ne=globalThis.BigInt!==void 0&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:t}:void 0}aM();function Vp(t){if(!t)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}const Bp=/^-?[0-9]+$/,Ds=4294967296,ss=2147483648;class Gp{constructor(e,r){this.lo=e|0,this.hi=r|0}isZero(){return this.lo==0&&this.hi==0}toNumber(){let e=this.hi*Ds+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}class Ue extends Gp{static from(e){if(ne)switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=="")throw new Error("string is no integer");e=ne.C(e);case"number":if(e===0)return this.ZERO;e=ne.C(e);case"bigint":if(!e)return this.ZERO;if(e<ne.UMIN)throw new Error("signed value for ulong");if(e>ne.UMAX)throw new Error("ulong too large");return ne.V.setBigUint64(0,e,!0),new Ue(ne.V.getInt32(0,!0),ne.V.getInt32(4,!0))}else switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=e.trim(),!Bp.test(e))throw new Error("string is no integer");let[r,n,i]=Fp(e);if(r)throw new Error("signed value for ulong");return new Ue(n,i);case"number":if(e==0)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new Ue(e,e/Ds)}throw new Error("unknown value "+typeof e)}toString(){return ne?this.toBigInt().toString():Yo(this.lo,this.hi)}toBigInt(){return Vp(ne),ne.V.setInt32(0,this.lo,!0),ne.V.setInt32(4,this.hi,!0),ne.V.getBigUint64(0,!0)}}Ue.ZERO=new Ue(0,0);class ce extends Gp{static from(e){if(ne)switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=="")throw new Error("string is no integer");e=ne.C(e);case"number":if(e===0)return this.ZERO;e=ne.C(e);case"bigint":if(!e)return this.ZERO;if(e<ne.MIN)throw new Error("signed long too small");if(e>ne.MAX)throw new Error("signed long too large");return ne.V.setBigInt64(0,e,!0),new ce(ne.V.getInt32(0,!0),ne.V.getInt32(4,!0))}else switch(typeof e){case"string":if(e=="0")return this.ZERO;if(e=e.trim(),!Bp.test(e))throw new Error("string is no integer");let[r,n,i]=Fp(e);if(r){if(i>ss||i==ss&&n!=0)throw new Error("signed long too small")}else if(i>=ss)throw new Error("signed long too large");let s=new ce(n,i);return r?s.negate():s;case"number":if(e==0)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new ce(e,e/Ds):new ce(-e,-e/Ds).negate()}throw new Error("unknown value "+typeof e)}isNegative(){return(this.hi&ss)!==0}negate(){let e=~this.hi,r=this.lo;return r?r=~r+1:e+=1,new ce(r,e)}toString(){if(ne)return this.toBigInt().toString();if(this.isNegative()){let e=this.negate();return"-"+Yo(e.lo,e.hi)}return Yo(this.lo,this.hi)}toBigInt(){return Vp(ne),ne.V.setInt32(0,this.lo,!0),ne.V.setInt32(4,this.hi,!0),ne.V.getBigInt64(0,!0)}}ce.ZERO=new ce(0,0);const rl={readUnknownField:!0,readerFactory:t=>new cM(t)};function oM(t){return t?Object.assign(Object.assign({},rl),t):rl}class cM{constructor(e,r){this.varint64=iM,this.uint32=sM,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=r!=null?r:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}tag(){let e=this.uint32(),r=e>>>3,n=e&7;if(r<=0||n<0||n>5)throw new Error("illegal tag: field no "+r+" wire type "+n);return[r,n]}skip(e){let r=this.pos;switch(e){case Ae.Varint:for(;this.buf[this.pos++]&128;);break;case Ae.Bit64:this.pos+=4;case Ae.Bit32:this.pos+=4;break;case Ae.LengthDelimited:let n=this.uint32();this.pos+=n;break;case Ae.StartGroup:let i;for(;(i=this.tag()[1])!==Ae.EndGroup;)this.skip(i);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return new ce(...this.varint64())}uint64(){return new Ue(...this.varint64())}sint64(){let[e,r]=this.varint64(),n=-(e&1);return e=(e>>>1|(r&1)<<31)^n,r=r>>>1^n,new ce(e,r)}bool(){let[e,r]=this.varint64();return e!==0||r!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return new Ue(this.sfixed32(),this.sfixed32())}sfixed64(){return new ce(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),r=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(r,r+e)}string(){return this.textDecoder.decode(this.bytes())}}function Y(t,e){if(!t)throw new Error(e)}const dM=34028234663852886e22,uM=-34028234663852886e22,lM=4294967295,hM=2147483647,fM=-2147483648;function _i(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>hM||t<fM)throw new Error("invalid int 32: "+t)}function Os(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>lM||t<0)throw new Error("invalid uint 32: "+t)}function ud(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>dM||t<uM))throw new Error("invalid float 32: "+t)}const nl={writeUnknownFields:!0,writerFactory:()=>new mM};function pM(t){return t?Object.assign(Object.assign({},nl),t):nl}class mM{constructor(e){this.stack=[],this.textEncoder=e!=null?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let r=new Uint8Array(e),n=0;for(let i=0;i<this.chunks.length;i++)r.set(this.chunks[i],n),n+=this.chunks[i].length;return this.chunks=[],r}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),r=this.stack.pop();if(!r)throw new Error("invalid state, fork stack empty");return this.chunks=r.chunks,this.buf=r.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,r){return this.uint32((e<<3|r)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Os(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return _i(e),tl(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let r=this.textEncoder.encode(e);return this.uint32(r.byteLength),this.raw(r)}float(e){ud(e);let r=new Uint8Array(4);return new DataView(r.buffer).setFloat32(0,e,!0),this.raw(r)}double(e){let r=new Uint8Array(8);return new DataView(r.buffer).setFloat64(0,e,!0),this.raw(r)}fixed32(e){Os(e);let r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,e,!0),this.raw(r)}sfixed32(e){_i(e);let r=new Uint8Array(4);return new DataView(r.buffer).setInt32(0,e,!0),this.raw(r)}sint32(e){return _i(e),e=(e<<1^e>>31)>>>0,tl(e,this.buf),this}sfixed64(e){let r=new Uint8Array(8),n=new DataView(r.buffer),i=ce.from(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(r)}fixed64(e){let r=new Uint8Array(8),n=new DataView(r.buffer),i=Ue.from(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(r)}int64(e){let r=ce.from(e);return ho(r.lo,r.hi,this.buf),this}sint64(e){let r=ce.from(e),n=r.hi>>31,i=r.lo<<1^n,s=(r.hi<<1|r.lo>>>31)^n;return ho(i,s,this.buf),this}uint64(e){let r=Ue.from(e);return ho(r.lo,r.hi,this.buf),this}}const il={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},sl={ignoreUnknownFields:!1};function gM(t){return t?Object.assign(Object.assign({},sl),t):sl}function _M(t){return t?Object.assign(Object.assign({},il),t):il}const qp=Symbol.for("protobuf-ts/message-type");function al(t){let e=!1;const r=[];for(let n=0;n<t.length;n++){let i=t.charAt(n);i=="_"?e=!0:/\d/.test(i)?(r.push(i),e=!0):e?(r.push(i.toUpperCase()),e=!1):n==0?r.push(i.toLowerCase()):r.push(i)}return r.join("")}var y;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(y||(y={}));var Gt;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING",t[t.NUMBER=2]="NUMBER"})(Gt||(Gt={}));var Ms;(function(t){t[t.NO=0]="NO",t[t.PACKED=1]="PACKED",t[t.UNPACKED=2]="UNPACKED"})(Ms||(Ms={}));function vM(t){var e,r,n,i;return t.localName=(e=t.localName)!==null&&e!==void 0?e:al(t.name),t.jsonName=(r=t.jsonName)!==null&&r!==void 0?r:al(t.name),t.repeat=(n=t.repeat)!==null&&n!==void 0?n:Ms.NO,t.opt=(i=t.opt)!==null&&i!==void 0?i:t.repeat||t.oneof?!1:t.kind=="message",t}function TM(t){if(typeof t!="object"||t===null||!t.hasOwnProperty("oneofKind"))return!1;switch(typeof t.oneofKind){case"string":return t[t.oneofKind]===void 0?!1:Object.keys(t).length==2;case"undefined":return Object.keys(t).length==1;default:return!1}}class EM{constructor(e){var r;this.fields=(r=e.fields)!==null&&r!==void 0?r:[]}prepare(){if(this.data)return;const e=[],r=[],n=[];for(let i of this.fields)if(i.oneof)n.includes(i.oneof)||(n.push(i.oneof),e.push(i.oneof),r.push(i.oneof));else switch(r.push(i.localName),i.kind){case"scalar":case"enum":(!i.opt||i.repeat)&&e.push(i.localName);break;case"message":i.repeat&&e.push(i.localName);break;case"map":e.push(i.localName);break}this.data={req:e,known:r,oneofs:Object.values(n)}}is(e,r,n=!1){if(r<0)return!0;if(e==null||typeof e!="object")return!1;this.prepare();let i=Object.keys(e),s=this.data;if(i.length<s.req.length||s.req.some(a=>!i.includes(a))||!n&&i.some(a=>!s.known.includes(a)))return!1;if(r<1)return!0;for(const a of s.oneofs){const o=e[a];if(!TM(o))return!1;if(o.oneofKind===void 0)continue;const c=this.fields.find(u=>u.localName===o.oneofKind);if(!c||!this.field(o[o.oneofKind],c,n,r))return!1}for(const a of this.fields)if(a.oneof===void 0&&!this.field(e[a.localName],a,n,r))return!1;return!0}field(e,r,n,i){let s=r.repeat;switch(r.kind){case"scalar":return e===void 0?r.opt:s?this.scalars(e,r.T,i,r.L):this.scalar(e,r.T,r.L);case"enum":return e===void 0?r.opt:s?this.scalars(e,y.INT32,i):this.scalar(e,y.INT32);case"message":return e===void 0?!0:s?this.messages(e,r.T(),n,i):this.message(e,r.T(),n,i);case"map":if(typeof e!="object"||e===null)return!1;if(i<2)return!0;if(!this.mapKeys(e,r.K,i))return!1;switch(r.V.kind){case"scalar":return this.scalars(Object.values(e),r.V.T,i,r.V.L);case"enum":return this.scalars(Object.values(e),y.INT32,i);case"message":return this.messages(Object.values(e),r.V.T(),n,i)}break}return!0}message(e,r,n,i){return n?r.isAssignable(e,i):r.is(e,i)}messages(e,r,n,i){if(!Array.isArray(e))return!1;if(i<2)return!0;if(n){for(let s=0;s<e.length&&s<i;s++)if(!r.isAssignable(e[s],i-1))return!1}else for(let s=0;s<e.length&&s<i;s++)if(!r.is(e[s],i-1))return!1;return!0}scalar(e,r,n){let i=typeof e;switch(r){case y.UINT64:case y.FIXED64:case y.INT64:case y.SFIXED64:case y.SINT64:switch(n){case Gt.BIGINT:return i=="bigint";case Gt.NUMBER:return i=="number"&&!isNaN(e);default:return i=="string"}case y.BOOL:return i=="boolean";case y.STRING:return i=="string";case y.BYTES:return e instanceof Uint8Array;case y.DOUBLE:case y.FLOAT:return i=="number"&&!isNaN(e);default:return i=="number"&&Number.isInteger(e)}}scalars(e,r,n,i){if(!Array.isArray(e))return!1;if(n<2)return!0;if(Array.isArray(e)){for(let s=0;s<e.length&&s<n;s++)if(!this.scalar(e[s],r,i))return!1}return!0}mapKeys(e,r,n){let i=Object.keys(e);switch(r){case y.INT32:case y.FIXED32:case y.SFIXED32:case y.SINT32:case y.UINT32:return this.scalars(i.slice(0,n).map(s=>parseInt(s)),r,n);case y.BOOL:return this.scalars(i.slice(0,n).map(s=>s=="true"?!0:s=="false"?!1:s),r,n);default:return this.scalars(i,r,n,Gt.STRING)}}}function kt(t,e){switch(e){case Gt.BIGINT:return t.toBigInt();case Gt.NUMBER:return t.toNumber();default:return t.toString()}}class wM{constructor(e){this.info=e}prepare(){var e;if(this.fMap===void 0){this.fMap={};const r=(e=this.info.fields)!==null&&e!==void 0?e:[];for(const n of r)this.fMap[n.name]=n,this.fMap[n.jsonName]=n,this.fMap[n.localName]=n}}assert(e,r,n){if(!e){let i=dd(n);throw(i=="number"||i=="boolean")&&(i=n.toString()),new Error(`Cannot parse JSON ${i} for ${this.info.typeName}#${r}`)}}read(e,r,n){this.prepare();const i=[];for(const[s,a]of Object.entries(e)){const o=this.fMap[s];if(!o){if(!n.ignoreUnknownFields)throw new Error(`Found unknown field while reading ${this.info.typeName} from JSON format. JSON key: ${s}`);continue}const c=o.localName;let u;if(o.oneof){if(a===null&&(o.kind!=="enum"||o.T()[0]!=="google.protobuf.NullValue"))continue;if(i.includes(o.oneof))throw new Error(`Multiple members of the oneof group "${o.oneof}" of ${this.info.typeName} are present in JSON.`);i.push(o.oneof),u=r[o.oneof]={oneofKind:c}}else u=r;if(o.kind=="map"){if(a===null)continue;this.assert(tM(a),o.name,a);const h=u[c];for(const[f,m]of Object.entries(a)){this.assert(m!==null,o.name+" map value",null);let T;switch(o.V.kind){case"message":T=o.V.T().internalJsonRead(m,n);break;case"enum":if(T=this.enum(o.V.T(),m,o.name,n.ignoreUnknownFields),T===!1)continue;break;case"scalar":T=this.scalar(m,o.V.T,o.V.L,o.name);break}this.assert(T!==void 0,o.name+" map value",m);let A=f;o.K==y.BOOL&&(A=A=="true"?!0:A=="false"?!1:A),A=this.scalar(A,o.K,Gt.STRING,o.name).toString(),h[A]=T}}else if(o.repeat){if(a===null)continue;this.assert(Array.isArray(a),o.name,a);const h=u[c];for(const f of a){this.assert(f!==null,o.name,null);let m;switch(o.kind){case"message":m=o.T().internalJsonRead(f,n);break;case"enum":if(m=this.enum(o.T(),f,o.name,n.ignoreUnknownFields),m===!1)continue;break;case"scalar":m=this.scalar(f,o.T,o.L,o.name);break}this.assert(m!==void 0,o.name,a),h.push(m)}}else switch(o.kind){case"message":if(a===null&&o.T().typeName!="google.protobuf.Value"){this.assert(o.oneof===void 0,o.name+" (oneof member)",null);continue}u[c]=o.T().internalJsonRead(a,n,u[c]);break;case"enum":let h=this.enum(o.T(),a,o.name,n.ignoreUnknownFields);if(h===!1)continue;u[c]=h;break;case"scalar":u[c]=this.scalar(a,o.T,o.L,o.name);break}}}enum(e,r,n,i){if(e[0]=="google.protobuf.NullValue"&&Y(r===null||r==="NULL_VALUE",`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} only accepts null.`),r===null)return 0;switch(typeof r){case"number":return Y(Number.isInteger(r),`Unable to parse field ${this.info.typeName}#${n}, enum can only be integral number, got ${r}.`),r;case"string":let s=r;e[2]&&r.substring(0,e[2].length)===e[2]&&(s=r.substring(e[2].length));let a=e[1][s];return typeof a=="undefined"&&i?!1:(Y(typeof a=="number",`Unable to parse field ${this.info.typeName}#${n}, enum ${e[0]} has no value for "${r}".`),a)}Y(!1,`Unable to parse field ${this.info.typeName}#${n}, cannot parse enum value from ${typeof r}".`)}scalar(e,r,n,i){let s;try{switch(r){case y.DOUBLE:case y.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""){s="empty string";break}if(typeof e=="string"&&e.trim().length!==e.length){s="extra whitespace";break}if(typeof e!="string"&&typeof e!="number")break;let a=Number(e);if(Number.isNaN(a)){s="not a number";break}if(!Number.isFinite(a)){s="too large or small";break}return r==y.FLOAT&&ud(a),a;case y.INT32:case y.FIXED32:case y.SFIXED32:case y.SINT32:case y.UINT32:if(e===null)return 0;let o;if(typeof e=="number"?o=e:e===""?s="empty string":typeof e=="string"&&(e.trim().length!==e.length?s="extra whitespace":o=Number(e)),o===void 0)break;return r==y.UINT32?Os(o):_i(o),o;case y.INT64:case y.SFIXED64:case y.SINT64:if(e===null)return kt(ce.ZERO,n);if(typeof e!="number"&&typeof e!="string")break;return kt(ce.from(e),n);case y.FIXED64:case y.UINT64:if(e===null)return kt(Ue.ZERO,n);if(typeof e!="number"&&typeof e!="string")break;return kt(Ue.from(e),n);case y.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case y.STRING:if(e===null)return"";if(typeof e!="string"){s="extra whitespace";break}try{encodeURIComponent(e)}catch(c){c="invalid UTF8";break}return e;case y.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return rM(e)}}catch(a){s=a.message}this.assert(!1,i+(s?" - "+s:""),e)}}class yM{constructor(e){var r;this.fields=(r=e.fields)!==null&&r!==void 0?r:[]}write(e,r){const n={},i=e;for(const s of this.fields){if(!s.oneof){let u=this.field(s,i[s.localName],r);u!==void 0&&(n[r.useProtoFieldName?s.name:s.jsonName]=u);continue}const a=i[s.oneof];if(a.oneofKind!==s.localName)continue;const o=s.kind=="scalar"||s.kind=="enum"?Object.assign(Object.assign({},r),{emitDefaultValues:!0}):r;let c=this.field(s,a[s.localName],o);Y(c!==void 0),n[r.useProtoFieldName?s.name:s.jsonName]=c}return n}field(e,r,n){let i;if(e.kind=="map"){Y(typeof r=="object"&&r!==null);const s={};switch(e.V.kind){case"scalar":for(const[c,u]of Object.entries(r)){const h=this.scalar(e.V.T,u,e.name,!1,!0);Y(h!==void 0),s[c.toString()]=h}break;case"message":const a=e.V.T();for(const[c,u]of Object.entries(r)){const h=this.message(a,u,e.name,n);Y(h!==void 0),s[c.toString()]=h}break;case"enum":const o=e.V.T();for(const[c,u]of Object.entries(r)){Y(u===void 0||typeof u=="number");const h=this.enum(o,u,e.name,!1,!0,n.enumAsInteger);Y(h!==void 0),s[c.toString()]=h}break}(n.emitDefaultValues||Object.keys(s).length>0)&&(i=s)}else if(e.repeat){Y(Array.isArray(r));const s=[];switch(e.kind){case"scalar":for(let c=0;c<r.length;c++){const u=this.scalar(e.T,r[c],e.name,e.opt,!0);Y(u!==void 0),s.push(u)}break;case"enum":const a=e.T();for(let c=0;c<r.length;c++){Y(r[c]===void 0||typeof r[c]=="number");const u=this.enum(a,r[c],e.name,e.opt,!0,n.enumAsInteger);Y(u!==void 0),s.push(u)}break;case"message":const o=e.T();for(let c=0;c<r.length;c++){const u=this.message(o,r[c],e.name,n);Y(u!==void 0),s.push(u)}break}(n.emitDefaultValues||s.length>0||n.emitDefaultValues)&&(i=s)}else switch(e.kind){case"scalar":i=this.scalar(e.T,r,e.name,e.opt,n.emitDefaultValues);break;case"enum":i=this.enum(e.T(),r,e.name,e.opt,n.emitDefaultValues,n.enumAsInteger);break;case"message":i=this.message(e.T(),r,e.name,n);break}return i}enum(e,r,n,i,s,a){if(e[0]=="google.protobuf.NullValue")return!s&&!i?void 0:null;if(r===void 0){Y(i);return}if(!(r===0&&!s&&!i))return Y(typeof r=="number"),Y(Number.isInteger(r)),a||!e[1].hasOwnProperty(r)?r:e[2]?e[2]+e[1][r]:e[1][r]}message(e,r,n,i){return r===void 0?i.emitDefaultValues?null:void 0:e.internalJsonWrite(r,i)}scalar(e,r,n,i,s){if(r===void 0){Y(i);return}const a=s||i;switch(e){case y.INT32:case y.SFIXED32:case y.SINT32:return r===0?a?0:void 0:(_i(r),r);case y.FIXED32:case y.UINT32:return r===0?a?0:void 0:(Os(r),r);case y.FLOAT:ud(r);case y.DOUBLE:return r===0?a?0:void 0:(Y(typeof r=="number"),Number.isNaN(r)?"NaN":r===Number.POSITIVE_INFINITY?"Infinity":r===Number.NEGATIVE_INFINITY?"-Infinity":r);case y.STRING:return r===""?a?"":void 0:(Y(typeof r=="string"),r);case y.BOOL:return r===!1?a?!1:void 0:(Y(typeof r=="boolean"),r);case y.UINT64:case y.FIXED64:Y(typeof r=="number"||typeof r=="string"||typeof r=="bigint");let o=Ue.from(r);return o.isZero()&&!a?void 0:o.toString();case y.INT64:case y.SFIXED64:case y.SINT64:Y(typeof r=="number"||typeof r=="string"||typeof r=="bigint");let c=ce.from(r);return c.isZero()&&!a?void 0:c.toString();case y.BYTES:return Y(r instanceof Uint8Array),r.byteLength?nM(r):a?"":void 0}}}function zo(t,e=Gt.STRING){switch(t){case y.BOOL:return!1;case y.UINT64:case y.FIXED64:return kt(Ue.ZERO,e);case y.INT64:case y.SFIXED64:case y.SINT64:return kt(ce.ZERO,e);case y.DOUBLE:case y.FLOAT:return 0;case y.BYTES:return new Uint8Array(0);case y.STRING:return"";default:return 0}}class AM{constructor(e){this.info=e}prepare(){var e;if(!this.fieldNoToField){const r=(e=this.info.fields)!==null&&e!==void 0?e:[];this.fieldNoToField=new Map(r.map(n=>[n.no,n]))}}read(e,r,n,i){this.prepare();const s=i===void 0?e.len:e.pos+i;for(;e.pos<s;){const[a,o]=e.tag(),c=this.fieldNoToField.get(a);if(!c){let m=n.readUnknownField;if(m=="throw")throw new Error(`Unknown field ${a} (wire type ${o}) for ${this.info.typeName}`);let T=e.skip(o);m!==!1&&(m===!0?Ps.onRead:m)(this.info.typeName,r,a,o,T);continue}let u=r,h=c.repeat,f=c.localName;switch(c.oneof&&(u=u[c.oneof],u.oneofKind!==f&&(u=r[c.oneof]={oneofKind:f})),c.kind){case"scalar":case"enum":let m=c.kind=="enum"?y.INT32:c.T,T=c.kind=="scalar"?c.L:void 0;if(h){let R=u[f];if(o==Ae.LengthDelimited&&m!=y.STRING&&m!=y.BYTES){let b=e.uint32()+e.pos;for(;e.pos<b;)R.push(this.scalar(e,m,T))}else R.push(this.scalar(e,m,T))}else u[f]=this.scalar(e,m,T);break;case"message":if(h){let R=u[f],b=c.T().internalBinaryRead(e,e.uint32(),n);R.push(b)}else u[f]=c.T().internalBinaryRead(e,e.uint32(),n,u[f]);break;case"map":let[A,C]=this.mapEntry(c,e,n);u[f][A]=C;break}}}mapEntry(e,r,n){let i=r.uint32(),s=r.pos+i,a,o;for(;r.pos<s;){let[c,u]=r.tag();switch(c){case 1:e.K==y.BOOL?a=r.bool().toString():a=this.scalar(r,e.K,Gt.STRING);break;case 2:switch(e.V.kind){case"scalar":o=this.scalar(r,e.V.T,e.V.L);break;case"enum":o=r.int32();break;case"message":o=e.V.T().internalBinaryRead(r,r.uint32(),n);break}break;default:throw new Error(`Unknown field ${c} (wire type ${u}) in map entry for ${this.info.typeName}#${e.name}`)}}if(a===void 0){let c=zo(e.K);a=e.K==y.BOOL?c.toString():c}if(o===void 0)switch(e.V.kind){case"scalar":o=zo(e.V.T,e.V.L);break;case"enum":o=0;break;case"message":o=e.V.T().create();break}return[a,o]}scalar(e,r,n){switch(r){case y.INT32:return e.int32();case y.STRING:return e.string();case y.BOOL:return e.bool();case y.DOUBLE:return e.double();case y.FLOAT:return e.float();case y.INT64:return kt(e.int64(),n);case y.UINT64:return kt(e.uint64(),n);case y.FIXED64:return kt(e.fixed64(),n);case y.FIXED32:return e.fixed32();case y.BYTES:return e.bytes();case y.UINT32:return e.uint32();case y.SFIXED32:return e.sfixed32();case y.SFIXED64:return kt(e.sfixed64(),n);case y.SINT32:return e.sint32();case y.SINT64:return kt(e.sint64(),n)}}}class RM{constructor(e){this.info=e}prepare(){if(!this.fields){const e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort((r,n)=>r.no-n.no)}}write(e,r,n){this.prepare();for(const s of this.fields){let a,o,c=s.repeat,u=s.localName;if(s.oneof){const h=e[s.oneof];if(h.oneofKind!==u)continue;a=h[u],o=!0}else a=e[u],o=!1;switch(s.kind){case"scalar":case"enum":let h=s.kind=="enum"?y.INT32:s.T;if(c)if(Y(Array.isArray(a)),c==Ms.PACKED)this.packed(r,h,s.no,a);else for(const f of a)this.scalar(r,h,s.no,f,!0);else a===void 0?Y(s.opt):this.scalar(r,h,s.no,a,o||s.opt);break;case"message":if(c){Y(Array.isArray(a));for(const f of a)this.message(r,n,s.T(),s.no,f)}else this.message(r,n,s.T(),s.no,a);break;case"map":Y(typeof a=="object"&&a!==null);for(const[f,m]of Object.entries(a))this.mapEntry(r,n,s,f,m);break}}let i=n.writeUnknownFields;i!==!1&&(i===!0?Ps.onWrite:i)(this.info.typeName,e,r)}mapEntry(e,r,n,i,s){e.tag(n.no,Ae.LengthDelimited),e.fork();let a=i;switch(n.K){case y.INT32:case y.FIXED32:case y.UINT32:case y.SFIXED32:case y.SINT32:a=Number.parseInt(i);break;case y.BOOL:Y(i=="true"||i=="false"),a=i=="true";break}switch(this.scalar(e,n.K,1,a,!0),n.V.kind){case"scalar":this.scalar(e,n.V.T,2,s,!0);break;case"enum":this.scalar(e,y.INT32,2,s,!0);break;case"message":this.message(e,r,n.V.T(),2,s);break}e.join()}message(e,r,n,i,s){s!==void 0&&(n.internalBinaryWrite(s,e.tag(i,Ae.LengthDelimited).fork(),r),e.join())}scalar(e,r,n,i,s){let[a,o,c]=this.scalarInfo(r,i);(!c||s)&&(e.tag(n,a),e[o](i))}packed(e,r,n,i){if(!i.length)return;Y(r!==y.BYTES&&r!==y.STRING),e.tag(n,Ae.LengthDelimited),e.fork();let[,s]=this.scalarInfo(r);for(let a=0;a<i.length;a++)e[s](i[a]);e.join()}scalarInfo(e,r){let n=Ae.Varint,i,s=r===void 0,a=r===0;switch(e){case y.INT32:i="int32";break;case y.STRING:a=s||!r.length,n=Ae.LengthDelimited,i="string";break;case y.BOOL:a=r===!1,i="bool";break;case y.UINT32:i="uint32";break;case y.DOUBLE:n=Ae.Bit64,i="double";break;case y.FLOAT:n=Ae.Bit32,i="float";break;case y.INT64:a=s||ce.from(r).isZero(),i="int64";break;case y.UINT64:a=s||Ue.from(r).isZero(),i="uint64";break;case y.FIXED64:a=s||Ue.from(r).isZero(),n=Ae.Bit64,i="fixed64";break;case y.BYTES:a=s||!r.byteLength,n=Ae.LengthDelimited,i="bytes";break;case y.FIXED32:n=Ae.Bit32,i="fixed32";break;case y.SFIXED32:n=Ae.Bit32,i="sfixed32";break;case y.SFIXED64:a=s||ce.from(r).isZero(),n=Ae.Bit64,i="sfixed64";break;case y.SINT32:i="sint32";break;case y.SINT64:a=s||ce.from(r).isZero(),i="sint64";break}return[n,i,s||a]}}function SM(t){const e=t.messagePrototype?Object.create(t.messagePrototype):Object.defineProperty({},qp,{value:t});for(let r of t.fields){let n=r.localName;if(!r.opt)if(r.oneof)e[r.oneof]={oneofKind:void 0};else if(r.repeat)e[n]=[];else switch(r.kind){case"scalar":e[n]=zo(r.T,r.L);break;case"enum":e[n]=0;break;case"map":e[n]={};break}}return e}function fo(t,e,r){let n,i=r,s;for(let a of t.fields){let o=a.localName;if(a.oneof){const c=i[a.oneof];if((c==null?void 0:c.oneofKind)==null)continue;if(n=c[o],s=e[a.oneof],s.oneofKind=c.oneofKind,n==null){delete s[o];continue}}else if(n=i[o],s=e,n==null)continue;switch(a.repeat&&(s[o].length=n.length),a.kind){case"scalar":case"enum":if(a.repeat)for(let u=0;u<n.length;u++)s[o][u]=n[u];else s[o]=n;break;case"message":let c=a.T();if(a.repeat)for(let u=0;u<n.length;u++)s[o][u]=c.create(n[u]);else s[o]===void 0?s[o]=c.create(n):c.mergePartial(s[o],n);break;case"map":switch(a.V.kind){case"scalar":case"enum":Object.assign(s[o],n);break;case"message":let u=a.V.T();for(let h of Object.keys(n))s[o][h]=u.create(n[h]);break}break}}}function bM(t,e,r){if(e===r)return!0;if(!e||!r)return!1;for(let n of t.fields){let i=n.localName,s=n.oneof?e[n.oneof][i]:e[i],a=n.oneof?r[n.oneof][i]:r[i];switch(n.kind){case"enum":case"scalar":let o=n.kind=="enum"?y.INT32:n.T;if(!(n.repeat?ol(o,s,a):Hp(o,s,a)))return!1;break;case"map":if(!(n.V.kind=="message"?cl(n.V.T(),as(s),as(a)):ol(n.V.kind=="enum"?y.INT32:n.V.T,as(s),as(a))))return!1;break;case"message":let c=n.T();if(!(n.repeat?cl(c,s,a):c.equals(s,a)))return!1;break}}return!0}const as=Object.values;function Hp(t,e,r){if(e===r)return!0;if(t!==y.BYTES)return!1;let n=e,i=r;if(n.length!==i.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!=i[s])return!1;return!0}function ol(t,e,r){if(e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(!Hp(t,e[n],r[n]))return!1;return!0}function cl(t,e,r){if(e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(!t.equals(e[n],r[n]))return!1;return!0}const kM=Object.getOwnPropertyDescriptors(Object.getPrototypeOf({}));class _{constructor(e,r,n){this.defaultCheckDepth=16,this.typeName=e,this.fields=r.map(vM),this.options=n!=null?n:{},this.messagePrototype=Object.create(null,Object.assign(Object.assign({},kM),{[qp]:{value:this}})),this.refTypeCheck=new EM(this),this.refJsonReader=new wM(this),this.refJsonWriter=new yM(this),this.refBinReader=new AM(this),this.refBinWriter=new RM(this)}create(e){let r=SM(this);return e!==void 0&&fo(this,r,e),r}clone(e){let r=this.create();return fo(this,r,e),r}equals(e,r){return bM(this,e,r)}is(e,r=this.defaultCheckDepth){return this.refTypeCheck.is(e,r,!1)}isAssignable(e,r=this.defaultCheckDepth){return this.refTypeCheck.is(e,r,!0)}mergePartial(e,r){fo(this,e,r)}fromBinary(e,r){let n=oM(r);return this.internalBinaryRead(n.readerFactory(e),e.byteLength,n)}fromJson(e,r){return this.internalJsonRead(e,gM(r))}fromJsonString(e,r){let n=JSON.parse(e);return this.fromJson(n,r)}toJson(e,r){return this.internalJsonWrite(e,_M(r))}toJsonString(e,r){var n;let i=this.toJson(e,r);return JSON.stringify(i,null,(n=r==null?void 0:r.prettySpaces)!==null&&n!==void 0?n:0)}toBinary(e,r){let n=pM(r);return this.internalBinaryWrite(e,n.writerFactory(),n).finish()}internalJsonRead(e,r,n){if(e!==null&&typeof e=="object"&&!Array.isArray(e)){let i=n!=null?n:this.create();return this.refJsonReader.read(e,i,r),i}throw new Error(`Unable to parse message ${this.typeName} from JSON ${dd(e)}.`)}internalJsonWrite(e,r){return this.refJsonWriter.write(e,r)}internalBinaryWrite(e,r,n){return this.refBinWriter.write(e,r,n),r}internalBinaryRead(e,r,n,i){let s=i!=null?i:this.create();return this.refBinReader.read(e,s,n,r),s}}var Xo;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(Xo||(Xo={}));var Qo;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO"})(Qo||(Qo={}));class CM extends _{constructor(){super("media.Codec",[])}}new CM;class IM extends _{constructor(){super("media.Fingerprint",[{no:1,name:"algorithm",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:9}])}}new IM;class PM extends _{constructor(){super("media.SessionDescription",[{no:1,name:"target",kind:"enum",T:()=>["media.Target",Xo]},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"sdp",kind:"scalar",T:9}])}}const Rr=new PM;class DM extends _{constructor(){super("media.CreateTransportRequest",[{no:1,name:"consuming",kind:"scalar",T:8},{no:2,name:"force_tcp",kind:"scalar",opt:!0,T:8},{no:3,name:"description",kind:"message",T:()=>Rr}])}}new DM;class OM extends _{constructor(){super("media.CreateTransportResponse",[{no:1,name:"transport_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:()=>Rr},{no:3,name:"transcription_enabled",kind:"scalar",opt:!0,T:8}])}}const MM=new OM;class NM extends _{constructor(){super("media.RenegotiateRequest",[{no:1,name:"transport_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:()=>Rr}])}}new NM;class xM extends _{constructor(){super("media.RenegotiateResponse",[{no:1,name:"transport_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:()=>Rr}])}}new xM;class LM extends _{constructor(){super("media.NestedScore",[{no:1,name:"encoding_idx",kind:"scalar",T:5},{no:2,name:"rid",kind:"scalar",T:9},{no:3,name:"score",kind:"scalar",T:5},{no:4,name:"ssrc",kind:"scalar",T:3,L:0}])}}const $M=new LM;class UM extends _{constructor(){super("media.ProducerTrack",[{no:1,name:"track_id",kind:"scalar",T:9},{no:2,name:"producer_id",kind:"scalar",T:9},{no:3,name:"stream_id",kind:"scalar",T:9}])}}const FM=new UM;class VM extends _{constructor(){super("media.ProducerEntry",[{no:1,name:"producing_transport_id",kind:"scalar",T:9},{no:2,name:"producer_id",kind:"scalar",T:9}])}}new VM;class BM extends _{constructor(){super("media.ConsumerEntry",[{no:1,name:"consuming_transport_id",kind:"scalar",T:9},{no:2,name:"consumer_id",kind:"scalar",T:9}])}}new BM;class GM extends _{constructor(){super("media.ProducerState",[{no:1,name:"producer_id",kind:"scalar",T:9},{no:2,name:"kind",kind:"enum",T:()=>["media.ProducerKind",Qo]},{no:3,name:"pause",kind:"scalar",T:8},{no:4,name:"screen_share",kind:"scalar",T:8},{no:5,name:"app_data",kind:"scalar",opt:!0,T:9}])}}const Qi=new GM;class qM extends _{constructor(){super("media.ConsumerState",[{no:1,name:"consumer_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:()=>Qi},{no:3,name:"producer_track",kind:"message",T:()=>FM}])}}const HM=new qM;class WM extends _{constructor(){super("media.ProducerIdToConsumerMap",[{no:1,name:"map",kind:"map",K:9,V:{kind:"message",T:()=>HM}}])}}const Wp=new WM;class jM extends _{constructor(){super("media.edge.GeoLocation",[{no:1,name:"latitude",kind:"scalar",T:2},{no:2,name:"longitude",kind:"scalar",T:2},{no:3,name:"region",kind:"scalar",opt:!0,T:9}])}}const KM=new jM;class JM extends _{constructor(){super("media.edge.PeerJoinRequest",[{no:1,name:"display_name",kind:"scalar",opt:!0,T:9},{no:2,name:"prejoined",kind:"scalar",T:8},{no:3,name:"room_uuid",kind:"scalar",T:9},{no:4,name:"meeting_id",kind:"scalar",opt:!0,T:9},{no:5,name:"preset",kind:"scalar",opt:!0,T:12},{no:6,name:"user_id",kind:"scalar",opt:!0,T:9},{no:7,name:"organization_id",kind:"scalar",opt:!0,T:9},{no:8,name:"location",kind:"message",T:()=>KM}])}}new JM;class YM extends _{constructor(){super("media.edge.PeerJoinCompleteRequest",[])}}new YM;class zM extends _{constructor(){super("media.edge.PeerLeaveRequest",[{no:1,name:"close_room",kind:"scalar",T:8}])}}new zM;class XM extends _{constructor(){super("media.edge.ConsumeMultipleProducerRequest",[{no:1,name:"producer_ids",kind:"scalar",repeat:2,T:9},{no:2,name:"paused",kind:"scalar",opt:!0,T:8}])}}new XM;class QM extends _{constructor(){super("media.edge.ConsumePeerRequest",[{no:1,name:"producing_peer_id",kind:"scalar",T:9},{no:2,name:"paused",kind:"scalar",opt:!0,T:8},{no:3,name:"producer_id",kind:"scalar",opt:!0,T:9}])}}new QM;class ZM extends _{constructor(){super("media.edge.ProducerCreateRequest",[{no:1,name:"kind",kind:"scalar",T:9},{no:2,name:"paused",kind:"scalar",T:8},{no:3,name:"screen_share",kind:"scalar",T:8},{no:4,name:"description",kind:"message",T:()=>Rr},{no:5,name:"msid",kind:"scalar",T:9},{no:6,name:"app_data",kind:"scalar",opt:!0,T:9}])}}new ZM;class eN extends _{constructor(){super("media.edge.SelectedPeersRequest",[])}}new eN;class tN extends _{constructor(){super("media.edge.GlobalPeerPinningRequest",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new tN;class rN extends _{constructor(){super("media.edge.ProducerToggleRequest",[{no:1,name:"producer_id",kind:"scalar",T:9},{no:2,name:"pause",kind:"scalar",T:8}])}}new rN;class nN extends _{constructor(){super("media.edge.ConsumerToggleRequest",[{no:1,name:"consumer_id",kind:"scalar",T:9},{no:2,name:"pause",kind:"scalar",T:8}])}}new nN;class iN extends _{constructor(){super("media.edge.ProducerCloseRequest",[{no:1,name:"producer_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:()=>Rr}])}}new iN;class sN extends _{constructor(){super("media.edge.ConsumerCloseRequest",[{no:1,name:"consumer_ids",kind:"scalar",repeat:2,T:9},{no:2,name:"description",kind:"message",T:()=>Rr}])}}new sN;class aN extends _{constructor(){super("media.edge.KickPeerRequest",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new aN;class oN extends _{constructor(){super("media.edge.KickAllPeersRequest",[])}}new oN;class cN extends _{constructor(){super("media.edge.PeerDisplayNameEditRequest",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"display_name",kind:"scalar",T:9}])}}new cN;class dN extends _{constructor(){super("media.edge.HostMediaControlForPeerRequest",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"audio",kind:"scalar",T:8},{no:3,name:"video",kind:"scalar",T:8},{no:4,name:"scree_share",kind:"scalar",T:8}])}}new dN;class uN extends _{constructor(){super("media.edge.HostMediaControlForAllPeerRequest",[{no:1,name:"audio",kind:"scalar",T:8},{no:2,name:"video",kind:"scalar",T:8},{no:3,name:"screen_share",kind:"scalar",T:8}])}}new uN;class lN extends _{constructor(){super("media.edge.GetRoomStateResponse",[{no:1,name:"display_title",kind:"scalar",T:9},{no:2,name:"locked_mode",kind:"scalar",T:8},{no:3,name:"room_uuid",kind:"scalar",T:9},{no:4,name:"room_name",kind:"scalar",T:9},{no:5,name:"current_peer_id",kind:"scalar",T:9},{no:6,name:"is_recording",kind:"scalar",opt:!0,T:8},{no:7,name:"recorder_participant_id",kind:"scalar",opt:!0,T:9},{no:8,name:"pinned_peer_ids",kind:"scalar",repeat:2,T:9}])}}const hN=new lN;class fN extends _{constructor(){super("media.edge.ErrorResponse",[{no:1,name:"error_message",kind:"scalar",T:9},{no:2,name:"event_id",kind:"scalar",T:5}])}}new fN;class pN extends _{constructor(){super("media.edge.EmptyResponse",[])}}new pN;class mN extends _{constructor(){super("media.edge.RoomParticipants",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"producer_states",kind:"message",repeat:1,T:()=>Qi},{no:3,name:"display_name",kind:"scalar",T:9},{no:4,name:"user_id",kind:"scalar",opt:!0,T:9}])}}const jp=new mN;class gN extends _{constructor(){super("media.edge.SelectedPeersResponse",[{no:1,name:"audio_peers",kind:"scalar",repeat:2,T:9},{no:2,name:"compulsory_peers",kind:"scalar",repeat:2,T:9}])}}const _N=new gN;class vN extends _{constructor(){super("media.edge.SelectedPeersDiffEntry",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"priority",kind:"scalar",T:5}])}}const TN=new vN;class EN extends _{constructor(){super("media.edge.SelectedPeersDiffResponse",[{no:1,name:"entries",kind:"message",repeat:1,T:()=>TN}])}}new EN;class wN extends _{constructor(){super("media.edge.PeerJoinResponse",[])}}new wN;class yN extends _{constructor(){super("media.edge.PeerJoinCompleteResponse",[{no:1,name:"room_state",kind:"message",T:()=>hN},{no:2,name:"participants",kind:"message",repeat:1,T:()=>jp},{no:3,name:"selected_peers",kind:"message",T:()=>_N},{no:4,name:"max_preferred_streams",kind:"scalar",T:5}])}}new yN;class AN extends _{constructor(){super("media.edge.PeerLeaveResponse",[{no:1,name:"closed",kind:"scalar",T:8}])}}new AN;class RN extends _{constructor(){super("media.edge.ConsumeMultipleProducerResponse",[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"consumer_ids_map",kind:"message",T:()=>Wp}])}}new RN;class SN extends _{constructor(){super("media.edge.ConsumePeerResponse",[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"consumer_ids_map",kind:"message",T:()=>Wp}])}}new SN;class bN extends _{constructor(){super("media.edge.ProducerCreateResponse",[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"producer_id",kind:"scalar",T:9},{no:4,name:"description",kind:"message",T:()=>Rr}])}}new bN;class kN extends _{constructor(){super("media.edge.ProducerScoreResponse",[{no:1,name:"responseid",kind:"scalar",T:9},{no:2,name:"score",kind:"message",T:()=>$M}])}}new kN;class CN extends _{constructor(){super("media.edge.ActiveSpeakerResponse",[{no:1,name:"responsepeer_id",kind:"scalar",T:9},{no:2,name:"volume",kind:"scalar",T:5}])}}new CN;class IN extends _{constructor(){super("media.edge.NoActiveSpeakerResponse",[])}}new IN;class PN extends _{constructor(){super("media.edge.ProducerToggleResponse",[])}}new PN;class DN extends _{constructor(){super("media.edge.ConsumerToggleResponse",[])}}new DN;class ON extends _{constructor(){super("media.edge.ProducerClosingResponse",[{no:1,name:"description",kind:"message",T:()=>Rr}])}}new ON;class MN extends _{constructor(){super("media.edge.ConsumerClosingResponse",[])}}new MN;class NN extends _{constructor(){super("media.edge.GlobalPeerPinningResponse",[])}}new NN;class xN extends _{constructor(){super("media.edge.KickPeerResponse",[{no:1,name:"status",kind:"scalar",T:9}])}}new xN;class LN extends _{constructor(){super("media.edge.KickAllPeersResponse",[{no:1,name:"status",kind:"scalar",T:9}])}}new LN;class $N extends _{constructor(){super("media.edge.HostMediaControlForPeerResponse",[{no:1,name:"status",kind:"scalar",T:9}])}}new $N;class UN extends _{constructor(){super("media.edge.HostMediaControlForAllPeerResponse",[{no:1,name:"status",kind:"scalar",T:9}])}}new UN;class FN extends _{constructor(){super("media.edge.PeerDisplayNameEditResponse",[{no:1,name:"status",kind:"scalar",T:9}])}}new FN;class VN extends _{constructor(){super("media.edge.PeerJoinBroadcastResponse",[{no:1,name:"participant",kind:"message",T:()=>jp}])}}new VN;class BN extends _{constructor(){super("media.edge.PeerProducingTransportCreateBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"transport_details",kind:"message",T:()=>MM}])}}new BN;class GN extends _{constructor(){super("media.edge.PeerProducerCreateBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:()=>Qi}])}}new GN;class qN extends _{constructor(){super("media.edge.PeerProducerToggleBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:()=>Qi}])}}new qN;class HN extends _{constructor(){super("media.edge.PeerProducerCloseBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:()=>Qi}])}}new HN;class WN extends _{constructor(){super("media.edge.PeerLeaveBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new WN;class jN extends _{constructor(){super("media.edge.GlobalPeerPinningBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new jN;class KN extends _{constructor(){super("media.edge.GlobalPeerUnPinningBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new KN;class JN extends _{constructor(){super("media.edge.RecordingStartedBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new JN;class YN extends _{constructor(){super("media.edge.RecordingStoppedBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}}new YN;class zN extends _{constructor(){super("media.edge.PeerDisplayNameEditBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"display_name",kind:"scalar",T:9}])}}new zN;class XN extends _{constructor(){super("media.edge.PeerPingRequestBroadcastResponse",[{no:1,name:"password",kind:"scalar",T:9}])}}new XN;class QN extends _{constructor(){super("media.edge.MediaRoomTerminationBroadcastResponse",[{no:1,name:"reason",kind:"scalar",T:9}])}}new QN;class ZN extends _{constructor(){super("socket.ai.MeetingTranscript",[{no:1,name:"meeting_id",kind:"scalar",T:9},{no:2,name:"transcript",kind:"scalar",T:9}])}}new ZN;class ex extends _{constructor(){super("socket.api.BaseSocketHubMessage",[{no:1,name:"event",kind:"scalar",T:5},{no:2,name:"id",kind:"scalar",T:9},{no:3,name:"peer_id",kind:"scalar",T:9},{no:4,name:"room_id",kind:"scalar",T:9},{no:5,name:"user_id",kind:"scalar",T:9},{no:6,name:"payload",kind:"scalar",T:12},{no:7,name:"error",kind:"scalar",opt:!0,T:8},{no:8,name:"sid",kind:"scalar",opt:!0,T:9}])}}new ex;class tx extends _{constructor(){super("socket.api.ErrorMessage",[{no:1,name:"code",kind:"scalar",opt:!0,T:5},{no:2,name:"message",kind:"scalar",T:9}])}}new tx;class rx extends _{constructor(){super("socket.preset.PollsPermissionUpdate",[{no:1,name:"can_create",kind:"scalar",opt:!0,T:8},{no:2,name:"can_vote",kind:"scalar",opt:!0,T:8},{no:3,name:"can_view",kind:"scalar",opt:!0,T:8}])}}const nx=new rx;class ix extends _{constructor(){super("socket.preset.PluginsPermissionsUpdate",[{no:1,name:"can_close",kind:"scalar",opt:!0,T:8},{no:2,name:"can_start",kind:"scalar",opt:!0,T:8}])}}const sx=new ix;class ax extends _{constructor(){super("socket.preset.PublicChatPermission",[{no:1,name:"can_send",kind:"scalar",opt:!0,T:8},{no:2,name:"text",kind:"scalar",opt:!0,T:8},{no:3,name:"files",kind:"scalar",opt:!0,T:8}])}}const ox=new ax;class cx extends _{constructor(){super("socket.preset.PrivateChatPermission",[{no:1,name:"can_send",kind:"scalar",opt:!0,T:8},{no:2,name:"can_receive",kind:"scalar",opt:!0,T:8},{no:3,name:"text",kind:"scalar",opt:!0,T:8},{no:4,name:"files",kind:"scalar",opt:!0,T:8}])}}const dx=new cx;class ux extends _{constructor(){super("socket.preset.ChatPermissionUpdate",[{no:1,name:"public",kind:"message",T:()=>ox},{no:2,name:"private",kind:"message",T:()=>dx}])}}const lx=new ux;class hx extends _{constructor(){super("socket.preset.PresetUpdates",[{no:1,name:"polls",kind:"message",T:()=>nx},{no:2,name:"plugins",kind:"message",T:()=>sx},{no:3,name:"chat",kind:"message",T:()=>lx}])}}const fx=new hx;class px extends _{constructor(){super("socket.preset.ReadPeersPresetRequest",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}}new px;class mx extends _{constructor(){super("socket.preset.PeerPreset",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"peer_id",kind:"scalar",T:9},{no:3,name:"preset",kind:"scalar",T:12}])}}const gx=new mx;class _x extends _{constructor(){super("socket.preset.ReadPeersPresetResponse",[{no:1,name:"peer_presets",kind:"message",repeat:1,T:()=>gx}])}}new _x;class vx extends _{constructor(){super("socket.preset.UpdatePeerPreset",[{no:1,name:"user_ids",kind:"scalar",T:9},{no:2,name:"patch",kind:"message",T:()=>fx}])}}const Kp=new vx;class Tx extends _{constructor(){super("socket.preset.UpdatePeersPresetRequest",[{no:1,name:"update_peers_presets",kind:"message",repeat:1,T:()=>Kp}])}}new Tx;class Ex extends _{constructor(){super("socket.preset.UpdatePeersPresetResponse",[{no:1,name:"update_peers_presets",kind:"message",repeat:1,T:()=>Kp}])}}new Ex;class wx extends _{constructor(){super("socket.chat.ChatMessage",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"peer_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:4,name:"display_name",kind:"scalar",T:9},{no:5,name:"pinned",kind:"scalar",T:8},{no:6,name:"is_edited",kind:"scalar",T:8},{no:7,name:"payload_type",kind:"scalar",T:5},{no:8,name:"payload",kind:"scalar",T:9},{no:10,name:"target_user_ids",kind:"scalar",repeat:2,T:9},{no:11,name:"created_at",kind:"scalar",T:4,L:2},{no:12,name:"created_at_ms",kind:"scalar",opt:!0,T:4,L:2},{no:13,name:"channel_id",kind:"scalar",opt:!0,T:9},{no:14,name:"channel_index",kind:"scalar",opt:!0,T:9}])}}const Rn=new wx;class yx extends _{constructor(){super("socket.chat.GetPaginatedChatMessageRoomRequest",[{no:1,name:"time_stamp",kind:"scalar",T:4,L:2},{no:2,name:"size",kind:"scalar",T:5},{no:3,name:"from",kind:"scalar",T:5},{no:4,name:"reversed",kind:"scalar",T:8},{no:5,name:"channel_id",kind:"scalar",opt:!0,T:9}])}}new yx;class Ax extends _{constructor(){super("socket.chat.GetPaginatedChatMessageRoomResponse",[{no:1,name:"messages",kind:"message",repeat:1,T:()=>Rn},{no:2,name:"next",kind:"scalar",T:8}])}}new Ax;class Rx extends _{constructor(){super("socket.chat.GetChatMessagesResponse",[{no:1,name:"messages",kind:"message",repeat:1,T:()=>Rn}])}}new Rx;class Sx extends _{constructor(){super("socket.chat.SendChatMessageToRoomRequest",[{no:1,name:"payload_type",kind:"scalar",T:5},{no:2,name:"payload",kind:"scalar",T:9}])}}new Sx;class bx extends _{constructor(){super("socket.chat.SendChatMessageToRoomResponse",[{no:1,name:"message",kind:"message",T:()=>Rn}])}}new bx;class kx extends _{constructor(){super("socket.chat.SendChatMessageToPeersRequest",[{no:1,name:"peer_ids",kind:"scalar",repeat:2,T:9},{no:2,name:"payload_type",kind:"scalar",T:5},{no:3,name:"payload",kind:"scalar",T:9}])}}new kx;class Cx extends _{constructor(){super("socket.chat.SendChatMessageToPeersResponse",[{no:1,name:"message",kind:"message",T:()=>Rn}])}}new Cx;class Ix extends _{constructor(){super("socket.chat.SendChatMessageToChannelRequest",[{no:1,name:"channel_id",kind:"scalar",T:9},{no:2,name:"payload_type",kind:"scalar",T:5},{no:3,name:"payload",kind:"scalar",T:9}])}}new Ix;class Px extends _{constructor(){super("socket.chat.SendChatMessageToChannelResponse",[{no:1,name:"message",kind:"message",T:()=>Rn}])}}new Px;class Dx extends _{constructor(){super("socket.chat.EditChatMessageRequest",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"payload_type",kind:"scalar",opt:!0,T:5},{no:3,name:"payload",kind:"scalar",opt:!0,T:9},{no:4,name:"pinned",kind:"scalar",opt:!0,T:8},{no:5,name:"channel_id",kind:"scalar",opt:!0,T:9}])}}new Dx;class Ox extends _{constructor(){super("socket.chat.PinChatMessageRequest",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"pinned",kind:"scalar",T:8},{no:3,name:"channel_id",kind:"scalar",opt:!0,T:9}])}}new Ox;class Mx extends _{constructor(){super("socket.chat.PinChatMessageResponse",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"pinned",kind:"scalar",T:8},{no:3,name:"channel_id",kind:"scalar",opt:!0,T:9}])}}new Mx;class Nx extends _{constructor(){super("socket.chat.EditChatMessageResponse",[{no:1,name:"message",kind:"message",T:()=>Rn}])}}new Nx;class xx extends _{constructor(){super("socket.chat.DeleteChatMessageRequest",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"channel_id",kind:"scalar",opt:!0,T:9}])}}new xx;class Lx extends _{constructor(){super("socket.chat.DeleteChatMessageResponse",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"channel_id",kind:"scalar",opt:!0,T:9}])}}new Lx;class $x extends _{constructor(){super("socket.chat.SearchChatMessagesRequest",[{no:1,name:"time_stamp",kind:"scalar",T:4,L:2},{no:2,name:"size",kind:"scalar",T:5},{no:3,name:"from",kind:"scalar",T:5},{no:4,name:"reversed",kind:"scalar",T:8},{no:5,name:"channel_id",kind:"scalar",opt:!0,T:9},{no:6,name:"search_term",kind:"scalar",T:9}])}}new $x;class Ux extends _{constructor(){super("socket.chat.MarkChannelIndexAsReadRequest",[{no:1,name:"channel_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"channel_index",kind:"scalar",T:9}])}}new Ux;class Fx extends _{constructor(){super("socket.chat.MarkChannelIndexAsReadResponse",[{no:1,name:"channel_index",kind:"scalar",T:9}])}}new Fx;class Vx extends _{constructor(){super("socket.chat.CreateChatChannelRequest",[{no:1,name:"display_name",kind:"scalar",T:9},{no:2,name:"target_user_ids",kind:"scalar",repeat:2,T:9},{no:3,name:"display_picture_url",kind:"scalar",opt:!0,T:9},{no:4,name:"visibility",kind:"scalar",T:9},{no:5,name:"is_direct_message",kind:"scalar",T:8}])}}new Vx;class Bx extends _{constructor(){super("socket.chat.UpdateChatChannelRequest",[{no:1,name:"chat_channel_id",kind:"scalar",T:9},{no:2,name:"display_name",kind:"scalar",opt:!0,T:9},{no:3,name:"target_user_ids",kind:"scalar",repeat:2,T:9},{no:4,name:"display_picture_url",kind:"scalar",opt:!0,T:9},{no:5,name:"visibility",kind:"scalar",opt:!0,T:9},{no:6,name:"is_direct_message",kind:"scalar",opt:!0,T:8}])}}new Bx;class Gx extends _{constructor(){super("socket.chat.CreateChatChannelResponse",[{no:1,name:"chat_channel_id",kind:"scalar",T:9}])}}new Gx;class qx extends _{constructor(){super("socket.chat.GetChatChannelRequest",[{no:1,name:"chat_channel_id",kind:"scalar",T:9}])}}new qx;class Hx extends _{constructor(){super("socket.chat.LatestMessageAndUnreadCount",[{no:1,name:"message",kind:"message",T:()=>Rn},{no:2,name:"unread_count",kind:"scalar",T:4,L:2}])}}const Wx=new Hx;class jx extends _{constructor(){super("socket.chat.ChatChannel",[{no:1,name:"chat_channel_id",kind:"scalar",T:9},{no:2,name:"display_name",kind:"scalar",T:9},{no:3,name:"display_picture_url",kind:"scalar",opt:!0,T:9},{no:4,name:"visibility",kind:"scalar",T:9},{no:5,name:"is_direct_message",kind:"scalar",T:8},{no:6,name:"latest_message_and_unread_count",kind:"message",T:()=>Wx},{no:7,name:"target_user_ids",kind:"scalar",repeat:2,T:9}])}}const Kx=new jx;class Jx extends _{constructor(){super("socket.chat.GetChatChannelResponse",[{no:1,name:"chat_channels",kind:"message",repeat:1,T:()=>Kx}])}}new Jx;class Yx extends _{constructor(){super("socket.chat.ChannelMember",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",opt:!0,T:9},{no:3,name:"picture",kind:"scalar",opt:!0,T:9},{no:4,name:"custom_participant_id",kind:"scalar",T:9}])}}const zx=new Yx;class Xx extends _{constructor(){super("socket.chat.GetChatChannelMembersResponse",[{no:1,name:"channel_members",kind:"message",repeat:1,T:()=>zx}])}}new Xx;var Ns;(function(t){t[t.BROWSER=0]="BROWSER",t[t.TRACK=1]="TRACK",t[t.COMPOSITE=2]="COMPOSITE"})(Ns||(Ns={}));var xs;(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ON_STAGE=1]="ON_STAGE",t[t.APPROVED_STAGE=2]="APPROVED_STAGE",t[t.REQUESTED_STAGE=3]="REQUESTED_STAGE",t[t.OFF_STAGE=4]="OFF_STAGE"})(xs||(xs={}));var dl;(function(t){t[t.NONE=0]="NONE",t[t.RECORDER=1]="RECORDER",t[t.LIVESTREAMER=2]="LIVESTREAMER"})(dl||(dl={}));var Zo;(function(t){t[t.HIVE=0]="HIVE",t[t.CHAT=1]="CHAT",t[t.PING=2]="PING"})(Zo||(Zo={}));class Qx extends _{constructor(){super("socket.room.PeerFlags",[{no:1,name:"preset_name",kind:"scalar",T:9},{no:2,name:"recorder_type",kind:"scalar",T:9},{no:3,name:"hidden_participant",kind:"scalar",T:8}])}}const Zx=new Qx;class eL extends _{constructor(){super("socket.room.Peer",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"display_name",kind:"scalar",T:9},{no:4,name:"stage_type",kind:"enum",opt:!0,T:()=>["socket.room.StageType",xs,"STAGE_TYPE_"]},{no:5,name:"custom_participant_id",kind:"scalar",opt:!0,T:9},{no:6,name:"preset_id",kind:"scalar",opt:!0,T:9},{no:7,name:"display_picture_url",kind:"scalar",opt:!0,T:9},{no:8,name:"waitlisted",kind:"scalar",T:8},{no:9,name:"flags",kind:"message",T:()=>Zx}])}}const Da=new eL;class tL extends _{constructor(){super("socket.room.PeerInfoResponse",[{no:1,name:"peer",kind:"message",T:()=>Da}])}}new tL;class rL extends _{constructor(){super("socket.room.PeerStatusUpdate",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"stage_type",kind:"enum",opt:!0,T:()=>["socket.room.StageType",xs,"STAGE_TYPE_"]}])}}new rL;class nL extends _{constructor(){super("socket.room.RoomPeersInfoRequest",[{no:1,name:"seach_query",kind:"scalar",T:9},{no:2,name:"limit",kind:"scalar",T:5},{no:3,name:"offset",kind:"scalar",T:5}])}}new nL;class iL extends _{constructor(){super("socket.room.RoomPeersInfoResponse",[{no:1,name:"peers",kind:"message",repeat:1,T:()=>Da}])}}new iL;class sL extends _{constructor(){super("socket.room.RoomPeerCountResponse",[{no:1,name:"count",kind:"scalar",T:4,L:2}])}}new sL;class aL extends _{constructor(){super("socket.room.Room",[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"title",kind:"scalar",T:9},{no:4,name:"created_at",kind:"scalar",T:4,L:2},{no:5,name:"active_recordings",kind:"message",repeat:1,T:()=>cL},{no:6,name:"room_uuid",kind:"scalar",opt:!0,T:9}])}}const Jp=new aL;class oL extends _{constructor(){super("socket.room.ActiveRecording",[{no:1,name:"recording_id",kind:"scalar",T:9},{no:2,name:"recording_type",kind:"enum",T:()=>["common.RecordingType",Ns]},{no:3,name:"recording_status",kind:"scalar",T:9}])}}const cL=new oL;class dL extends _{constructor(){super("socket.room.RoomInfoResponse",[{no:1,name:"room",kind:"message",T:()=>Jp}])}}new dL;class uL extends _{constructor(){super("socket.room.GetPeerInfoRequest",[{no:1,name:"peer_id",kind:"scalar",T:9}])}}new uL;class lL extends _{constructor(){super("socket.room.UpdatePeerInfoRequest",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"display_name",kind:"scalar",opt:!0,T:9}])}}new lL;class hL extends _{constructor(){super("socket.room.JoinRoomRequest",[{no:1,name:"peer",kind:"message",T:()=>Da},{no:3,name:"room_uuid",kind:"scalar",T:9},{no:4,name:"organization_id",kind:"scalar",opt:!0,T:9},{no:5,name:"use_hive",kind:"scalar",opt:!0,T:8},{no:6,name:"preset",kind:"scalar",opt:!0,T:12},{no:7,name:"capabilities",kind:"enum",repeat:1,T:()=>["socket.room.Capabilities",Zo,"CAPABILITIES_"]},{no:8,name:"timestamp",kind:"scalar",opt:!0,T:4,L:2}])}}new hL;class fL extends _{constructor(){super("socket.room.LeaveRoomRequest",[{no:1,name:"peer",kind:"message",T:()=>Da},{no:2,name:"timestamp",kind:"scalar",opt:!0,T:4,L:2}])}}new fL;class pL extends _{constructor(){super("socket.room.UpdateRoomInfoRequest",[{no:1,name:"room",kind:"message",T:()=>Jp}])}}new pL;class mL extends _{constructor(){super("socket.room.GetConnectedRoomsDumpRequest",[])}}new mL;class gL extends _{constructor(){super("socket.room.ServiceError",[{no:1,name:"message",kind:"scalar",opt:!0,T:9},{no:2,name:"code",kind:"scalar",opt:!0,T:9}])}}const ld=new gL;class _L extends _{constructor(){super("socket.room.ConnectedMeetingPeer",[{no:1,name:"id",kind:"scalar",opt:!0,T:9},{no:2,name:"display_name",kind:"scalar",opt:!0,T:9},{no:3,name:"custom_participant_id",kind:"scalar",opt:!0,T:9},{no:4,name:"preset_id",kind:"scalar",opt:!0,T:9},{no:5,name:"display_picture_url",kind:"scalar",opt:!0,T:9}])}}const vL=new _L;class TL extends _{constructor(){super("socket.room.ConnectedMeetingDump",[{no:1,name:"id",kind:"scalar",opt:!0,T:9},{no:2,name:"title",kind:"scalar",opt:!0,T:9},{no:3,name:"participants",kind:"message",repeat:1,T:()=>vL}])}}const ul=new TL;class EL extends _{constructor(){super("socket.room.GetConnectedRoomsDumpResponse",[{no:1,name:"parent_meeting",kind:"message",T:()=>ul},{no:2,name:"meetings",kind:"message",repeat:1,T:()=>ul}])}}const wL=new EL;class yL extends _{constructor(){super("socket.room.CreateRoomRequestPayload",[{no:1,name:"title",kind:"scalar",opt:!0,T:9}])}}const AL=new yL;class RL extends _{constructor(){super("socket.room.CreateConnectedRoomsRequest",[{no:1,name:"payloads",kind:"message",repeat:1,T:()=>AL}])}}const SL=new RL;class bL extends _{constructor(){super("socket.room.CreateRoomResponsePayload",[{no:1,name:"id",kind:"scalar",opt:!0,T:9},{no:2,name:"title",kind:"scalar",opt:!0,T:9},{no:3,name:"error",kind:"message",T:()=>ld}])}}const kL=new bL;class CL extends _{constructor(){super("socket.room.CreateConnectedRoomsResponse",[{no:1,name:"payloads",kind:"message",repeat:1,T:()=>kL}])}}const ll=new CL;class IL extends _{constructor(){super("socket.room.UpdateRoomRequestPayload",[{no:1,name:"meeting_id",kind:"scalar",opt:!0,T:9},{no:2,name:"title",kind:"scalar",opt:!0,T:9}])}}const PL=new IL;class DL extends _{constructor(){super("socket.room.UpdateConnectedRoomsRequest",[{no:1,name:"payloads",kind:"message",repeat:1,T:()=>PL}])}}new DL;class OL extends _{constructor(){super("socket.room.DisableRoomPayload",[{no:1,name:"id",kind:"scalar",opt:!0,T:9}])}}const ML=new OL;class NL extends _{constructor(){super("socket.room.DisableConnectedRoomsRequest",[{no:1,name:"payloads",kind:"message",repeat:1,T:()=>ML}])}}const xL=new NL;class LL extends _{constructor(){super("socket.room.DisableConnectedRoomsResponse",[{no:1,name:"payloads",kind:"message",repeat:1,T:()=>FL}])}}const $L=new LL;class UL extends _{constructor(){super("socket.room.DisableConnectedRoomPayload",[{no:1,name:"id",kind:"scalar",opt:!0,T:9},{no:2,name:"status",kind:"scalar",opt:!0,T:9},{no:3,name:"title",kind:"scalar",opt:!0,T:9},{no:4,name:"error",kind:"message",T:()=>ld}])}}const FL=new UL;class VL extends _{constructor(){super("socket.room.MovePeerPayload",[{no:1,name:"id",kind:"scalar",opt:!0,T:9},{no:2,name:"preset_id",kind:"scalar",opt:!0,T:9}])}}const BL=new VL;class GL extends _{constructor(){super("socket.room.MovePeersBetweenRoomsRequest",[{no:1,name:"source_meeting_id",kind:"scalar",opt:!0,T:9},{no:2,name:"destination_meeting_id",kind:"scalar",opt:!0,T:9},{no:3,name:"participants",kind:"message",repeat:1,T:()=>BL}])}}const qL=new GL;class HL extends _{constructor(){super("socket.room.MovedPeer",[{no:1,name:"meeting_id",kind:"scalar",opt:!0,T:9},{no:2,name:"custom_participant_id",kind:"scalar",opt:!0,T:9},{no:3,name:"error",kind:"message",T:()=>ld}])}}const Yp=new HL;class WL extends _{constructor(){super("socket.room.MovePeersBetweenRoomsResponse",[{no:1,name:"payloads",kind:"message",repeat:1,T:()=>Yp}])}}new WL;class jL extends _{constructor(){super("socket.room.TransferPeer",[{no:1,name:"meeting_id",kind:"scalar",opt:!0,T:9},{no:2,name:"auth_token",kind:"scalar",opt:!0,T:9}])}}const KL=new jL;class JL extends _{constructor(){super("socket.room.GetAllAddedParticipantsResponse",[{no:1,name:"participants",kind:"message",repeat:1,T:()=>zL}])}}new JL;class YL extends _{constructor(){super("socket.room.AddedParticipant",[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",opt:!0,T:9},{no:3,name:"picture",kind:"scalar",opt:!0,T:9},{no:4,name:"custom_participant_id",kind:"scalar",T:9}])}}const zL=new YL;class XL extends _{constructor(){super("socket.room.RemoveParticipantsRequest",[{no:1,name:"peer_ids",kind:"scalar",repeat:2,T:9}])}}new XL;class QL extends _{constructor(){super("socket.room.BroadcastMessage",[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"timestamp",kind:"scalar",T:4,L:2},{no:4,name:"peer_ids",kind:"scalar",repeat:2,T:9}])}}new QL;class ZL extends _{constructor(){super("socket.room.AcceptWaitingRoomRequests",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}}new ZL;class e$ extends _{constructor(){super("socket.room.DenyWaitingRoomRequests",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}}new e$;class t$ extends _{constructor(){super("socket.room.WaitingRoomRequest",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"display_name",kind:"scalar",T:9}])}}const r$=new t$;class n$ extends _{constructor(){super("socket.room.GetWaitingRoomRequests",[{no:1,name:"requests",kind:"message",repeat:1,T:()=>r$}])}}new n$;class i$ extends _{constructor(){super("socket.room.GetRoomStageStateResponse",[{no:1,name:"on_stage_peers",kind:"scalar",repeat:2,T:9},{no:2,name:"approved_stage_peers",kind:"scalar",repeat:2,T:9},{no:3,name:"requested_stage_peers",kind:"scalar",repeat:2,T:9}])}}new i$;class s$ extends _{constructor(){super("socket.plugin.AddPluginRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"staggered",kind:"scalar",T:8}])}}new s$;class a$ extends _{constructor(){super("socket.plugin.RemovePluginRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"staggered",kind:"scalar",T:8}])}}new a$;class o$ extends _{constructor(){super("socket.plugin.EnablePluginForRoomRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9}])}}new o$;class c$ extends _{constructor(){super("socket.plugin.DisablePluginForRoomRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9}])}}new c$;class d$ extends _{constructor(){super("socket.plugin.EnablePluginForPeersRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"peer_ids",kind:"scalar",repeat:2,T:9}])}}new d$;class u$ extends _{constructor(){super("socket.plugin.DisablePluginForPeersRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"peer_ids",kind:"scalar",repeat:2,T:9}])}}new u$;class l$ extends _{constructor(){super("socket.plugin.PluginEventToRoomRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"plugin_data",kind:"scalar",T:12}])}}new l$;class h$ extends _{constructor(){super("socket.plugin.PluginEventToPeersRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"peer_ids",kind:"scalar",repeat:2,T:9},{no:3,name:"plugin_data",kind:"scalar",T:12}])}}new h$;class f$ extends _{constructor(){super("socket.plugin.StoreKeys",[{no:1,name:"store_key",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",opt:!0,T:12}])}}const hd=new f$;class p$ extends _{constructor(){super("socket.plugin.PluginStoreInsertKeysRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"insert_keys",kind:"message",repeat:1,T:()=>hd}])}}new p$;class m$ extends _{constructor(){super("socket.plugin.PluginStoreGetKeysRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"get_keys",kind:"message",repeat:1,T:()=>hd}])}}new m$;class g$ extends _{constructor(){super("socket.plugin.PluginStoreDeleteKeysRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"delete_keys",kind:"message",repeat:1,T:()=>hd}])}}new g$;class _$ extends _{constructor(){super("socket.plugin.PluginStoreDeleteRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9}])}}new _$;class v$ extends _{constructor(){super("socket.plugin.EnablePluginResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"enabled_by",kind:"scalar",T:9}])}}const T$=new v$;class E$ extends _{constructor(){super("socket.plugin.EnablePluginsResponse",[{no:1,name:"plugins",kind:"message",repeat:1,T:()=>T$}])}}new E$;class w$ extends _{constructor(){super("socket.plugin.DisablePluginResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"disabled_by",kind:"scalar",T:9}])}}new w$;class y$ extends _{constructor(){super("socket.plugin.PluginStoreItem",[{no:1,name:"timestamp",kind:"scalar",T:9},{no:2,name:"peer_id",kind:"scalar",T:9},{no:3,name:"store_key",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}])}}const A$=new y$;class R$ extends _{constructor(){super("socket.plugin.PluginStoreResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"store_items",kind:"message",repeat:1,T:()=>A$}])}}new R$;class S$ extends _{constructor(){super("socket.plugin.PluginEventResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"plugin_data",kind:"scalar",T:12}])}}new S$;class b$ extends _{constructor(){super("socket.livestreaming.LiveStreamingEvent",[{no:1,name:"livestream_id",kind:"scalar",T:9},{no:2,name:"err_message",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"meeting_id",kind:"scalar",T:9},{no:5,name:"playback_url",kind:"scalar",T:9},{no:6,name:"org_id",kind:"scalar",T:9},{no:7,name:"room_name",kind:"scalar",T:9},{no:8,name:"room_uuid",kind:"scalar",T:9},{no:9,name:"status",kind:"scalar",T:9}])}}new b$;class k$ extends _{constructor(){super("socket.livestreaming.GetStagePeersResponse",[{no:1,name:"stage_peers",kind:"scalar",repeat:2,T:9}])}}new k$;class C$ extends _{constructor(){super("socket.livestreaming.StageRequest",[{no:1,name:"display_name",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"peer_id",kind:"scalar",T:9}])}}const I$=new C$;class P$ extends _{constructor(){super("socket.livestreaming.GetStageRequestsResponse",[{no:1,name:"stage_requests",kind:"message",repeat:1,T:()=>I$}])}}new P$;class D$ extends _{constructor(){super("socket.livestreaming.GrantStageAccessRequest",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}}new D$;class O$ extends _{constructor(){super("socket.livestreaming.DenyStageAccessRequest",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}}new O$;class M$ extends _{constructor(){super("socket.livestreaming.LeaveStageRequest",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}}new M$;class N$ extends _{constructor(){super("socket.polls.Poll",[{no:1,name:"poll_id",kind:"scalar",T:9},{no:2,name:"created_by",kind:"scalar",T:9},{no:3,name:"created_by_user_id",kind:"scalar",T:9},{no:4,name:"question",kind:"scalar",T:9},{no:5,name:"options",kind:"message",repeat:1,T:()=>L$},{no:6,name:"hide_votes",kind:"scalar",T:8},{no:7,name:"anonymous",kind:"scalar",T:8},{no:8,name:"votes",kind:"scalar",repeat:2,T:9}])}}const zp=new N$;class x$ extends _{constructor(){super("socket.polls.PollOption",[{no:1,name:"text",kind:"scalar",T:9},{no:2,name:"count",kind:"scalar",opt:!0,T:4,L:2},{no:3,name:"votes",kind:"message",repeat:1,T:()=>U$}])}}const L$=new x$;class $$ extends _{constructor(){super("socket.polls.PollVote",[{no:1,name:"user_id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}])}}const U$=new $$;class F$ extends _{constructor(){super("socket.polls.NewPollRequest",[{no:1,name:"question",kind:"scalar",T:9},{no:2,name:"options",kind:"scalar",repeat:2,T:9},{no:3,name:"anonymous",kind:"scalar",T:8},{no:4,name:"hide_votes",kind:"scalar",T:8},{no:5,name:"created_by",kind:"scalar",opt:!0,T:9},{no:6,name:"created_by_user_id",kind:"scalar",opt:!0,T:9}])}}new F$;class V$ extends _{constructor(){super("socket.polls.VotePollRequest",[{no:1,name:"poll_id",kind:"scalar",T:9},{no:2,name:"index",kind:"scalar",T:4,L:2}])}}new V$;class B$ extends _{constructor(){super("socket.polls.UpdatePollResponse",[{no:1,name:"poll",kind:"message",T:()=>zp}])}}new B$;class G$ extends _{constructor(){super("socket.polls.GetPollsResponse",[{no:1,name:"polls",kind:"message",repeat:1,T:()=>zp}])}}new G$;class q$ extends _{constructor(){super("socket.recording.RecordingEvent",[{no:1,name:"recording_id",kind:"scalar",T:9},{no:2,name:"err_message",kind:"scalar",T:9},{no:3,name:"recording_type",kind:"enum",T:()=>["common.RecordingType",Ns]}])}}new q$;class H$ extends _{constructor(){super("google.protobuf.Timestamp",[{no:1,name:"seconds",kind:"scalar",T:3,L:0},{no:2,name:"nanos",kind:"scalar",T:5}])}now(){const e=this.create(),r=Date.now();return e.seconds=ce.from(Math.floor(r/1e3)).toBigInt(),e.nanos=r%1e3*1e6,e}toDate(e){return new Date(ce.from(e.seconds).toNumber()*1e3+Math.ceil(e.nanos/1e6))}fromDate(e){const r=this.create(),n=e.getTime();return r.seconds=ce.from(Math.floor(n/1e3)).toBigInt(),r.nanos=n%1e3*1e6,r}internalJsonWrite(e,r){let n=ce.from(e.seconds).toNumber()*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("Unable to encode Timestamp to JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");if(e.nanos<0)throw new Error("Unable to encode invalid Timestamp to JSON. Nanos must not be negative.");let i="Z";if(e.nanos>0){let s=(e.nanos+1e9).toString().substring(1);s.substring(3)==="000000"?i="."+s.substring(0,3)+"Z":s.substring(6)==="000"?i="."+s.substring(0,6)+"Z":i="."+s+"Z"}return new Date(n).toISOString().replace(".000Z",i)}internalJsonRead(e,r,n){if(typeof e!="string")throw new Error("Unable to parse Timestamp from JSON "+dd(e)+".");let i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("Unable to parse Timestamp from JSON. Invalid format.");let s=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(s))throw new Error("Unable to parse Timestamp from JSON. Invalid value.");if(s<Date.parse("0001-01-01T00:00:00Z")||s>Date.parse("9999-12-31T23:59:59Z"))throw new globalThis.Error("Unable to parse Timestamp from JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");return n||(n=this.create()),n.seconds=ce.from(s/1e3).toBigInt(),n.nanos=0,i[7]&&(n.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),n}}new H$;const W$=0,j$=1,K$=2,J$=3,Y$=4,z$=5,X$={getPeerInfo:0,updatePeerInfo:1,getRoomPeersInfo:2,joinRoom:3,leaveRoom:4,getRoomInfo:5,updateRoomInfo:6,closeRoom:7,startedLivestream:8,stoppedLivestream:9,erroredLivestream:10,getStagePeers:11,getStageRequests:12,requestStageAccess:13,cancelStageRequest:14,grantStageAccess:15,denyStageAccess:16,roomPeerCount:17,joinStage:18,leaveStage:19,getConnectedRoomsDump:20,createConnectedRooms:21,deleteConnectedRooms:22,movePeers:23,transferPeer:24,movedPeer:25,connectedRoomsUpdated:26,connectedRoomsDeleted:27,getAllAddedParticipants:28,broadcastMessage:29,kick:30,kickAll:31,transcript:32,getWaitingRoomRequests:33,acceptWaitingRoomRequests:34,waitingRoomRequestAccepted:35,denyWaitingRoomRequests:36,waitingRoomRequestDenied:37,peerStageStatusUpdate:38,broadcastToPeers:39,recordingStarted:40,recordingStopped:41,recordingPaused:42,getRoomStageState:43},Q$={getMessages:0,sendMessageToRoom:1,sendMessageToPeers:2,editMessage:3,deleteMessage:4,getPaginatedMessages:5,sendMessageToChannel:6,searchChannelMessages:7,getAllChatChannels:8,markChannelIndexAsRead:9,pinMessage:10},Z$={getPlugins:0,addPlugin:1,enablePluginForRoom:2,disablePluginForPeers:3,enablePluginForPeers:4,disablePluginForRoom:5,removePlugin:6,customPluginEventToRoom:7,customPluginEventToPeers:8,storeInsertKeys:9,storeGetKeys:10,storeDeleteKeys:11,storeDelete:12},eU={createPoll:0,getPolls:1,votePoll:2,updatePoll:3},tU={unknown:0,createWebRTCTransport:1,produce:2,consume:3,toggleProducer:4,toggleConsumer:5,closeProducer:6,closeConsumer:7,joinRoom:16,leaveRoom:17,selectedPeer:18,globalPinPeer:19,selfJoinComplete:20,peerJoinedBroadcast:25,peerLeaveBroadcast:26,peerProducerCreateBroadcast:27,peerProducerToggleBroadcast:28,peerProducerCloseBroadcast:29,globalPeerPinBroadcast:30,recordingStartedBroadcast:31,recordingStoppedBroadcast:32,peerDisplayNameEditBroadcast:33,mediaRoomTerminationBroadcastResponse:36,selectedPeerDiff:40,renegotiateSessionDescription:50,errorResponse:60,kickPeer:90,kickAll:91,changeDisplayName:92,hostControlPeer:93,hostControlAllPeers:94},rU={createChatChannel:0,getChatChannel:1,deprecatedGetAllChatChannels:2,getChannelMembers:3,updateChatChannel:4},nU={getUserPresets:0,updateUserPreset:1};function ai(t,e){return Object.keys(e).reduce((r,n)=>(r[n]=(t<<16)+e[n],r),{})}function iU(t){return Object.keys(t).reduce((e,r)=>(e[r]=16777216|t[r],e),{})}const lr=ai(W$,X$);ai(j$,Q$);ai(K$,Z$);ai(J$,eU);ai(Y$,rU);iU(tU);ai(z$,nU);const kr=class{static handleConnectedRoomsDumpRaw({payload:e}){var s;const r=wL.fromBinary(e),n=r.meetings.map(a=>{var o;return{id:a.id,title:a.title,participants:(o=a.participants)!=null?o:[]}});return{parentMeeting:{id:r.parentMeeting.id,title:r.parentMeeting.title,participants:(s=r.parentMeeting.participants)!=null?s:[]},meetings:n}}static handleTransferPeerRaw({payload:e}){const r=KL.fromBinary(e);return{authToken:r.authToken,meetingId:r.meetingId}}static handleMovedPeerRaw({payload:e}){const r=Yp.fromBinary(e);return{meetingId:r.meetingId,customParticipantId:r.customParticipantId}}static handleConnectedRoomsUpdatedRaw({payload:e}){return ll.fromBinary(e).payloads.map(n=>({id:n.id,title:n.title}))}static handleConnectedRoomsDeletedRaw({payload:e}){return $L.fromBinary(e).payloads}static async getConnectedRoomsDump(){const e=await kr.socketService.sendMessagePromise(lr.getConnectedRoomsDump);return kr.handleConnectedRoomsDumpRaw(e)}static async createConnectedRooms(e){const{payload:r}=await kr.socketService.sendMessagePromise(lr.createConnectedRooms,SL.toBinary({payloads:e}));return ll.fromBinary(r).payloads.map(i=>({id:i.id,title:i.title}))}static async updateConnectedRooms(e){}static async disableConnectedRooms(e){const r=e.map(i=>({id:i})),n=await kr.socketService.sendMessagePromise(lr.deleteConnectedRooms,xL.toBinary({payloads:r}));return kr.handleConnectedRoomsDeletedRaw(n)}static async movePeersBetweenRooms(e){try{const r=await kr.socketService.sendMessagePromise(lr.movePeers,qL.toBinary({sourceMeetingId:e.sourceMeetingId,destinationMeetingId:e.destinationMeetingId,participants:e.participants}));return new TextDecoder().decode(r.payload).includes("error")?{success:!1,error:"failed to move participants"}:{success:!0}}catch(r){return{success:!1,error:r}}}};let ge=kr;g(ge,"socketService"),g(ge,"currentMeetingId");var Fi;class sU extends ht{constructor(r){super();S(this,Fi,void 0);g(this,"meetings",[]);g(this,"parentMeeting",null);w(this,Fi,r.self)}get supportsConnectedMeetings(){return d(this,Fi).id!==""&&ze.isV2AuthToken&&ie.hasFeature(se.CONNECTED_MEETINGS)}get isActive(){return this.meetings.length!==0}get currentMeetingId(){return ge.currentMeetingId}validateConnectedMeetingsAction(){if(!this.supportsConnectedMeetings)throw new Error(`You are not allowed to perform this action.
						Please connect with Dyte team to move you to V2 APIs & to enable connected meetings.`)}async getConnectedMeetings(){return this.validateConnectedMeetingsAction(),await ge.getConnectedRoomsDump()}async createMeetings(r){return this.validateConnectedMeetingsAction(),(await ge.createConnectedRooms(r)).map(i=>({id:i.id,title:i.title}))}async updateMeetings(r){this.validateConnectedMeetingsAction(),await ge.updateConnectedRooms(r.map(n=>({meetingId:n.id,title:n.title})))}async deleteMeetings(r){this.validateConnectedMeetingsAction();const n=this.meetings.map(s=>r.includes(s.id)&&s.participants.length!==0?this.moveParticipants(s.id,this.parentMeeting.id,s.participants.map(a=>a.id)):Promise.resolve());return await Promise.all(n),await ge.disableConnectedRooms(r)}async moveParticipants(r,n,i){this.validateConnectedMeetingsAction();const s=new Map;[...this.parentMeeting.participants,...this.meetings.flatMap(o=>o.participants)].forEach(o=>s.set(o.id,o));const a=await ge.movePeersBetweenRooms({sourceMeetingId:r,destinationMeetingId:n,participants:i.map(o=>({id:o}))});return a.success&&(n===this.parentMeeting.id&&(this.parentMeeting.participants=this.parentMeeting.participants.concat(i.map(o=>s.get(o)))),r===this.parentMeeting.id&&(this.parentMeeting.participants=this.parentMeeting.participants.filter(o=>!i.includes(o.id))),this.meetings=this.meetings.map(o=>{if(n===o.id){const c=o.participants.concat(i.map(u=>s.get(u)));return{...o,participants:c}}if(r===o.id){const c=o.participants.filter(u=>!i.includes(u.id));return{...o,participants:c}}return o})),a}}Fi=new WeakMap;var aU=Object.defineProperty,oU=Object.getOwnPropertyDescriptor,fd=(t,e,r,n)=>{for(var i=n>1?void 0:n?oU(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&aU(e,r,i),i},un,ln,po;const br=(po=class{constructor(t,e){g(this,"connectedMeetings");S(this,un,void 0);S(this,ln,void 0);w(this,un,e),this.connectedMeetings=new sU(t),this.setCurrentMeeting(t)}static init(t,e){return br.instance||(br.instance=new br(t,e)),br.instance.connectedMeetings.supportsConnectedMeetings&&(br.instance.setupEvents(),t.self.once("roomJoined",()=>br.instance.getConnectedMeetings())),br.instance}setCurrentMeeting(t){w(this,ln,t),ge.currentMeetingId=t.meta.roomName}getConnectedMeetings(){this.connectedMeetings.getConnectedMeetings()}setupEvents(){ge.socketService&&(ge.socketService.on(lr.getConnectedRoomsDump,this.handleConnectedRoomsDump.bind(this)),ge.socketService.on(lr.transferPeer,this.handleTransferPeer.bind(this)),ge.socketService.on(lr.movedPeer,this.handleMovedPeer.bind(this)),ge.socketService.on(lr.connectedRoomsUpdated,this.handleConnectedRoomsUpdated.bind(this)),ge.socketService.on(lr.connectedRoomsDeleted,this.handleConnectedRoomsDeleted.bind(this)))}handleTransferPeer(t){const e=ge.handleTransferPeerRaw(t);return this.switchMeeting(e)}async switchMeeting({authToken:t,meetingId:e}){if(!this.connectedMeetings.supportsConnectedMeetings)throw new Error(`You are not allowed to perform this action.
								Please connect with Dyte team to move you to V2 APIs & to enable connected meetings.`);this.connectedMeetings.emit("changingMeeting",e);const r=d(this,ln).self.videoEnabled;await d(this,ln).leave("connected-meeting"),ge.socketService=void 0;const n=await Qp.init({authToken:t,baseURI:d(this,un).baseURI,defaults:{...d(this,un).defaults,video:r,audio:!1},modules:d(this,un).modules});n.self.setName(d(this,ln).self.name);try{await n.join()}catch(i){v.addLogInCurrentSpan("error","ConnectedMeetingsController.joinRoom",{error:i})}return this.connectedMeetings.emit("meetingChanged",n),this.setCurrentMeeting(n),n}handleConnectedRoomsDump(t){const e=ge.handleConnectedRoomsDumpRaw(t);this.connectedMeetings.meetings=e.meetings.map(r=>({id:r.id,title:r.title,participants:r.participants||[]})),this.connectedMeetings.parentMeeting={id:e.parentMeeting.id,title:e.parentMeeting.title,participants:e.parentMeeting.participants},this.emitStateUpdate()}handleMovedPeer(t){return ge.handleMovedPeerRaw(t)}handleConnectedRoomsUpdated(t){const e=ge.handleConnectedRoomsUpdatedRaw(t),r=new Map;this.connectedMeetings.meetings.forEach(n=>{r.set(n.id,n)}),e.forEach(n=>{r.has(n.id)?r.get(n.id).title=n.title:r.set(n.id,{...n,participants:[]})}),this.connectedMeetings.meetings=Array.from(r.values()),this.emitStateUpdate()}handleConnectedRoomsDeleted(t){const r=ge.handleConnectedRoomsDeletedRaw(t).map(n=>n.id);this.connectedMeetings.meetings=this.connectedMeetings.meetings.filter(n=>!r.includes(n.id))}emitStateUpdate(){this.connectedMeetings.emit("stateUpdate",{meetings:this.connectedMeetings.meetings,parentMeeting:this.connectedMeetings.parentMeeting})}},un=new WeakMap,ln=new WeakMap,g(po,"instance"),po);let Oa=br;fd([v.trace("ConnectedMeetingsController.getConnectedMeetings")],Oa.prototype,"getConnectedMeetings",1);fd([v.trace("ConnectedMeetingsController.setupEvents")],Oa.prototype,"setupEvents",1);fd([v.trace("ConnectedMeetingsController.switchMeeting")],Oa.prototype,"switchMeeting",1);var cU=Object.defineProperty,dU=Object.getOwnPropertyDescriptor,oi=(t,e,r,n)=>{for(var i=n>1?void 0:n?dU(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(i=(n?a(e,r,i):a(i))||i);return n&&i&&cU(e,r,i),i},Vi,Xs,Xp,mo;let fr=(mo=class{constructor(e){S(this,Xs);S(this,Vi,void 0);g(this,"self");g(this,"participants");g(this,"meta");g(this,"ai");g(this,"plugins");g(this,"chat");g(this,"polls");g(this,"remote");g(this,"recording");g(this,"livestream");g(this,"stage");g(this,"troubleshoot");g(this,"__internals__");this.self=e,this.participants=new Ve(e),this.meta=new xo(e,st.GroupCall,"Meeting"),this.ai=new xr,this.plugins=new Ho,this.chat=new Pe(e,this.participants),this.polls=new Wo(e),this.recording=new mn(e),this.livestream=new od(e),this.stage=new Wr(e,this.participants,st.GroupCall),this.troubleshoot=new XO(e),this.__internals__=new ad(p,Np)}static async init(e){var s,a,o,c,u,h;yO((s=e.overrides)!=null?s:{}),le.init();const r=qe.v4();if(window.__zone_symbol__DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION=!0,v.init(r,(o=(a=e.modules)==null?void 0:a.tracing)!=null?o:!0),p.info("DyteClient::init::options",{dyteClientInitOptions:{...e,authToken:`${(c=e.authToken)==null?void 0:c.slice(0,10)}...${(u=e.authToken)==null?void 0:u.slice(-10)}`}}),!navigator.isReactNative&&typeof window!="undefined"){window.addEventListener("error",m=>{var T;!((T=m.filename)!=null&&T.includes("localhost"))&&m.lineno!==0&&p.error("window::error",{error:m.error},!0)}),window.addEventListener("unhandledrejection",m=>{var T,A,C,R,b,D,H,k;p.error("window::unhandledrejection",{error:m==null?void 0:m.reason,networkCall:{url:(A=(T=m==null?void 0:m.reason)==null?void 0:T.config)==null?void 0:A.url,baseURL:(R=(C=m==null?void 0:m.reason)==null?void 0:C.config)==null?void 0:R.baseURL,method:(D=(b=m==null?void 0:m.reason)==null?void 0:b.config)==null?void 0:D.method,status:(H=m==null?void 0:m.reason)==null?void 0:H.status,statusText:(k=m==null?void 0:m.reason)==null?void 0:k.statusText}},!0)}),window.addEventListener("offline",()=>{p.info("window::offline")}),window.addEventListener("online",()=>{p.info("window::online")});const f={chat:!0,participant:!0,plugin:!0,poll:!0,self:!0,meta:!0,permissions:!0,theme:!0,tracing:!0,devTools:{logs:!1},internals:!0,stage:!0,pip:!0,...e==null?void 0:e.modules};tD({...e,modules:f,apiBase:"https://api.dyte.io"})}wO(e.authToken,e.roomName),v.meetingMetadata.roomName=ze.isV2AuthToken?ze.meetingId:e.roomName;const n=await _e.__init__(),i=new fr(n);return W(h=i,Xs,Xp).call(h,e),i}async joinRoom(){return this.self.roomJoined=!0,this.self.roomState="joined",this.self.emit("roomJoined")}async leaveRoom(e){return this.self.roomJoined=!1,this.self.roomState=e!=null?e:"ended",this.self.emit("roomLeft",{state:e})}async join(){return this.self.roomJoined=!0,this.self.roomState="joined",this.self.emit("roomJoined")}async leave(e){return this.self.roomJoined=!1,this.self.roomState=e!=null?e:"ended",this.self.emit("roomLeft",{state:e})}get connectedMeetings(){var e;return(e=d(this,Vi))==null?void 0:e.connectedMeetings}},Vi=new WeakMap,Xs=new WeakSet,Xp=function(e){w(this,Vi,Oa.init(this,e))},g(mo,"DyteSelfMedia",kp),mo);oi([xe(t=>{throw new E(t.message,"0002")}),Mt.executeWithLock({methodName:"meeting.join",lockName:"DyteClient.join",timeout:3e3})],fr.prototype,"joinRoom",1);oi([xe(t=>{throw new E(t.message,"0003")})],fr.prototype,"leaveRoom",1);oi([xe(t=>{throw new E(t.message,"0002")}),Mt.executeWithLock({methodName:"meeting.join",lockName:"DyteClient.join",timeout:3e3})],fr.prototype,"join",1);oi([xe(t=>{throw new E(t.message,"0003")})],fr.prototype,"leave",1);oi([xe(t=>{throw new E(t.message,"0001")}),Mt.executeWithLock({methodName:"DyteClient.init",lockName:"DyteClient.init",timeout:3e3})],fr,"init",1);fr=oi([xe(t=>{throw new E(t.message,"0000")})],fr);const Qp=fr;module.exports=Qp;
