"use strict";var C=Object.defineProperty;var R=(t,e,n)=>e in t?C(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var b=(t,e,n)=>(R(t,typeof e!="symbol"?e+"":e,n),n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var d=require("react"),P=require("@dytesdk/web-core");function D(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var M=D(d),q=D(P),S={exports:{}},U={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var _=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;function k(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function A(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(r.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(i){s[i]=i}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}A();/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I=M.default,E=60103;U.Fragment=60107;if(typeof Symbol=="function"&&Symbol.for){var w=Symbol.for;E=w("react.element"),U.Fragment=w("react.fragment")}var T=I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,F=Object.prototype.hasOwnProperty,B={key:!0,ref:!0,__self:!0,__source:!0};function x(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)F.call(e,r)&&!B.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:E,type:t,key:i,ref:o,props:s,_owner:T.current}}U.jsx=x;U.jsxs=x;S.exports=U;const J=S.exports.jsx;class W{constructor(e){b(this,"meeting");b(this,"l");b(this,"onUpdate",()=>{this.l.forEach(e=>{e()})});var n,r,s,i,o,a,u,c,p,h,f,l,m,g,v,y,L,j;this.meeting=e,this.l=new Set,(n=this.meeting.self)==null||n.addListener("*",this.onUpdate),(r=this.meeting.meta)==null||r.addListener("*",this.onUpdate),(s=this.meeting.participants)==null||s.addListener("*",this.onUpdate),(o=(i=this.meeting.participants)==null?void 0:i.joined)==null||o.addListener("*",this.onUpdate),(u=(a=this.meeting.participants)==null?void 0:a.active)==null||u.addListener("*",this.onUpdate),(p=(c=this.meeting.participants)==null?void 0:c.waitlisted)==null||p.addListener("*",this.onUpdate),(h=this.meeting.stage)==null||h.addListener("*",this.onUpdate),(f=this.meeting.livestream)==null||f.addListener("*",this.onUpdate),(l=this.meeting.chat)==null||l.addListener("*",this.onUpdate),(m=this.meeting.plugins)==null||m.all.addListener("*",this.onUpdate),(g=this.meeting.recording)==null||g.addListener("*",this.onUpdate),(v=this.meeting.connectedMeetings)==null||v.addListener("*",this.onUpdate),(y=this.meeting.spotlight)==null||y.addListener("*",this.onUpdate),(L=this.meeting.remote)==null||L.addListener("*",this.onUpdate),(j=this.meeting.polls)==null||j.addListener("*",this.onUpdate)}clean(){var e,n,r,s,i,o,a,u,c,p,h,f,l,m,g,v,y,L;(e=this.meeting.self)==null||e.removeListener("*",this.onUpdate),(n=this.meeting.meta)==null||n.removeListener("*",this.onUpdate),(r=this.meeting.participants)==null||r.removeListener("*",this.onUpdate),(i=(s=this.meeting.participants)==null?void 0:s.joined)==null||i.removeListener("*",this.onUpdate),(a=(o=this.meeting.participants)==null?void 0:o.active)==null||a.removeListener("*",this.onUpdate),(c=(u=this.meeting.participants)==null?void 0:u.waitlisted)==null||c.removeListener("*",this.onUpdate),(p=this.meeting.stage)==null||p.removeListener("*",this.onUpdate),(h=this.meeting.livestream)==null||h.removeListener("*",this.onUpdate),(f=this.meeting.chat)==null||f.removeListener("*",this.onUpdate),(l=this.meeting.plugins)==null||l.all.removeListener("*",this.onUpdate),(m=this.meeting.recording)==null||m.removeListener("*",this.onUpdate),(g=this.meeting.connectedMeetings)==null||g.removeListener("*",this.onUpdate),(v=this.meeting.spotlight)==null||v.removeListener("*",this.onUpdate),(y=this.meeting.remote)==null||y.removeListener("*",this.onUpdate),(L=this.meeting.polls)==null||L.removeListener("*",this.onUpdate)}addListener(e){this.l.add(e)}removeListener(e){this.l.delete(e)}}const O=d.createContext({meeting:void 0,updates:void 0});function Y({value:t,children:e,fallback:n}){const[r,s]=d.useState(),i=d.useRef();return d.useEffect(()=>(t&&s(new W(t)),()=>{var o;(o=i.current)==null||o.clean()}),[t]),J(O.Provider,{value:{meeting:t,updates:r},children:t?e:n})}const z=()=>{const{meeting:t}=d.useContext(O);if(!t)throw new Error("useDyteMeeting must be used within the DyteProvider");return{meeting:t}},G=t=>{const e=d.useRef(!1),[n,r]=d.useState(),s=t==null?void 0:t.resetOnLeave;return[n,async o=>{if(!e.current)return e.current=!0,q.default.init(o).then(a=>(r(a),s&&a.self.on("roomLeft",()=>r(void 0)),a.connectedMeetings.on("meetingChanged",u=>{r(u)}),a)).finally(()=>{e.current=!1})}]},H=(t,e)=>!!(t!==e||Array.isArray(t)&&Array.isArray(e)&&t.length!==e.length),K=t=>{const{meeting:e,updates:n}=d.useContext(O);if(!e)throw new Error("useDyteSelector must be used within the DyteProvider");const r=d.useRef(t(e)),[,s]=d.useReducer(i=>i+1,0);return d.useEffect(()=>{const i=e&&t(e),o=()=>{const a=e&&t(e);H(r.current,a)&&(r.current=a,s())};return i&&typeof i=="object"&&"addListener"in i?(i.addListener("*",s),()=>{i.removeListener("*",s)}):(n==null||n.addListener(o),()=>{n==null||n.removeListener(o)})},[e,n]),r.current};exports.DyteContext=O;exports.DyteProvider=Y;exports.useDyteClient=G;exports.useDyteMeeting=z;exports.useDyteSelector=K;
