import{r as t,h as i,H as s,c as a}from"./p-f3ae5269.js";import{h as e}from"./p-64cb70bf.js";import{d as r}from"./p-cadf534b.js";import{u as h}from"./p-02da5bca.js";const o=(t,i)=>{if(null==t)return;const s=Math.round(1.5),a=[...Array(3)].map(((t,a)=>{let e=a;return e>s-1&&(e=3-e-1),Math.round((e+1)/(s+1)*i)})),{width:e,height:r}=t,h=t.getContext("2d");let o=2;const n=1*e/a.length,c=n-4;h.clearRect(0,0,e,r),h.fillStyle="rgb(0,0,0,0.0)",h.fillRect(0,0,e,r);const d=getComputedStyle(t).getPropertyValue("color");h.fillStyle=d,h.strokeStyle=d,h.lineCap="round",h.lineWidth=4,h.beginPath();for(const t of a){const i=Math.min(-Math.abs(1.2*t/10*r)+r/2,r/2-2.5),s=Math.max(2*(r/2-i),5);h.moveTo(o+c/2,i),h.lineTo(o+c/2,i+s),o+=n}h.stroke()},n=class{constructor(i){t(this,i),this.variant="bars",this.participant=void 0,this.size=void 0,this.iconPack=r,this.t=h(),this.isScreenShare=!1,this.audioEnabled=void 0,this.volume=0}connectedCallback(){this.participantChanged(this.participant)}componentDidLoad(){o(this.visualizer,0)}disconnectedCallback(){var t,i,s;null===(t=this.hark)||void 0===t||t.stop(),this.audioUpdateListener&&(null===(i=this.participant)||void 0===i||i.removeListener("audioUpdate",this.audioUpdateListener)),this.screenShareUpdateListener&&(null===(s=this.participant)||void 0===s||s.removeListener("screenShareUpdate",this.screenShareUpdateListener))}participantChanged(t){null!=t&&(this.audioUpdateListener=({audioEnabled:t,audioTrack:i})=>{var s;if(null===(s=this.hark)||void 0===s||s.stop(),t&&null!=i){this.audioEnabled=!0;const t=new MediaStream;t.addTrack(i),this.calcVolume(t),o(this.visualizer,0)}else this.volume=0,this.audioEnabled=!1},this.isScreenShare?(this.screenShareUpdateListener=({screenShareEnabled:t,screenShareTracks:i})=>{this.audioUpdateListener({audioEnabled:t&&null!=i.audio,audioTrack:i.audio})},this.screenShareUpdateListener({screenShareEnabled:t.screenShareEnabled,screenShareTracks:{audio:t.screenShareTracks.audio,video:t.screenShareTracks.video}}),t.addListener("screenShareUpdate",this.screenShareUpdateListener)):(this.audioUpdateListener(t),t.addListener("audioUpdate",this.audioUpdateListener)))}calcVolume(t){this.hark=e(t,{play:!1,interval:100}),this.hark.on("volume_change",(t=>{const i=this.volume;let s=Math.round(10**(t/115)*10);s<3&&(s=0);let a=Math.round((2*i+s)/3);i!==a&&(this.volume=a,o(this.visualizer,this.volume))}))}render(){return i(s,null,i("canvas",{width:"24",height:"24",class:{bars:!0,visible:this.audioEnabled},ref:t=>this.visualizer=t,part:"canvas"}),!this.isScreenShare&&!this.audioEnabled&&i("dyte-icon",{icon:this.iconPack.mic_off,part:"mic-off-icon",iconPack:this.iconPack,t:this.t}))}static get watchers(){return{participant:["participantChanged"]}}};n.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;height:var(--dyte-space-6, 24px);width:-moz-fit-content;width:fit-content}canvas,dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}:host([size='sm']){transform:scale(0.9)}canvas{display:none}canvas.visible{display:block}canvas.bars{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}";const c=class{constructor(i){t(this,i),this.dyteChange=a(this,"dyteChange",4),this.onClick=()=>{this.readonly||this.disabled||(this.checked=!this.checked)},this.onKeyPress=t=>{if(!this.readonly)switch(t.key){case"Enter":case" ":this.checked=!this.checked}},this.checked=!1,this.readonly=!1,this.disabled=!1,this.iconPack=r,this.t=h()}connectedCallback(){this.checkedChange(this.checked)}checkedChange(t){this.checked=t,this.dyteChange.emit(t)}render(){return i(s,{role:"switch",tabIndex:this.disabled&&0,"aria-readonly":this.readonly,"aria-checked":this.checked,"aria-disabled":this.disabled,class:{checked:this.checked},onClick:this.onClick,onKeyPress:this.onKeyPress},i("div",{class:"switch",part:"switch"}))}static get watchers(){return{checked:["checkedChange"]}}};c.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:inline-flex;height:var(--dyte-space-6, 24px);width:var(--dyte-space-10, 40px);align-items:center;padding:var(--dyte-space-1, 4px);border-radius:9999px;background-color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));cursor:pointer}.switch{box-sizing:border-box;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);background-color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));border-radius:9999px;transition-property:var(--dyte-transition-property, all);transition-duration:200ms}:host(.checked){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}:host(.checked) .switch{transform:translateX(100%)}:host([readonly]),:host([disabled]){cursor:not-allowed;opacity:0.6}";export{n as dyte_audio_visualizer,c as dyte_switch}