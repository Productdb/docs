import{r as t,c as i,w as e,h as s,H as o}from"./p-f3ae5269.js";import{d as a}from"./p-cadf534b.js";import{u as r}from"./p-02da5bca.js";import{b as n,s as d}from"./p-57e22a58.js";import{s as l}from"./p-e0d02dd9.js";import{d as c}from"./p-5d856930.js";import"./p-f5545e11.js";const h=class{constructor(e){t(this,e),this.stateUpdate=i(this,"dyteStateUpdate",7),this.stageStateListener=()=>{this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio},this.deviceListUpdateListener=({added:t,removed:i})=>{t.map((t=>{"audioinput"===t.kind&&(this.audioDevices=[...this.audioDevices,t]),"audiooutput"===t.kind&&(this.speakerDevices=[...this.speakerDevices,t])})),i.map((t=>{"audioinput"===t.kind&&(this.audioDevices=this.audioDevices.filter((i=>i.deviceId!==t.deviceId))),"audiooutput"===t.kind&&(this.speakerDevices=this.speakerDevices.filter((i=>i.deviceId!==t.deviceId)))}))},this.deviceUpdateListener=({device:t})=>{"audioinput"===t.kind&&(this.currentDevices=Object.assign(Object.assign({},this.currentDevices),{audio:t})),"audiooutput"===t.kind&&(this.currentDevices=Object.assign(Object.assign({},this.currentDevices),{speaker:t}))},this.meeting=void 0,this.states=void 0,this.size=void 0,this.iconPack=a,this.t=r(),this.audioDevices=[],this.speakerDevices=[],this.canProduceAudio=!0,this.currentDevices={audio:void 0,speaker:void 0}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var t,i,e,s;null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i||i.removeListener("stageStatusUpdate",this.stageStateListener),null===(e=this.meeting)||void 0===e||e.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(s=this.meeting)||void 0===s||s.self.removeListener("deviceUpdate",this.deviceUpdateListener)}meetingChanged(t){null!=t&&e((async()=>{var i,e,s,o;const{self:a,stage:r}=t,n=await t.self.getAudioDevices(),d=await t.self.getSpeakerDevices(),l=null===(i=t.self.getCurrentDevices())||void 0===i?void 0:i.audio,c=null===(e=t.self.getCurrentDevices())||void 0===e?void 0:e.speaker;this.currentDevices={audio:l,speaker:c},this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio,null==r||r.addListener("stageStatusUpdate",this.stageStateListener),a.addListener("deviceListUpdate",this.deviceListUpdateListener),a.addListener("deviceUpdate",this.deviceUpdateListener),this.audioDevices=null!=l?[null!==(s=n.find((t=>t.deviceId===l.deviceId)))&&void 0!==s?s:l,...n.filter((t=>t.deviceId!==l.deviceId))]:n,this.speakerDevices=null!=c?[null!==(o=d.find((t=>t.deviceId===c.deviceId)))&&void 0!==o?o:c,...d.filter((t=>t.deviceId!==c.deviceId))]:d}))}testAudio(){var t;null===(t=this.testAudioEl)||void 0===t||t.play()}setDevice(t,i){var e,s;if(c(this.meeting))return;const o="audio"===t?this.audioDevices.find((t=>t.deviceId===i)):this.speakerDevices.find((t=>t.deviceId===i));this.currentDevices=Object.assign(Object.assign({},this.currentDevices),{[t]:o}),null!=o&&(null===(e=this.meeting)||void 0===e||e.self.setDevice(o),"audiooutput"===o.kind&&(null===(s=this.testAudioEl)||void 0===s||s.setSinkId(o.deviceId)))}render(){var t,i;if(null==this.meeting)return null;let e=0,a=0;const r=this.states||l,h=!0===(null===(t=null==r?void 0:r.prefs)||void 0===t?void 0:t.muteNotificationSounds)||"true"===n("mute-notification-sounds");return s(o,null,s("audio",{preload:"auto",src:"https://assets.dyte.io/ui-kit/speaker-test.mp3",ref:t=>this.testAudioEl=t}),this.canProduceAudio&&s("div",{class:"group",part:"microphone-selection"},s("label",null,this.t("settings.microphone_input")),s("div",{class:"row"},s("select",{class:"dyte-select",onChange:t=>this.setDevice("audio",t.target.value)},this.audioDevices.map((({deviceId:t,label:i})=>{var o;return s("option",{value:t,selected:(null===(o=this.currentDevices.audio)||void 0===o?void 0:o.deviceId)===t},i||"Microphone "+ ++e)}))),s("dyte-audio-visualizer",{participant:null===(i=this.meeting)||void 0===i?void 0:i.self,iconPack:this.iconPack,t:this.t}))),s("div",{class:"group",part:"speaker-selection"},this.speakerDevices.length>0&&!c(this.meeting)&&s("div",null,s("label",null,this.t("settings.speaker_output")),s("div",{class:"row"},s("select",{class:"dyte-select",onChange:t=>this.setDevice("speaker",t.target.value)},this.speakerDevices.map((({deviceId:t,label:i})=>{var e;return s("option",{value:t,selected:(null===(e=this.currentDevices.speaker)||void 0===e?void 0:e.deviceId)===t},i||"Speaker "+ ++a)}))))),s("dyte-button",{variant:"secondary",onClick:()=>this.testAudio(),iconPack:this.iconPack,t:this.t},s("dyte-icon",{icon:this.iconPack.speaker,slot:"start",iconPack:this.iconPack,t:this.t}),this.t("test"))),s("div",{class:"group",part:"notification-toggle"},s("div",{class:"row"},s("label",{htmlFor:"notification-toggle"},this.t("settings.notification_sound")),s("dyte-switch",{id:"notification-toggle",checked:!h,onDyteChange:t=>{var i;const{checked:e}=t.target,s=!e;this.stateUpdate.emit({prefs:{muteNotificationSounds:s}}),l.prefs=Object.assign(Object.assign({},null!==(i=l.prefs)&&void 0!==i?i:{}),{muteNotificationSounds:s}),d("mute-notification-sounds",s)},iconPack:this.iconPack,t:this.t}))))}static get watchers(){return{meeting:["meetingChanged"]}}};h.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.dyte-select{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.dyte-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.dyte-select{display:block;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--dyte-space-3, 12px);font-size:16px;--icon-size:var(--dyte-select-chevron-size, var(--dyte-space-6, 24px));--icon-right-position:var(--dyte-select-chevron-right-position, var(--dyte-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5)}:host{display:flex;width:100%;flex-direction:column}audio{visibility:hidden}label{-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:14px}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}.row{display:flex;align-items:center;justify-content:space-between;gap:var(--dyte-space-3, 12px)}.dyte-select{width:100%;max-width:100%;text-overflow:ellipsis}dyte-audio-visualizer{flex-shrink:0}dyte-button{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}dyte-button dyte-icon{margin-right:var(--dyte-space-2, 8px)}";const p=class{constructor(e){t(this,e),this.stateUpdate=i(this,"dyteStateUpdate",7),this.onVideoUpdate=t=>{this.videoEnabled=t.videoEnabled},this.deviceListUpdateListener=({added:t,removed:i})=>{t.map((t=>{"videoinput"===t.kind&&(this.videoDevices=[...this.videoDevices,t])})),i.map((t=>{"videoinput"===t.kind&&(this.videoDevices=this.videoDevices.filter((i=>i.deviceId!==t.deviceId)))}))},this.deviceUpdateListener=({device:t})=>{"videoinput"===t.kind&&(this.currentDevice=t)},this.meeting=void 0,this.states=void 0,this.size=void 0,this.iconPack=a,this.t=r(),this.videoDevices=[],this.currentDevice=void 0,this.videoEnabled=void 0}componentDidLoad(){this.meetingChanged(this.meeting)}meetingChanged(t){var i,s,o;null!=t&&(this.videoEnabled=t.self.videoEnabled,null===(i=t.self)||void 0===i||i.addListener("videoUpdate",this.onVideoUpdate),null===(s=t.self)||void 0===s||s.addListener("deviceListUpdate",this.deviceListUpdateListener),null===(o=t.self)||void 0===o||o.addListener("deviceUpdate",this.deviceUpdateListener),e((async()=>{var i,e;const s=await t.self.getVideoDevices(),o=null===(i=t.self.getCurrentDevices())||void 0===i?void 0:i.video;this.videoDevices=null!=o?[null!==(e=s.find((t=>t.deviceId===o.deviceId)))&&void 0!==e?e:o,...s.filter((t=>t.deviceId!==o.deviceId))]:s})))}disconnectedCallback(){var t,i,e;null===(t=this.meeting.self)||void 0===t||t.removeListener("videoUpdate",this.onVideoUpdate),null===(i=this.meeting)||void 0===i||i.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(e=this.meeting)||void 0===e||e.self.removeListener("deviceUpdate",this.deviceUpdateListener)}async setDevice(t){var i;const e=this.videoDevices.find((i=>i.deviceId===t));this.currentDevice=e,null!=e&&await(null===(i=this.meeting)||void 0===i?void 0:i.self.setDevice(e))}render(){var t,i,e;if(null==this.meeting)return null;let a=0;const r=this.states||l,c=!0===(null===(t=null==r?void 0:r.prefs)||void 0===t?void 0:t.mirrorVideo)||"true"===n("mirror-video");return s(o,null,s("div",{class:"section",part:"tile-preview"},s("div",{class:"group",part:"tile-preview"},!0===this.videoEnabled?s("dyte-participant-tile",{meeting:this.meeting,participant:null===(i=this.meeting)||void 0===i?void 0:i.self,iconPack:this.iconPack,t:this.t,states:r,size:this.size,isPreview:!0}):s("div",{class:"camera-off-helper"},s("dyte-participant-tile",{meeting:this.meeting,participant:null===(e=this.meeting)||void 0===e?void 0:e.self,size:this.size},s("div",null,s("dyte-icon",{id:"icon",icon:this.iconPack.video_off,tabIndex:-1,"aria-hidden":!0,iconPack:this.iconPack,t:this.t}),s("div",null,this.t("settings.camera_off"))))))),s("div",{class:"section",part:"video-settings"},s("div",{class:"group",part:"camera-selection"},s("label",null,this.t("camera")),s("div",{class:"row"},s("select",{class:"dyte-select",onChange:t=>this.setDevice(t.target.value)},this.videoDevices.map((({deviceId:t,label:i})=>{var e;return s("option",{selected:(null===(e=this.currentDevice)||void 0===e?void 0:e.deviceId)===t,value:t},i||"Camera "+ ++a)}))))),s("div",{class:"group",part:"mirror-toggle"},s("div",{class:"row"},s("label",{htmlFor:"mirror-toggle"},this.t("settings.mirror_video")),s("dyte-switch",{checked:c,iconPack:this.iconPack,t:this.t,onDyteChange:t=>{var i;const{checked:e}=t.target;this.stateUpdate.emit({prefs:{mirrorVideo:e}}),l.prefs=Object.assign(Object.assign({},null!==(i=l.prefs)&&void 0!==i?i:{}),{mirrorVideo:e}),d("mirror-video",e)}})))))}static get watchers(){return{meeting:["meetingChanged"]}}};p.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.dyte-select{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.dyte-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.dyte-select{display:block;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--dyte-space-3, 12px);font-size:16px;--icon-size:var(--dyte-select-chevron-size, var(--dyte-space-6, 24px));--icon-right-position:var(--dyte-select-chevron-right-position, var(--dyte-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5)}:host{display:flex;width:100%;flex-direction:column}.dyte-select{width:100%;text-overflow:ellipsis}dyte-participant-tile{margin-left:auto;margin-right:auto;margin-bottom:var(--dyte-space-4, 16px);max-width:100%}#icon{padding-bottom:var(--dyte-space-1, 4px)}.apply-button{height:var(--dyte-space-10, 40px)}label{-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:14px}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}.row{display:flex;align-items:center;justify-content:space-between;gap:var(--dyte-space-3, 12px)}.section{display:flex;flex-direction:column}@media only screen and (max-height: 480px) and (orientation: landscape){:host{flex-direction:row}:host([size='sm']){flex-direction:row}.section[part='tile-preview']{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);max-height:90%;max-width:40%;flex-shrink:1}.section[part='video-settings']{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);flex-grow:1}}";export{h as dyte_settings_audio,p as dyte_settings_video}