"use client";
import{useEffect as Dt,useState as Ot}from"react";import{ErrorBoundary as Ht}from"react-error-boundary";import Ut from"swr";import{createContext as Ue,useCallback as $e,useContext as Qe,useEffect as Fe}from"react";import fe,{mutate as ze}from"swr";var W="https://public.docsly.dev/api/v1.8",A={getProjectSettings:"/get-project-settings",getComments:"/get-comments",getCommentsPublic:"/get-comments-public",addFeedback:"/add-feedback",addComment:"/add-comment",getTeamMember:"/get-team-member",updateCommentStatus:"/update-comment-status",measure:"/measure"};function I(e,t=W){return`${t||W}${e}`}var me={32:"https://www.docsly.dev/comment-pointer-min.png",64:"https://www.docsly.dev/comment-pointer-64-min.png",128:"https://www.docsly.dev/comment-pointer-128-min.png"},ye=`
body.docsly-active {
  /* Use 1x image for DPR <= 1 */
  cursor: -webkit-image-set(
    url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAhCAMAAABgOjJdAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAACBUExURUdwTABb5ABc5ABa4wBa5ABg3wBb5QBb5ABY3wBb5QBb5ABQ3wBb5ABb5ABY4wBc4wBc4wBa5QBc4gBZ4gBc4wBa5QBb5ABZ5ABa5QBb5ABa4wBa4gBc5QBa5ABb5P///0CE6yBv5xBm5hBl5t/r/CBv6O/1/mCZ7u/1/XCi8HCj8HM0MbEAAAAedFJOUwDP75AwEJ/fIN/vEL+PQJCAf1BQQK9wcJ+gsGCvYDpgOOcAAADoSURBVDjLldNXDoMwDABQQxlJGd27zWB13P+AZahgo0BU/6CEp9hgByCNBYkwTnYRoEiFIdyADcIR5tj0IpwQgjObENyzid8pM0Jw3yZEYhWiKWVJt7KMLA+1oCAvCkr8sdBSKrJxsoqzVXAsMqXUU8pnWZaoFiwK2ccrQ6L/2rwahNRIDH9M11k+Ur7rh8ZZ6HyocaUOwGJeXAG28+IG4JPG5FWliWhGhKbROVkGTfvZXPe7KVtPg6CbVN8+7myCuMO18ozE9dDVNJ3CMahrWY3Bgtzu9pgLfh/vwRDscW/bGAbHCP6JL9uJY10HcNI3AAAAAElFTkSuQmCC) 1x,
    url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABBCAMAAAC5KTl3AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxMAAAsTAQCanBgAAACoUExURUdwTABa4wBg3wBY4wBb5QBc4wBa4gBb5ABY3wBZ4gBa5ABc5ABb5ABb5ABb5ABb5ABb5QBQ3wBc4wBa5ABb5ABa5QBZ5ABc4gBZ4gBb5ABb5ABa5gBc4wBa4wBa5QBa4wBV5ABb5P///7/W+ECE6yBv6CBv5+/1/hBm5lCO7K/M9jB66d/r/BBl5pC384Ct8bDM9nCj74Ct8q/M92CZ7s/h+mCY7s/g+wwQ7qUAAAAhdFJOUwCQEEDfQGC/IKAw73DfoO+fEIBgz69wUFCfjx+QgH+wMMAHDpwAAAGaSURBVFjDpdfZcoJAEAXQC4JMAIPGNZqtGxI1LtmT//+zPGgsq9LMDPR9s4RTQzPFdAMmcaQ/z2cG9TE98kk07tYpAXlnPBOFC2qQqKsVRKOhQNQ3WuHfMpoLRHdqga7VAiWhVjhfRUuB5mqBJmqBUrUQhVqBbg/CuL1Ah/2dKIRELVBHLQRuoVry86r+7yJ0CltmfnFsK6vwxMxcOmqpEyhUCzO1EKiFRC0UaoFCWVhVh3wyM389HiMKC1FYL1mKuDs7orBlOW/eQg3Ae2+hrBE2oiB95Xbv5SE/zMzL44+PtfyJsHYglfttLpArBWCqE0aA0Qn3AAqVMHEcOW7hAcBQI0QAEFou2DAzv9raMueZUzLz2nXkILZcsfveV66HAODXWUv56wuHrTuIUyfUUy7BXgmvJbQ9wNPzMaVoe/SfMtU9AwBcNQb+DU2XiiK0qqY0LoUNVpF15bHvxhtI62ZPz3KOjHJ8DQawxbmMKIYjxlrQLIdH6o1RPoBfzFDYHFkQo0kG0yDJTnf3+nmz20+MieM4To31ol+CKrbrAE4TvQAAAABJRU5ErkJggg==) 2x)
      0 0,
    pointer;
}`;function oe(e){let t=e?.anchorNode?.parentElement,o=e?.focusNode?.parentElement,n=t?.offsetTop<o?.offsetTop?t:o;return{upperElmRect:n.getBoundingClientRect(),upperElement:n,elementStart:t,elementEnd:o}}function pe(e,t,o,n){let l=document.getElementById("docsly-selected-text"),m=e.getBoundingClientRect(),a=e?.offsetTop+(t.top-m.top),i=document.createElement("span");i.setAttribute("class",`highlight-span-${o}`),i.setAttribute("data-id",o),n&&(i.onclick=n),i.setAttribute("style",`background-color: #e73bf6; opacity: 0.2; position: absolute; left: ${t.left}px; top: ${a}px; height: ${t.height}px; width: ${t.width}px`),l?.appendChild(i)}function j(e,t){if(!t)return[];if(t.startOffset===t.endOffset)return[];try{let o=document.createRange(),n=document.querySelector(t.startContainerNodeId)?.childNodes[t.startContainerTextNodeIndex],l=document.querySelector(t.endContainerNodeId)?.childNodes[t.endContainerTextNodeIndex];o.setStart(n,t.startOffset),o.setEnd(l,t.endOffset);let m=e.getBoundingClientRect();return Array.from(o.getClientRects()).map(i=>{let y=e?.offsetTop+(i.top-m.top);return{...i.toJSON(),top:y}})}catch{return[]}}var H=(...e)=>fetch(...e).then(t=>{if(t.status>300)throw new Error(t.statusText);return t.json()});function J(e,t,o,n){let l=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),m=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)+window.scrollY,a=48,i=32;o&&(o.style.left=`${e}px`,o.style.top=`${t}px`);let y={width:n.clientWidth||320,height:n.clientHeight||100};if(n&&o){let p=e+y.width+a*1.5<l,h=t+y.height+a*1.5<m,g=e-y.width<0,b=g?Math.floor(Math.abs(l-y.width)/2):Math.abs(e-y.width),r=t-y.height-a*1.5;p&&h?(n.style.left=`${e+a}px`,n.style.top=`${t+a}px`,o.style.rotate="0deg",n.style.transformOrigin="left top",o.style.transformOrigin="left top"):p&&!h?(o.style.rotate="-90deg",o.style.top=`${t-a}px`,o.style.left=`${e+i}px`,n.style.left=`${e+a}px`,n.style.top=`${r}px`,n.style.transformOrigin="left bottom",o.style.transformOrigin="left bottom"):!p&&h?(n.style.left=`${b}px`,n.style.top=`${t+a}px`,o.style.left=`${e-i*1.5}px`,o.style.top=`${t+i}px`,o.style.rotate="90deg",n.style.transformOrigin="right top",o.style.transformOrigin="right top"):(n.style.left=`${b}px`,n.style.top=`${r}px`,o.style.left=`${e-a-i}px`,o.style.top=`${t-a-i*2}px`,g?o.style.rotate="0deg":o.style.rotate="-180deg",n.style.transformOrigin="right bottom",o.style.transformOrigin="right bottom")}Oe(o,n)}function V(e,t){let o=e.metadata,n=t.getBoundingClientRect(),l={width:n.width,height:n.height},m=window.scrollY||document.documentElement.scrollTop,a=n.top+m,i=window.scrollX||document.documentElement.scrollLeft,p=n.left+i+o.xRelativeToParent*(l.width/o.elementDimensions.width),h=a+o.yRelativeToParent*(l.height/o.elementDimensions.height);return{xRelativeToParent:p,yRelativeToParent:h}}function K(e){return e?.user?.picture||`https://source.boringavatars.com/beam/24/${e?.user?.sub||e.id}`}function De(e){e.classList.add("dy-flex"),e.classList.remove("dy-hidden")}function ne(e){e.classList.remove("dy-flex"),e.classList.add("dy-hidden")}function Oe(e,t){e.classList.add("dy-flex"),e.classList.remove("dy-hidden"),De(t)}function ue(e,t){e.classList.remove("dy-flex"),e.classList.add("dy-hidden"),ne(t)}function se(e){let t=document.getElementsByClassName("highlight-span-commenting");t&&Array.from(t).forEach(o=>o.remove())}var E="1.8.6";import{jsx as We}from"react/jsx-runtime";var ge={docslyTextHighlightStyles:"dy-opacity-50 dy-bg-[hotpink]",docslyBrandStyles:"dy-bg-brand-700 dy-text-neutral-50",docslyToolboxStyles:"dy-bg-black dy-text-neutral-100",docslyInboxStyles:"dy-bg-black dy-text-neutral-100 dy-border-neutral-800",docslyCommentBoxStyles:"dy-border-neutral-300 dy-bg-black dy-text-neutral-200",docslyInputStyles:"dy-bg-inherit placeholder:dy-text-neutral-400"},be=Ue({pathname:"/",publicId:"",baseURL:W,saveComment:()=>Promise.resolve(),appearance:ge,isTeamMember:!1,settings:{onlyAuth:!1,allowMobile:!1,status:"off",plan:"starter"},comments:[]}),he="/";function xe({children:e,value:t}){let{pathname:o,publicId:n,baseURL:l}=t,m=typeof o=="string"&&o.trim().length?o.trim():he,{data:a}=fe([I(A.getTeamMember,t.baseURL)],r=>H(r,{credentials:"include",headers:{"x-sparkle-from":window.location.href,"x-sparkle-version":E,"x-sparkle-public-id":t.publicId}}),{shouldRetryOnError:!1,dedupingInterval:5e3,revalidateOnFocus:!1}),i=a&&a?.isTeamMember?A.getComments:A.getCommentsPublic,y=new URL(I(i,l));y.searchParams.set("publicId",n),y.searchParams.set("pathname",m),y.searchParams.set("version",E);let{data:p,isLoading:h,error:g}=fe(y.href,r=>H(r,{credentials:"include",headers:{"x-sparkle-from":window.location.href,"x-sparkle-public-id":n,"x-sparkle-version":E}}),{shouldRetryOnError:!1,dedupingInterval:1e3,revalidateOnFocus:!0}),b=$e(async r=>{let d=I(A.addComment,t.baseURL),u=null;if(t.getUserToken)try{u=await t.getUserToken()}catch{}else if(t.user)u=t.user;else if(a?.isTeamMember)u=null;else{let s=localStorage.getItem("docsly-user");u=s?JSON.parse(s):null}return fetch(d,{method:"POST",body:JSON.stringify({...r,user:u}),credentials:"include",headers:{"Content-type":"application/json","x-sparkle-from":window.location.href,"x-sparkle-public-id":t.publicId,"x-sparkle-version":E}}).then(s=>(t.onDocslyEvent&&t.onDocslyEvent(r?.threadId?"docsly_reply":"docsly_comment",r),s.json())).then(s=>{if(!u&&s.user&&localStorage.setItem("docsly-user",JSON.stringify(s.user)),s.newCommentData){let f=p.filter(c=>c.id!==s.newCommentData.id);return f.push(s.newCommentData),ze(y.href,f,{revalidate:!1})}}).catch(s=>{})},[t,a,p,y.href]);return Fe(()=>{fetch(I(A.measure,t.baseURL),{method:"GET",credentials:"include",headers:{"x-sparkle-from":window.location.href,"x-sparkle-version":E,"x-sparkle-public-id":t.publicId}}).then(r=>r.json()).catch(r=>{})},[m,t.publicId]),We(be.Provider,{value:{showHighlightedText:!0,showCommentAvatar:!0,highlightToComment:!0,saveComment:b,...t,pathname:m,appearance:{...ge,...t.appearance},isTeamMember:a?.isTeamMember||!1,comments:g||h?[]:p},children:e})}function C(){return Qe(be)}import{useCallback as Bt,useEffect as te,useRef as Se,useState as Be}from"react";import{toast as z,Toaster as Lt}from"react-hot-toast";import{useCallback as Ce,useEffect as de,useState as re}from"react";import{toast as Ge}from"react-hot-toast";var je=e=>{let t=[];for(;e;){let o=e.nodeName.toLowerCase(),n=e.id?`#${e.id}`:"",l="";e.className&&typeof e.className=="string"&&(l=`.${e.className.trim().replace(/\s+/g,".").replace(/[:*+?^${}()|[\]\\]/gi,"\\$&")}`),t.unshift({element:e,selector:o+n}),e=e.parentNode!==document?e.parentNode:!1}return t};var Je=(e,t=!0)=>{let o=e,n=1;for(;o.previousElementSibling!==null;)(!t||o.previousElementSibling.nodeName===e.nodeName)&&n++,o=o.previousElementSibling;return n};var Ve=(e,t)=>{let o=t===""?e:`${t} > ${e}`;return document.querySelectorAll(o).length>1},Ke=e=>{let t=[];return e.forEach(o=>{Ve(o.selector,t.join(" > "))&&(o.selector+=`:nth-of-type(${Je(o.element)})`),t.push(o.selector)}),t.join(" > ")};function Y(e){if(e instanceof HTMLElement)return Ke(je(e))}import{useState as Ye,useEffect as qe}from"react";function we(){let[e,t]=Ye(!1);return qe(()=>{t("ontouchstart"in window||navigator.maxTouchPoints>0)},[]),e}function ve({commentBoxRef:e,commentIconRef:t}){let{pathname:o,highlightToComment:n}=C(),[l,m]=re(!1),[a,i]=re({}),y=we(),[p,h]=re("none"),g=Ce((r,d,u)=>{h("addComment");let s=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),f=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0,document.documentElement.scrollHeight),c=u.getBoundingClientRect(),w=window.scrollY||document.documentElement.scrollTop,M=c.top+w,k=window.scrollX||document.documentElement.scrollLeft,x=c.left+k,N={height:c.height,width:c.width},B={nodeId:Y(u),x:r,y:d,xRelativeToParent:r-x,yRelativeToParent:d-M,elementDimensions:N,pageTitle:document.title,userAgent:navigator.userAgent,screenWidth:s,screenHeight:f,devicePixelRatio:window.devicePixelRatio};i(B);let v=t.current,ce=e.current;ce&&v&&J(r,d,v,ce)},[]);de(()=>{let r=t.current,d=t.current;p!=="selectedComment"&&p!=="addComment"&&d&&r&&ue(d,r),se("activeComponent changed")},[p]),de(()=>{h("none")},[o]),de(()=>{function r(s){if(!s.target||!l)return;let f=s.target,c=e.current;if(document.getSelection()?.type==="Range"){m(!1);return}s.target&&!c?.contains(f)&&(Ge.dismiss(),m(!1),h("addComment"),g(s.x,s.pageY,f))}function d(){let s=document.getSelection(),f=document.getElementById("docsly-comments-inbox");if(s?.type!=="Range")return;let{upperElement:c}=oe(s),M=s?.getRangeAt(0)?.getClientRects();if(l&&!f?.contains(s?.focusNode)&&M?.length){let k=Array.from(M),x=k[k.length-1],N=c.getBoundingClientRect(),B=c?.offsetTop+(x.top-N.top);g(x.right+36,B+36,c)}}function u(){let s=window.getSelection();if(s.type==="Range"){if(!l)return!1;try{let f=s?.getRangeAt(0),c=s?.toString(),w=Array.from(f.getClientRects()),M=Y(s.anchorNode?.parentElement),k=Y(s.focusNode?.parentElement),x=Array.from(s.anchorNode?.parentElement?.childNodes||[]).findIndex(v=>v.nodeType===Node.TEXT_NODE&&v.isEqualNode(s.anchorNode)),N=Array.from(s.focusNode?.parentElement?.childNodes||[]).findIndex(v=>v.nodeType===Node.TEXT_NODE&&v.isEqualNode(s.focusNode)),{upperElement:B}=oe(s);i(v=>({...v,selectedText:c,selection:{endOffset:s.focusOffset,startOffset:s.anchorOffset,endContainerNodeId:k,startContainerNodeId:M,startContainerTextNodeIndex:x,endContainerTextNodeIndex:N}})),se("highlightSelectedText"),w.forEach(v=>Math.floor(v.width)>0?pe(B,v,"commenting"):null)}catch{return}}}return n&&!y&&(document.addEventListener("selectionchange",d),document.addEventListener("mouseup",u)),document.addEventListener("click",r),()=>{n&&!y&&(document.removeEventListener("selectionchange",d),document.removeEventListener("mouseup",u)),document.removeEventListener("click",r)}},[l,y,n,g]);let b=Ce(()=>{m(r=>!r)},[]);return{commentModeActive:l,setActiveComponent:h,activeComponent:p,metadata:a,setMetadata:i,setCommentModeActive:m,toggleCommentMode:b}}import{useEffect as _e}from"react";import{jsx as Xe}from"react/jsx-runtime";function Ae({comments:e,setSelectedComment:t}){let{pathname:o,showCommentAvatar:n,appearance:l,showHighlightedText:m}=C();return _e(()=>{function a(){let i={},p=new URL(window.location.href).searchParams.get("docslyCommentId"),h=document.getElementById("docsly-current-page-comments");h.innerHTML="",e&&e.length&&e.forEach(g=>{let b=g.metadata,r=document.querySelector(b.nodeId);if(!r)return;i[b.nodeId]?i[b.nodeId]++:i[b.nodeId]=1;let{selection:d,selectedText:u}=b,{xRelativeToParent:s,yRelativeToParent:f}=V(g,r),c=f||r?.offsetTop+r.clientHeight,w={top:`${c}px`,left:`${s}px`},M=[];if(r&&u&&d&&(M=j(r,d),M.length)){i[b.nodeId]--;let x=M[M.length-1];w={top:`${x.top+x.height}px`,left:`${x.width+x.x}px`}}let k=document.createElement("button");if(k.onclick=()=>{t(g)},k.setAttribute("class","cursor-pointer"),k.setAttribute("id",`docsly-comment-main-${g.id}`),n){let x=document.createElement("div");x.setAttribute("class","dy-absolute dy-select-none dy-shadow-sm dy-z-10 hover:dy-z-20"),x.setAttribute("id",`docsly-comment-avatar-${g.id}`),x.setAttribute("style",`left: ${w.left}; top: ${w.top}`);let N=document.createElement("span");N.setAttribute("class"," dy-block dy-rounded-full dy-overflow-hidden dy-bg-black dy-border-[3px] dy-border-black");let B=document.createElement("img");B.setAttribute("class","dy-block dy-w-6 dy-h-6 md:hover:dy-w-8 md:hover:dy-h-8 dy-transition-all dy-duration-150 dy-object-center dy-object-cover"),B.setAttribute("src",K(g)),N.appendChild(B);let v=document.createElement("span");v.setAttribute("class","dy-w-4 dy-h-4 dy-absolute -dy-z-10 dy-rounded-t-[3px] dy-bg-black dy-top-0 dy-left-0"),x.appendChild(v),x.appendChild(N),k.appendChild(x)}m&&M.forEach(x=>{let N=document.createElement("span");N.setAttribute("class",`docslyTextHighlightStyles dy-absolute ${l.docslyTextHighlightStyles} highlight-span-${g.id}`),N.setAttribute("style",`
              left: ${x.left}px;
              height: ${x.height}px;
              width: ${x.width}px;
              top: ${x.top}px;
            }`),k.appendChild(N)}),h.appendChild(k),p&&p===g.id&&setTimeout(()=>{scrollTo({top:c-window.innerHeight/2,behavior:"smooth"})},200)})}return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[e,l,o,t,n,m]),Xe("div",{id:"docsly-current-page-comments"})}import ut from"clsx";import{XMarkIcon as ft}from"@heroicons/react/24/outline";import dt from"clsx";import X from"dayjs";import rt from"dayjs/plugin/relativeTime.js";import at from"dayjs/plugin/updateLocale";import{useState as it}from"react";import{toast as lt}from"react-hot-toast";import{mutate as ct}from"swr";import{jsx as T,jsxs as Ze}from"react/jsx-runtime";function q(e){return T("svg",{xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",className:"text-neutral-400",viewBox:"0 0 2400 2400",width:24,height:24,...e,children:Ze("g",{strokeWidth:200,strokeLinecap:"round",stroke:"currentColor",fill:"none",children:[T("path",{d:"M1200 600L1200 100"}),T("path",{opacity:.5,d:"M1200 2300L1200 1800"}),T("path",{opacity:.917,d:"M900 680.4L650 247.4"}),T("path",{opacity:.417,d:"M1750 2152.6L1500 1719.6"}),T("path",{opacity:.833,d:"M680.4 900L247.4 650"}),T("path",{opacity:.333,d:"M2152.6 1750L1719.6 1500"}),T("path",{opacity:.75,d:"M600 1200L100 1200"}),T("path",{opacity:.25,d:"M2300 1200L1800 1200"}),T("path",{opacity:.667,d:"M680.4 1500L247.4 1750"}),T("path",{opacity:.167,d:"M2152.6 650L1719.6 900"}),T("path",{opacity:.583,d:"M900 1719.6L650 2152.6"}),T("path",{opacity:.083,d:"M1750 247.4L1500 680.4"}),T("animateTransform",{attributeName:"transform",attributeType:"XML",type:"rotate",keyTimes:"0;0.08333;0.16667;0.25;0.33333;0.41667;0.5;0.58333;0.66667;0.75;0.83333;0.91667",values:"0 1199 1199;30 1199 1199;60 1199 1199;90 1199 1199;120 1199 1199;150 1199 1199;180 1199 1199;210 1199 1199;240 1199 1199;270 1199 1199;300 1199 1199;330 1199 1199",dur:"0.83333s",begin:"0s",repeatCount:"indefinite",calcMode:"discrete"})]})})}import{CheckCircleIcon as mt,EyeSlashIcon as yt}from"@heroicons/react/24/outline";import{StarIcon as pt}from"@heroicons/react/24/solid";import et from"clsx";import{useEffect as tt,useRef as ot,useState as ae}from"react";import{toast as nt}from"react-hot-toast";import{PaperAirplaneIcon as st}from"@heroicons/react/24/outline";import{jsx as G,jsxs as ie}from"react/jsx-runtime";function _({disabled:e=!1,commentBoxRef:t,placeholder:o="Start a new comment...",onSubmit:n}){let{appearance:l,getUserToken:m,settings:a}=C(),i=ot(null),[y,p]=ae(!1),[h,g]=ae(""),[b,r]=ae(!a.onlyAuth||!m);function d(){p(!0),n(h).then(()=>{p(!1),nt("Thank you! We've received your comment.",{duration:3e3,position:"top-center"}),g("")})}tt(()=>{(async()=>{if(!a.onlyAuth||!m){r(!1);return}if(await m()){r(!1);return}r(!0)})()},[m,a.onlyAuth]);let u=!h.trim()||h.length===200,s=y||e||b||u;return ie("div",{id:"docsly-comment-textarea","data-test-id":"docsly-comment-textarea-container",onClick:f=>f.stopPropagation(),className:"dy-w-full dy-flex dy-flex-col dy-justify-between",children:[G("textarea",{value:h,ref:i,"data-test-id":"docsly-comment-textarea",className:`docslyInputStyles dy-h-[25px] dy-w-full dy-text-sm dy-outline-none dy-overflow-hidden 
        dy-transition-all focus:dy-outline-none focus:dy-ring-0
        dy-duration-200 dy-rounded dy-resize-none dy-border-none dy-bg-inherit ${l.docslyInputStyles}`,placeholder:o,onClick:f=>f.stopPropagation(),disabled:e||y,onChange:f=>{let c=f.target.value;if(!(c.length>200)&&(g(c),i.current)){let w=Math.min(Math.ceil((c.length+1)/30)*25,100);i.current.style.height=`${w}px`,t?.current&&(t.current.style.height=`${100+w}px`)}}}),ie("div",{"data-test-id":"docsly-comment-submit-container",className:"dy-w-full dy-flex dy-flex-row dy-justify-end dy-items-end",children:[ie("span",{"data-test-id":"docsly-comment-input-length",className:"dy-mr-2 dy-text-xs",children:[h.length," / 200"]}),G("button",{onClick:d,disabled:s,"data-test-id":"docsly-comment-submit-button","aria-label":b?"Only logged in users can comment":u?"Type comment to submit feedback":"Submit feedback",title:b?"Only logged in users can comment":u?"Type comment to submit feedback":"Submit feedback",className:`docslyBrandStyles dy-py-1 dy-px-2 dy-transition-colors dy-duration-150 dy-rounded dy-self-end
        ${s?"dy-bg-neutral-50 dy-bg-opacity-20 dy-text-neutral-400":l.docslyBrandStyles}
          `,children:y?G(q,{className:"dy-w-4 dy-block dy-h-4"}):G(st,{className:et("dy-w-4 dy-block dy-h-4")})})]})]})}import{jsx as R,jsxs as L}from"react/jsx-runtime";X.extend(rt);X.extend(at);X.updateLocale("en",{relativeTime:{future:"in %s",past:"%s ago",s:"a few secs",m:"a min",mm:"%d mins",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"}});function Z({comment:e}){let{saveComment:t,baseURL:o,comments:n,isTeamMember:l,pathname:m,publicId:a}=C(),i=l?A.getComments:A.getCommentsPublic,y=new URL(I(i,o));y.searchParams.set("publicId",a),y.searchParams.set("pathname",m),y.searchParams.set("version",E);let[p,h]=it(!1);function g(d){return t({text:d,threadId:e.id})}let b=[e,...e.thread_replies].sort((d,u)=>new Date(d.createdAt).getTime()-new Date(u.createdAt).getTime());function r(d,u){let s=I(A.updateCommentStatus,o);return h(!0),fetch(s,{method:"POST",body:JSON.stringify({visibility:d,commentId:u}),credentials:"include",headers:{"Content-type":"application/json","x-sparkle-from":window.location.href,"x-sparkle-public-id":a,"x-sparkle-version":E}}).then(f=>{if(lt("Comment status updated successfully!",{duration:2e3,position:"top-center"}),f.status===200){let c=n.filter(w=>w.id!==u);return ct(y.href,c,{revalidate:!1})}}).catch(f=>{}).finally(()=>h(!1))}return L("div",{className:`dy-relative dy-border-dashed dy-border-b-[1px]
    dy-border-neutral-700 last-of-type:dy-border-none`,children:[p&&R(q,{className:`dy-absolute dy-top-[50%] dy-left-[50%] -dy-translate-x-[50%] 
        -dy-translate-y-[50%] dy-w-6 dy-h-6`}),L("div",{onClick:d=>{p&&(d.stopPropagation(),d.preventDefault());let u=document.querySelector(e.metadata.nodeId);u&&window.scroll({behavior:"smooth",left:0,top:u.offsetTop-20})},className:dt("dy-w-full dy-px-4 dy-pt-2 dy-pb-4  dy-space-y-4",{"dy-opacity-60 dy-cursor-progress":p}),id:`selected_${e.id}`,children:[b.map(d=>L("div",{children:[L("div",{className:"dy-flex dy-flex-row dy-items-center dy-mb-1 ",children:[L("div",{className:"dy-flex-1 dy-flex dy-flex-row dy-items-center",children:[L("button",{"aria-label":d?.user?.isTeamMember?"Team member":d?.user?.name,title:d?.user?.isTeamMember?"Team member":d?.user?.name,className:"dy-relative dy-w-6 dy-h-6 dy-mr-1",children:[R("img",{src:K(d),alt:"user-avatar",className:"dy-rounded-full dy-w-full dy-h-full dy-object-center dy-object-cover mx-auto"}),d?.user?.isTeamMember&&R("span",{className:"dy-block dy-p-[1px] dy-rounded-full dy-overflow-hidden dy-absolute -dy-bottom-[2px] -dy-right-[2px] dy-bg-black dy-bg-opacity-75",children:R(pt,{className:"dy-block dy-w-3 dy-text-yellow-400 dy-h-3"})})]}),R("p",{className:"dy-text-sm dy-text-neutral-300 dy-w-28 dy-capitalize dy-whitespace-nowrap dy-overflow-ellipsis dy-overflow-hidden",children:d?.user?.name||"Anonymous"})]}),R("p",{className:"dy-text-right dy-text-xs dy-ml-2 dy-mt-1 dy-text-neutral-400 dy-w-20 dy-whitespace-nowrap dy-overflow-ellipsis dy-overflow-hidden",children:X(d.createdAt).fromNow()})]}),R("p",{className:"dy-text-sm dy-mb-2 dy-text-neutral-200",children:d.text}),l&&L("div",{className:"dy-flex dy-flex-row dy-space-x-2 dy-mt-2",children:[L("button",{onClick:u=>{u.stopPropagation(),r("resolved",d.id)},className:"dy-text-xs dy-flex dy-flex-row dy-items-center dy-transition-colors dy-duration-150 hover:dy-text-neutral-300 dy-text-neutral-400 dy-font-medium dy-mr-2",children:[R(mt,{className:"dy-w-4 dy-h-4 dy-mr-1"}),"Resolve"]}),L("button",{onClick:u=>{u.stopPropagation(),r("hidden",d.id)},className:"dy-text-xs dy-flex dy-flex-row dy-items-center dy-transition-colors dy-duration-150 hover:dy-text-neutral-300 dy-text-neutral-400 dy-font-medium dy-mr-2",children:[R(yt,{className:"dy-w-4 dy-h-4 dy-mr-1"}),"Hide"]})]})]},d.id)),R(_,{disabled:p,placeholder:"Send a reply...",onSubmit:g})]},e.id)]})}import{jsx as D,jsxs as U}from"react/jsx-runtime";function Ee({showingInbox:e,hideInbox:t,comments:o}){let{appearance:n,settings:l}=C();return e?U("div",{id:"docsly-comments-inbox","data-test-id":"docsly-comments-inbox",className:`docslyInboxStyles dy-overflow-hidden dy-comment-inbox-appear dy-z-[100] dy-flex dy-flex-col dy-fixed dy-shadow-lg  dy-rounded-lg dy-border-2 
       dy-w-[90vw] dy-max-w-[375px] lg:dy-max-w-[440px] dy-top-[10vh] dy-h-[75vh] dy-pb-1 ${n.docslyInboxStyles}`,children:[U("div",{className:"dy-px-4 dy-py-2 dy-bg-neutral-50 dy-bg-opacity-10 dy-flex dy-flex-row dy-justify-between dy-items-start",children:[U("h2",{className:"dy-text-lg tracking-wider",children:["Comments for"," ",U("span",{className:"dy-bg-neutral-100 dy-bg-opacity-10 dy-font-normal dy-rounded-sm dy-text-xs dy-p-1 dy-px-2",children:[" ","/docs/frameworks/next-js"]})]}),D("button",{className:"dy-p-2 dy-rounded-full hover:dy-bg-neutral-800",onClick:t,children:D(ft,{className:"dy-w-4 dy-block dy-h-4"})})]}),D("div",{className:"dy-flex-1 dy-space-y-2 dy-pt-2 dy-overflow-y-auto",children:o?.length?o.map(m=>D(Z,{comment:m},m.id)):D("p",{className:"dy-p-2 dy-text-base dy-opacity-90",children:"No comments to show!"})}),U("p",{className:ut("dy-p-2 dy-pl-4 dy-text-xs",{"dy-hidden":l.plan==="business"}),children:[D("span",{className:"dy-opacity-80",children:"Powered by "}),D("a",{href:"https://www.docsly.dev",className:"dy-text-brand-500 dy-opacity-100",children:"docsly.dev"})]})]}):null}import ht from"clsx";import{XMarkIcon as gt}from"@heroicons/react/24/outline";import{jsx as $,jsxs as Te}from"react/jsx-runtime";function ke({showAddNewComment:e,sendComment:t,commentBoxRef:o,onClose:n}){let{appearance:l,settings:m}=C();return e?Te("div",{id:"docsly-comment-box","data-test-id":"docsly-comment-box",ref:o,className:`docslyCommentBoxStyles dy-select-none dy-z-[1000] dy-hidden dy-shadow-xl 
          dy-transition-all dy-duration-200 dy-h-[125px] dy-w-[320px] dy-absolute dy-p-4 
          dy-comment-box-appear dy-rounded-lg dy-border-[1px] ${l?.docslyCommentBoxStyles}`,children:[$("button",{id:"docsly-comment-box-close-button","data-test-id":"docsly-comment-box-close-button",className:`dy-absolute dy-top-1 dy-right-2 dy-self-end dy-p-1 dy-rounded-full
                    hover:dy-text-neutral-200 dy-text-neutral-400 hover:dy-bg-neutral-800`,onClick:n,children:$(gt,{className:"dy-w-3.5 dy-block dy-h-3.5"})}),$(_,{commentBoxRef:o,onSubmit:t}),Te("p",{className:ht("dy-absolute dy-bottom-1 dy-left-4 dy-text-xs",{"dy-hidden":m.plan!=="starter"}),children:[$("span",{className:"dy-opacity-80",children:"Powered by "}),$("a",{href:"https://www.docsly.dev",className:"dy-text-brand-500 dy-opacity-100",children:"docsly.dev"})]})]}):null}import bt from"clsx";import{useEffect as xt,useRef as wt}from"react";import{XMarkIcon as Ct}from"@heroicons/react/24/outline";import{jsx as Q,jsxs as Ne}from"react/jsx-runtime";function Me({showSelectedComment:e,selectedComment:t,commentIconRef:o,setSelectedComment:n}){let l=wt(null),{settings:m}=C();return xt(()=>{function a(){let i=o.current,y=l.current;if(t&&e){let p=t.metadata,h=document.querySelector(p.nodeId),g=j(h,p.selection);if(h&&y&&i){let{xRelativeToParent:b,yRelativeToParent:r}=V(t,h),d=p.x?b:h.clientWidth-48,u=r;if(g.length){let s=g.sort((f,c)=>f.top===c.top?c.x-f.x:c.top-f.top)[0];d=s.width+s.x,u=s.top+s.height}J(d,u,i,y)}}else i&&ne(i)}return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[t,e]),!t||!e?null:Ne("div",{ref:l,id:"docsly-selected-comment",className:`dy-z-[1000] dy-flex dy-flex-col dy-absolute dy-p-2 dy-px-0 dy-select-none 
                    dy-transition-all dy-duration-200 dy-comment-box-appear
                    dy-shadow-xl max-dy-h-[75vh] dy-w-[320px] dy-overflow-y-auto dy-rounded-lg 
                    dy-border-[1px] dy-border-neutral-300 dy-bg-black dy-text-neutral-200`,children:[Q("button",{className:`dy-z-10 dy-absolute dy-top-1 dy-right-2 dy-self-end dy-p-1 dy-rounded-full
                hover:dy-text-neutral-200  dy-text-neutral-400 hover:dy-bg-neutral-800`,onClick:()=>{n(null)},children:Q(Ct,{className:"dy-w-3.5 dy-block dy-h-3.5"})}),Q(Z,{comment:t}),Ne("p",{className:bt("-dy-mt-2 dy-pl-4 dy-text-xs",{"dy-hidden":m.plan!=="starter"}),children:[Q("span",{className:"dy-opacity-80",children:"Powered by "}),Q("a",{href:"https://www.docsly.dev",className:"dy-text-brand-500 dy-opacity-100",children:"docsly.dev"})]})]})}import ee from"clsx";import{useState as At}from"react";import Et from"react-hot-toast";import{ChatBubbleOvalLeftIcon as Tt,HandThumbDownIcon as kt,HandThumbUpIcon as Nt,InboxIcon as Mt}from"@heroicons/react/24/outline";import{jsx as F,jsxs as vt}from"react/jsx-runtime";function Ie({active:e,leaveCommentHandler:t,skipHandler:o}){return e?vt("div",{"data-test-id":"ask-for-feedback-popup",className:`dy-ask-feedback-popup dy-absolute dy-w-[90vw] sm:dy-w-[400px]
           dy-rounded-lg dy-shadow-lg dy-p-4 dy-text-neutral-300 dy-bg-black dy-text-sm`,children:[F("p",{className:"dy-text-center dy-text-xl",children:"\u2639\uFE0F"}),F("p",{className:"dy-text-center  dy-text-lg dy-mb-2",children:"You can help us improve!"}),F("p",{className:"text-sm dy-my-2 dy-text-center dy-px-2 dy-text-neutral-400",children:"You can highlight the text and give specific feedback to help us improve better."}),F("button",{onClick:t,className:`dy-block dy-mx-auto dy-mt-4 dy-p-1 dy-px-3 dy-rounded-full hover:dy-bg-brand-600 
            dy-transition-colors dy-duration-150 dy-bg-brand-700 dy-font-medium`,children:"Leave a comment"}),F("button",{"data-test-id":"skip-feedback",onClick:o,className:"dy-block dy-mx-auto dy-mt-2 dy-text-xs dy-p-1 dy-px-3 dy-text-neutral-400 dy-font-medium",children:"Skip"})]}):null}import{Fragment as St,jsx as S,jsxs as Rt}from"react/jsx-runtime";var It=()=>Et("We have received your feedback!");function Re({comments:e,commentModeActive:t,onCommentMode:o,showInbox:n}){let{publicId:l,baseURL:m,user:a,getUserToken:i,appearance:y,onDocslyEvent:p}=C(),[h,g]=At(!1);async function b(d,u=!1){u||It();let s=null;if(a&&(s=a),i)try{s=await i()}catch{}fetch(I(A.addFeedback,m),{method:"POST",body:JSON.stringify({helpful:d,user:s}),credentials:"include",headers:{"Content-type":"application/json","x-sparkle-from":window.location.href,"x-sparkle-public-id":l,"x-sparkle-version":E}}).then(f=>(p&&p("docsly_feedback",d),f.json())).catch(f=>{})}let r=Array.isArray(e)&&e.length;return S(St,{children:Rt("div",{"data-test-id":"docsly-toolbox",className:`docslyToolboxStyles dy-fade-in dy-flex dy-flex-row dy-z-[500] dy-rounded-full dy-px-6 
        dy-p-1 dy-fixed dy-bottom-4 dy-shadow-xl dy-right-[50%] dy-translate-x-[50%] ${y.docslyToolboxStyles}`,children:[S("button",{"aria-label":"Leave a comment",title:"Leave a comment",className:ee("dy-p-2 dy-mr-2 dy-rounded-full dy-transition-all dy-duration-150 dy-bg-neutral-50 hover:dy-bg-opacity-[0.15]",{"dy-bg-opacity-[0.15]":t,"dy-bg-opacity-0":!t}),"data-test-id":"docsly-start-comment-button",onClick:()=>{o()},children:S(Tt,{className:ee("dy-w-5 dy-h-5 dy-block")})}),S("button",{"aria-label":"View all comments",title:"View all comments",className:ee("dy-rounded-full dy-transition-all dy-duration-500 dy-button-appear dy-bg-neutral-50 dy-bg-opacity-0 hover:dy-bg-opacity-[0.15]",{"dy-w-0 dy-overflow-hidden dy-opacity-0":!r,"dy-w-auto dy-max-w-[50px] dy-p-2 dy-opacity-100 dy-mr-2":r}),"data-test-id":"docsly-open-inbox-button",onClick:()=>{n(d=>!d)},children:S(Mt,{className:r?"dy-w-5 dy-h-5 dy-block":""})}),S("button",{"aria-label":"Mark helpful",title:"Mark helpful","data-test-id":"docsly-like-button",className:ee("dy-p-2 dy-rounded-full dy-transition-all dy-duration-150 dy-bg-neutral-50 dy-mr-2 dy-bg-opacity-0 hover:dy-bg-opacity-[0.15]"),onClick:()=>{b(!0)},children:S(Nt,{className:"dy-w-5 dy-h-5 dy-block"})}),S("button",{"aria-label":"Mark unhelpful",title:"Mark unhelpful","data-test-id":"docsly-dislike-button",className:"dy-p-2 dy-relative dy-rounded-full dy-transition-all dy-duration-150 dy-bg-neutral-50 dy-bg-opacity-0 hover:dy-bg-opacity-[0.15]",onClick:()=>g(d=>!d),children:S(kt,{className:"dy-w-5 dy-h-5 dy-block"})}),S(Ie,{active:h,leaveCommentHandler:()=>{g(!1),b(!1,!0),o()},skipHandler:()=>{g(!1),b(!1)}})]})})}import{Fragment as Pt,jsx as P,jsxs as Le}from"react/jsx-runtime";function Pe(){let e=Se(null),t=Se(null),{saveComment:o,comments:n}=C(),[l,m]=Be(!0);te(()=>{m(window.innerWidth<760);let c=document.createElement("style");c.setAttribute("id","docsly-pointer-style"),c.innerHTML=ye,document.head.appendChild(c)},[]);let{commentModeActive:a,toggleCommentMode:i,activeComponent:y,setActiveComponent:p,setCommentModeActive:h,metadata:g,setMetadata:b}=ve({commentBoxRef:e,commentIconRef:t}),[r,d]=Be(null);function u(c){let w={text:c,metadata:g};return b({}),o(w).then(()=>{p("none")})}let s=Bt(c=>{p(c?"selectedComment":"none"),d(c)},[]);te(()=>{function c(w){w.key==="Escape"&&(p("none"),h(!1),z.dismiss())}return document.addEventListener("keyup",c),()=>{document.removeEventListener("keyup",c)}},[]),te(()=>{a?document.body.classList.add("docsly-active"):document.body.classList.remove("docsly-active")},[a]);function f(){setTimeout(()=>{window.getSelection()?.removeAllRanges(),p("addComment"),z.dismiss(),a||(z("Click wherever you'd like to comment.",{position:"top-center",duration:1e4}),z("Comment mode enabled!",{position:"top-center",duration:1e4})),i()})}return te(()=>{if(r)if(n.length){let c=n.find(w=>w.id===r.id);d(c||null)}else d(null)},[n,r]),Le(Pt,{children:[P(Lt,{position:l?"top-center":"bottom-right"}),Le("div",{onClick:c=>c.stopPropagation(),className:"docsly-preflight-scope dy-z-[100000] dy-w-0 dy-h-0 dy-block",id:"docsly-container","data-test-id":"docsly-container",children:[P("div",{id:"docsly-selected-text"}),P(ke,{sendComment:u,onClose:()=>{p("none"),z.dismiss()},showAddNewComment:y==="addComment",commentBoxRef:e}),P(Re,{commentModeActive:a,comments:n,showInbox:()=>{p("inbox")},onCommentMode:f}),P(Me,{selectedComment:r,setSelectedComment:s,commentIconRef:t,showSelectedComment:y==="selectedComment"}),P(Ae,{setSelectedComment:s,comments:n}),P(Ee,{hideInbox:()=>{p("none")},showingInbox:y==="inbox",comments:n}),P("img",{id:"docsly-comment-bubble-icon","data-test-id":"docsly-comment-bubble-icon",className:"dy-z-10 dy-select-none dy-comment-bubble-appear dy-absolute dy-transition-all dy-duration-100 dy-w-8 dy-h-8",alt:"comment bubble",src:me[64],ref:t})]})]})}import{jsx as O,jsxs as Qt}from"react/jsx-runtime";function $t({error:e,resetErrorBoundary:t}){return window.location.hostname==="localhost"?Qt("div",{role:"alert",children:[O("p",{children:"Something went wrong:"}),O("pre",{children:e.message}),O("button",{onClick:t,children:"Try again"})]}):null}function le(e){let[t,o]=Ot(!0);Dt(()=>{o(window.innerWidth<760)},[]);let n=I(A.getProjectSettings,e.baseURL),l=new URL(n);l.searchParams.set("publicId",e.publicId),l.searchParams.set("version",E);let{data:m,isLoading:a,error:i}=Ut(l.href,y=>H(y,{credentials:"include",headers:{"x-sparkle-from":window.location.href,"x-sparkle-public-id":e.publicId,"x-sparkle-version":E}}));return!m||a||i||m.status==="off"||t&&!m.allowMobile?null:O(Ht,{FallbackComponent:$t,children:O(xe,{value:{...e,settings:m},children:O(Pe,{})})})}var qn=le;export{qn as default};
